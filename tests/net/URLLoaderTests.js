var URLLoader = require("awayjs-core/lib/net/URLLoader");
var URLLoaderDataFormat = require("awayjs-core/lib/net/URLLoaderDataFormat");
var URLRequest = require("awayjs-core/lib/net/URLRequest");
var URLRequestMethod = require("awayjs-core/lib/net/URLRequestMethod");
var URLVariables = require("awayjs-core/lib/net/URLVariables");
var Event = require("awayjs-core/lib/events/Event");
var IOErrorEvent = require("awayjs-core/lib/events/IOErrorEvent");
var HTTPStatusEvent = require("awayjs-core/lib/events/HTTPStatusEvent");
/**
 *
 */
var LoaderTest = (function () {
    function LoaderTest() {
        var _this = this;
        console.log('start');
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        // POST URL Variables to PHP script
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        this.urlLoaderPostURLVars = new URLLoader();
        this.urlLoaderPostURLVars.dataFormat = URLLoaderDataFormat.VARIABLES;
        var urlStr = 'fname=karim&lname=' + Math.floor(Math.random() * 100);
        var urlVars = new URLVariables(urlStr);
        var req = new URLRequest('assets/saveData.php');
        req.method = URLRequestMethod.POST;
        req.data = urlVars;
        this.urlLoaderPostURLVars.addEventListener(Event.COMPLETE, function (event) { return _this.postURLTestComplete(event); });
        this.urlLoaderPostURLVars.addEventListener(IOErrorEvent.IO_ERROR, function (event) { return _this.ioError(event); });
        this.urlLoaderPostURLVars.load(req);
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        // GET CSV File
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        var csrReq = new URLRequest('assets/airports.csv');
        this.urlLoaderGetCSV = new URLLoader();
        this.urlLoaderGetCSV.dataFormat = URLLoaderDataFormat.TEXT;
        this.urlLoaderGetCSV.addEventListener(Event.COMPLETE, function (event) { return _this.getCsvComplete(event); });
        this.urlLoaderGetCSV.addEventListener(Event.OPEN, function (event) { return _this.getCsvOpen(event); });
        this.urlLoaderGetCSV.addEventListener(IOErrorEvent.IO_ERROR, function (event) { return _this.ioError(event); });
        this.urlLoaderGetCSV.load(csrReq);
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        // ERROR test - load a non-existing object
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        var errorReq = new URLRequest('assets/generatingError');
        this.urlLoaderErrorTest = new URLLoader();
        this.urlLoaderErrorTest.dataFormat = URLLoaderDataFormat.TEXT;
        this.urlLoaderErrorTest.addEventListener(Event.COMPLETE, function (event) { return _this.errorComplete(event); });
        this.urlLoaderErrorTest.addEventListener(IOErrorEvent.IO_ERROR, function (event) { return _this.ioError(event); });
        this.urlLoaderErrorTest.addEventListener(HTTPStatusEvent.HTTP_STATUS, function (event) { return _this.httpStatusChange(event); });
        this.urlLoaderErrorTest.load(errorReq);
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        // GET URL Vars - get URL variables
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        var csrReq = new URLRequest('assets/getUrlVars.php');
        this.urlLoaderGetURLVars = new URLLoader();
        this.urlLoaderGetURLVars.dataFormat = URLLoaderDataFormat.VARIABLES;
        this.urlLoaderGetURLVars.addEventListener(IOErrorEvent.IO_ERROR, function (event) { return _this.ioError(event); });
        this.urlLoaderGetURLVars.addEventListener(Event.COMPLETE, function (event) { return _this.getURLVarsComplete(event); });
        this.urlLoaderGetURLVars.load(csrReq);
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        // LOAD Binary file
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        var binReq = new URLRequest('assets/suzanne.awd');
        this.urlLoaderBinary = new URLLoader();
        this.urlLoaderBinary.dataFormat = URLLoaderDataFormat.BINARY;
        this.urlLoaderBinary.addEventListener(IOErrorEvent.IO_ERROR, function (event) { return _this.ioError(event); });
        this.urlLoaderBinary.addEventListener(Event.COMPLETE, function (event) { return _this.binFileLoaded(event); });
        this.urlLoaderBinary.load(binReq);
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        // LOAD Blob file
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        var blobReq = new URLRequest('assets/2.png');
        this.urlLoaderBlob = new URLLoader();
        this.urlLoaderBlob.dataFormat = URLLoaderDataFormat.BLOB;
        this.urlLoaderBlob.addEventListener(Event.COMPLETE, function (event) { return _this.blobFileLoaded(event); });
        this.urlLoaderBlob.load(blobReq);
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        // ARRAY_BUFFER Test
        //---------------------------------------------------------------------------------------------------------------------------------------------------------
        var arrBReq = new URLRequest('assets/1.jpg');
        this.urlLoaderArrb = new URLLoader();
        this.urlLoaderArrb.dataFormat = URLLoaderDataFormat.ARRAY_BUFFER;
        this.urlLoaderArrb.addEventListener(Event.COMPLETE, function (event) { return _this.arrayBufferLoaded(event); });
        this.urlLoaderArrb.load(arrBReq);
    }
    LoaderTest.prototype.arrayBufferLoaded = function (event) {
        var arrayBuffer = this.urlLoaderArrb.data;
        var byteArray = new Uint8Array(arrayBuffer);
        console.log('LoaderTest.arrayBufferLoaded', byteArray[1]);
        for (var i = 0; i < byteArray.byteLength; i++) {
        }
    };
    LoaderTest.prototype.blobFileLoaded = function (event) {
        var blob = new Blob([this.urlLoaderBlob.data], { type: 'image/png' });
        var img = document.createElement('img');
        img.src = this.createObjectURL(blob); //window['URL']['createObjectURL'](blob);
        img.onload = function (e) {
            window['URL']['revokeObjectURL'](img.src); // Clean up after yourself.
        };
        console.log('LoaderTest.blobFileLoaded', blob);
        document.body.appendChild(img);
    };
    LoaderTest.prototype.createObjectURL = function (fileBlob) {
        // For some reason TypeScript has "window.URL.createObjectURL" in it's dictionary -
        // but window.URL causes an error
        // cannot make my own .d.ts file either ( results in duplicate definition error )
        // This HACK gets it to work: window['URL']['createObjectURL']
        if (window['URL']) {
            if (window['URL']['createObjectURL']) {
                return window['URL']['createObjectURL'](fileBlob);
            }
        }
        else {
            if (window['webkitURL']) {
                return window['webkitURL']['createObjectURL'](fileBlob);
            }
        }
        return null;
    };
    LoaderTest.prototype.binFileLoaded = function (event) {
        var loader = event.target;
        console.log('LoaderTest.binFileLoaded', loader.data.length);
    };
    LoaderTest.prototype.getURLVarsComplete = function (event) {
        var loader = event.target;
        console.log('LoaderTest.getURLVarsComplete', loader.data);
    };
    LoaderTest.prototype.httpStatusChange = function (event) {
        console.log('LoaderTest.httpStatusChange', event.status);
    };
    LoaderTest.prototype.ioError = function (event) {
        var loader = event.target;
        console.log('LoaderTest.ioError', loader.url);
    };
    LoaderTest.prototype.errorComplete = function (event) {
        var loader = event.target;
        console.log('Loader.errorComplete'); //, loader.data );
    };
    LoaderTest.prototype.postURLTestComplete = function (event) {
        var loader = event.target;
        console.log('LoaderTest.postURLTestComplete', loader.data);
    };
    LoaderTest.prototype.getCsvComplete = function (event) {
        var loader = event.target;
        console.log('LoaderTest.getCsvComplete'); //, loader.data );
    };
    LoaderTest.prototype.getCsvOpen = function (event) {
        var loader = event.target;
        console.log('LoaderTest.getCsvOpen');
    };
    return LoaderTest;
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5ldC9VUkxMb2FkZXJUZXN0cy50cyJdLCJuYW1lcyI6WyJMb2FkZXJUZXN0IiwiTG9hZGVyVGVzdC5jb25zdHJ1Y3RvciIsIkxvYWRlclRlc3QuYXJyYXlCdWZmZXJMb2FkZWQiLCJMb2FkZXJUZXN0LmJsb2JGaWxlTG9hZGVkIiwiTG9hZGVyVGVzdC5jcmVhdGVPYmplY3RVUkwiLCJMb2FkZXJUZXN0LmJpbkZpbGVMb2FkZWQiLCJMb2FkZXJUZXN0LmdldFVSTFZhcnNDb21wbGV0ZSIsIkxvYWRlclRlc3QuaHR0cFN0YXR1c0NoYW5nZSIsIkxvYWRlclRlc3QuaW9FcnJvciIsIkxvYWRlclRlc3QuZXJyb3JDb21wbGV0ZSIsIkxvYWRlclRlc3QucG9zdFVSTFRlc3RDb21wbGV0ZSIsIkxvYWRlclRlc3QuZ2V0Q3N2Q29tcGxldGUiLCJMb2FkZXJUZXN0LmdldENzdk9wZW4iXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sU0FBUyxXQUFhLCtCQUErQixDQUFDLENBQUM7QUFDOUQsSUFBTyxtQkFBbUIsV0FBVyx5Q0FBeUMsQ0FBQyxDQUFDO0FBQ2hGLElBQU8sVUFBVSxXQUFhLGdDQUFnQyxDQUFDLENBQUM7QUFDaEUsSUFBTyxnQkFBZ0IsV0FBWSxzQ0FBc0MsQ0FBQyxDQUFDO0FBQzNFLElBQU8sWUFBWSxXQUFhLGtDQUFrQyxDQUFDLENBQUM7QUFDcEUsSUFBTyxLQUFLLFdBQWMsOEJBQThCLENBQUMsQ0FBQztBQUMxRCxJQUFPLFlBQVksV0FBYSxxQ0FBcUMsQ0FBQyxDQUFDO0FBQ3ZFLElBQU8sZUFBZSxXQUFZLHdDQUF3QyxDQUFDLENBQUM7QUFFNUUsQUFHQTs7R0FERztJQUNHLFVBQVU7SUFXZkEsU0FYS0EsVUFBVUE7UUFBaEJDLGlCQXNNQ0E7UUF4TENBLE9BQU9BLENBQUNBLEdBQUdBLENBQUVBLE9BQU9BLENBQUNBLENBQUNBO1FBRXRCQSxBQUlBQSwySkFKMkpBO1FBQzNKQSxtQ0FBbUNBO1FBQ25DQSwySkFBMkpBO1FBRTNKQSxJQUFJQSxD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QkE7SUFDOURBLENBQUNBLEdBRDJDQTtJQUdwQ1gsK0JBQVVBLEdBQWxCQSxVQUFvQkEsS0FBS0E7UUFFeEJZLElBQUlBLE1BQU1BLEdBQXlCQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQTtRQUNoREEsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBRUEsdUJBQXVCQSxDQUFFQSxDQUFDQTtJQUN4Q0EsQ0FBQ0E7SUFDRlosaUJBQUNBO0FBQURBLENBdE1BLEFBc01DQSxJQUFBIiwiZmlsZSI6Im5ldC9VUkxMb2FkZXJUZXN0cy5qcyIsInNvdXJjZVJvb3QiOiIuL3Rlc3RzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFVSTExvYWRlclx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9uZXQvVVJMTG9hZGVyXCIpO1xuaW1wb3J0IFVSTExvYWRlckRhdGFGb3JtYXRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9uZXQvVVJMTG9hZGVyRGF0YUZvcm1hdFwiKTtcbmltcG9ydCBVUkxSZXF1ZXN0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxSZXF1ZXN0XCIpO1xuaW1wb3J0IFVSTFJlcXVlc3RNZXRob2RcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxSZXF1ZXN0TWV0aG9kXCIpO1xuaW1wb3J0IFVSTFZhcmlhYmxlc1x0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9uZXQvVVJMVmFyaWFibGVzXCIpO1xuaW1wb3J0IEV2ZW50XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXZlbnRzL0V2ZW50XCIpO1xuaW1wb3J0IElPRXJyb3JFdmVudFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9ldmVudHMvSU9FcnJvckV2ZW50XCIpO1xuaW1wb3J0IEhUVFBTdGF0dXNFdmVudFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXZlbnRzL0hUVFBTdGF0dXNFdmVudFwiKTtcblxuLyoqXG4gKiBcbiAqL1xuY2xhc3MgTG9hZGVyVGVzdFxue1xuXG5cdHByaXZhdGUgdXJsTG9hZGVyUG9zdFVSTFZhcnM6VVJMTG9hZGVyO1xuXHRwcml2YXRlIHVybExvYWRlckdldENTVjpVUkxMb2FkZXI7XG5cdHByaXZhdGUgdXJsTG9hZGVyRXJyb3JUZXN0OlVSTExvYWRlcjtcblx0cHJpdmF0ZSB1cmxMb2FkZXJHZXRVUkxWYXJzOlVSTExvYWRlcjtcblx0cHJpdmF0ZSB1cmxMb2FkZXJCaW5hcnk6VVJMTG9hZGVyO1xuXHRwcml2YXRlIHVybExvYWRlckJsb2I6VVJMTG9hZGVyO1xuXHRwcml2YXRlIHVybExvYWRlckFycmI6VVJMTG9hZGVyO1xuXG5cdGNvbnN0cnVjdG9yKClcblx0e1xuXG5cdFx0Y29uc29sZS5sb2coICdzdGFydCcpO1xuXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLyBQT1NUIFVSTCBWYXJpYWJsZXMgdG8gUEhQIHNjcmlwdFxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHR0aGlzLnVybExvYWRlclBvc3RVUkxWYXJzID0gbmV3IFVSTExvYWRlcigpO1xuXHRcdHRoaXMudXJsTG9hZGVyUG9zdFVSTFZhcnMuZGF0YUZvcm1hdCA9IFVSTExvYWRlckRhdGFGb3JtYXQuVkFSSUFCTEVTO1xuXG5cdFx0dmFyIHVybFN0cjpzdHJpbmcgPSAnZm5hbWU9a2FyaW0mbG5hbWU9JyArIE1hdGguZmxvb3IoIE1hdGgucmFuZG9tKCkgKiAxMDAgKTtcblx0XHR2YXIgdXJsVmFycyA9IG5ldyBVUkxWYXJpYWJsZXMoIHVybFN0ciApO1xuXG5cdFx0dmFyIHJlcSA9IG5ldyBVUkxSZXF1ZXN0KCAnYXNzZXRzL3NhdmVEYXRhLnBocCcgKTtcblx0XHRcdHJlcS5tZXRob2QgPSBVUkxSZXF1ZXN0TWV0aG9kLlBPU1Q7XG5cdFx0XHRyZXEuZGF0YSA9IHVybFZhcnM7XG5cblx0XHR0aGlzLnVybExvYWRlclBvc3RVUkxWYXJzLmFkZEV2ZW50TGlzdGVuZXIoRXZlbnQuQ09NUExFVEUsIChldmVudDpFdmVudCkgPT4gdGhpcy5wb3N0VVJMVGVzdENvbXBsZXRlKGV2ZW50KSk7XG5cdFx0dGhpcy51cmxMb2FkZXJQb3N0VVJMVmFycy5hZGRFdmVudExpc3RlbmVyKElPRXJyb3JFdmVudC5JT19FUlJPUiwgKGV2ZW50OklPRXJyb3JFdmVudCkgPT4gdGhpcy5pb0Vycm9yKGV2ZW50KSk7XG5cdFx0dGhpcy51cmxMb2FkZXJQb3N0VVJMVmFycy5sb2FkKCByZXEgKTtcblxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gR0VUIENTViBGaWxlXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRcdHZhciBjc3JSZXEgPSBuZXcgVVJMUmVxdWVzdCggJ2Fzc2V0cy9haXJwb3J0cy5jc3YnICk7XG5cblx0XHR0aGlzLnVybExvYWRlckdldENTViA9IG5ldyBVUkxMb2FkZXIoKTtcblx0XHR0aGlzLnVybExvYWRlckdldENTVi5kYXRhRm9ybWF0ID0gVVJMTG9hZGVyRGF0YUZvcm1hdC5URVhUO1xuXHRcdHRoaXMudXJsTG9hZGVyR2V0Q1NWLmFkZEV2ZW50TGlzdGVuZXIoRXZlbnQuQ09NUExFVEUsIChldmVudDpFdmVudCkgPT4gdGhpcy5nZXRDc3ZDb21wbGV0ZShldmVudCkpO1xuXHRcdHRoaXMudXJsTG9hZGVyR2V0Q1NWLmFkZEV2ZW50TGlzdGVuZXIoRXZlbnQuT1BFTiwgKGV2ZW50OkV2ZW50KSA9PiB0aGlzLmdldENzdk9wZW4oZXZlbnQpKTtcblx0XHR0aGlzLnVybExvYWRlckdldENTVi5hZGRFdmVudExpc3RlbmVyKElPRXJyb3JFdmVudC5JT19FUlJPUiwgKGV2ZW50OklPRXJyb3JFdmVudCkgPT4gdGhpcy5pb0Vycm9yKGV2ZW50KSk7XG5cdFx0dGhpcy51cmxMb2FkZXJHZXRDU1YubG9hZCggY3NyUmVxICk7XG5cblx0XHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIEVSUk9SIHRlc3QgLSBsb2FkIGEgbm9uLWV4aXN0aW5nIG9iamVjdFxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHR2YXIgZXJyb3JSZXEgPSBuZXcgVVJMUmVxdWVzdCggJ2Fzc2V0cy9nZW5lcmF0aW5nRXJyb3InICk7XG5cblx0XHR0aGlzLnVybExvYWRlckVycm9yVGVzdCA9IG5ldyBVUkxMb2FkZXIoKTtcblx0XHR0aGlzLnVybExvYWRlckVycm9yVGVzdC5kYXRhRm9ybWF0ID0gVVJMTG9hZGVyRGF0YUZvcm1hdC5URVhUO1xuXHRcdHRoaXMudXJsTG9hZGVyRXJyb3JUZXN0LmFkZEV2ZW50TGlzdGVuZXIoRXZlbnQuQ09NUExFVEUsIChldmVudDpFdmVudCkgPT4gIHRoaXMuZXJyb3JDb21wbGV0ZShldmVudCkpO1xuXHRcdHRoaXMudXJsTG9hZGVyRXJyb3JUZXN0LmFkZEV2ZW50TGlzdGVuZXIoSU9FcnJvckV2ZW50LklPX0VSUk9SLCAoZXZlbnQ6SU9FcnJvckV2ZW50KSA9PiB0aGlzLmlvRXJyb3IoZXZlbnQpKTtcblx0XHR0aGlzLnVybExvYWRlckVycm9yVGVzdC5hZGRFdmVudExpc3RlbmVyKEhUVFBTdGF0dXNFdmVudC5IVFRQX1NUQVRVUywgKGV2ZW50OkhUVFBTdGF0dXNFdmVudCkgPT4gdGhpcy5odHRwU3RhdHVzQ2hhbmdlKGV2ZW50KSk7XG5cdFx0dGhpcy51cmxMb2FkZXJFcnJvclRlc3QubG9hZCggZXJyb3JSZXEgKTtcblxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gR0VUIFVSTCBWYXJzIC0gZ2V0IFVSTCB2YXJpYWJsZXNcblx0XHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0dmFyIGNzclJlcSA9IG5ldyBVUkxSZXF1ZXN0KCAnYXNzZXRzL2dldFVybFZhcnMucGhwJyApO1xuXG5cdFx0dGhpcy51cmxMb2FkZXJHZXRVUkxWYXJzID0gbmV3IFVSTExvYWRlcigpO1xuXHRcdHRoaXMudXJsTG9hZGVyR2V0VVJMVmFycy5kYXRhRm9ybWF0ID0gVVJMTG9hZGVyRGF0YUZvcm1hdC5WQVJJQUJMRVM7XG5cdFx0dGhpcy51cmxMb2FkZXJHZXRVUkxWYXJzLmFkZEV2ZW50TGlzdGVuZXIoSU9FcnJvckV2ZW50LklPX0VSUk9SLCAoZXZlbnQ6SU9FcnJvckV2ZW50KSA9PiB0aGlzLmlvRXJyb3IoZXZlbnQpKTtcblx0XHR0aGlzLnVybExvYWRlckdldFVSTFZhcnMuYWRkRXZlbnRMaXN0ZW5lcihFdmVudC5DT01QTEVURSwgKGV2ZW50OkV2ZW50KSA9PiB0aGlzLmdldFVSTFZhcnNDb21wbGV0ZShldmVudCkpO1xuXHRcdHRoaXMudXJsTG9hZGVyR2V0VVJMVmFycy5sb2FkKCBjc3JSZXEgKTtcblxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gTE9BRCBCaW5hcnkgZmlsZVxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHR2YXIgYmluUmVxID0gbmV3IFVSTFJlcXVlc3QoICdhc3NldHMvc3V6YW5uZS5hd2QnICk7XG5cblx0XHR0aGlzLnVybExvYWRlckJpbmFyeSA9IG5ldyBVUkxMb2FkZXIoICApO1xuXHRcdHRoaXMudXJsTG9hZGVyQmluYXJ5LmRhdGFGb3JtYXQgPSBVUkxMb2FkZXJEYXRhRm9ybWF0LkJJTkFSWTtcblx0XHR0aGlzLnVybExvYWRlckJpbmFyeS5hZGRFdmVudExpc3RlbmVyKElPRXJyb3JFdmVudC5JT19FUlJPUiwgKGV2ZW50OklPRXJyb3JFdmVudCkgPT4gdGhpcy5pb0Vycm9yKGV2ZW50KSk7XG5cdFx0dGhpcy51cmxMb2FkZXJCaW5hcnkuYWRkRXZlbnRMaXN0ZW5lcihFdmVudC5DT01QTEVURSwgKGV2ZW50OkV2ZW50KSA9PiB0aGlzLmJpbkZpbGVMb2FkZWQoZXZlbnQpKTtcblx0XHR0aGlzLnVybExvYWRlckJpbmFyeS5sb2FkKCBiaW5SZXEgKTtcblxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gTE9BRCBCbG9iIGZpbGVcblx0XHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0dmFyIGJsb2JSZXEgPSBuZXcgVVJMUmVxdWVzdCggJ2Fzc2V0cy8yLnBuZycgKTtcblxuXHRcdHRoaXMudXJsTG9hZGVyQmxvYiA9IG5ldyBVUkxMb2FkZXIoICApO1xuXHRcdHRoaXMudXJsTG9hZGVyQmxvYi5kYXRhRm9ybWF0ID0gVVJMTG9hZGVyRGF0YUZvcm1hdC5CTE9CO1xuXHRcdHRoaXMudXJsTG9hZGVyQmxvYi5hZGRFdmVudExpc3RlbmVyKEV2ZW50LkNPTVBMRVRFLCAoZXZlbnQ6RXZlbnQpID0+IHRoaXMuYmxvYkZpbGVMb2FkZWQoZXZlbnQpKTtcblx0XHR0aGlzLnVybExvYWRlckJsb2IubG9hZCggYmxvYlJlcSApO1xuXG5cdFx0Ly8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLyBBUlJBWV9CVUZGRVIgVGVzdFxuXHRcdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHR2YXIgYXJyQlJlcSA9IG5ldyBVUkxSZXF1ZXN0KCAnYXNzZXRzLzEuanBnJyApO1xuXG5cdFx0dGhpcy51cmxMb2FkZXJBcnJiID0gbmV3IFVSTExvYWRlciggICk7XG5cdFx0dGhpcy51cmxMb2FkZXJBcnJiLmRhdGFGb3JtYXQgPSBVUkxMb2FkZXJEYXRhRm9ybWF0LkFSUkFZX0JVRkZFUjtcblx0XHR0aGlzLnVybExvYWRlckFycmIuYWRkRXZlbnRMaXN0ZW5lcihFdmVudC5DT01QTEVURSwgKGV2ZW50OkV2ZW50KSA9PiB0aGlzLmFycmF5QnVmZmVyTG9hZGVkKGV2ZW50KSk7XG5cdFx0dGhpcy51cmxMb2FkZXJBcnJiLmxvYWQoIGFyckJSZXEgKTtcblx0fVxuXG5cdHByaXZhdGUgYXJyYXlCdWZmZXJMb2FkZWQoIGV2ZW50OkV2ZW50ICk6dm9pZFxuXHR7XG5cdFx0dmFyIGFycmF5QnVmZmVyID0gdGhpcy51cmxMb2FkZXJBcnJiLmRhdGE7XG5cdFx0dmFyIGJ5dGVBcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyKTtcblxuXHRcdGNvbnNvbGUubG9nKCAnTG9hZGVyVGVzdC5hcnJheUJ1ZmZlckxvYWRlZCcgLCBieXRlQXJyYXlbMV0pO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBieXRlQXJyYXkuYnl0ZUxlbmd0aDsgaSsrKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCBieXRlQXJyYXlbaV0gKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGJsb2JGaWxlTG9hZGVkKCBldmVudDpFdmVudCApOnZvaWRcblx0e1xuXHRcdHZhciBibG9iPSBuZXcgQmxvYihbdGhpcy51cmxMb2FkZXJCbG9iLmRhdGFdLCB7dHlwZTogJ2ltYWdlL3BuZyd9KTtcblx0XHR2YXIgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG5cdFx0XHRpbWcuc3JjICA9IHRoaXMuY3JlYXRlT2JqZWN0VVJMKCBibG9iICk7Ly93aW5kb3dbJ1VSTCddWydjcmVhdGVPYmplY3RVUkwnXShibG9iKTtcblx0XHRcdGltZy5vbmxvYWQgID0gZnVuY3Rpb24oZSkge1xuXHRcdFx0XHR3aW5kb3dbJ1VSTCddWydyZXZva2VPYmplY3RVUkwnXShpbWcuc3JjKTsgLy8gQ2xlYW4gdXAgYWZ0ZXIgeW91cnNlbGYuXG5cdFx0XHR9O1xuXG5cdFx0Y29uc29sZS5sb2coICdMb2FkZXJUZXN0LmJsb2JGaWxlTG9hZGVkJyAsIGJsb2IgKTtcblxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIGltZyApO1xuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVPYmplY3RVUkwoIGZpbGVCbG9iIClcblx0e1xuXHRcdC8vIEZvciBzb21lIHJlYXNvbiBUeXBlU2NyaXB0IGhhcyBcIndpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMXCIgaW4gaXQncyBkaWN0aW9uYXJ5IC1cblx0XHQvLyBidXQgd2luZG93LlVSTCBjYXVzZXMgYW4gZXJyb3Jcblx0XHQvLyBjYW5ub3QgbWFrZSBteSBvd24gLmQudHMgZmlsZSBlaXRoZXIgKCByZXN1bHRzIGluIGR1cGxpY2F0ZSBkZWZpbml0aW9uIGVycm9yIClcblx0XHQvLyBUaGlzIEhBQ0sgZ2V0cyBpdCB0byB3b3JrOiB3aW5kb3dbJ1VSTCddWydjcmVhdGVPYmplY3RVUkwnXVxuXHRcdGlmKCB3aW5kb3dbJ1VSTCddICl7XG5cdFx0XHRpZiAoIHdpbmRvd1snVVJMJ11bJ2NyZWF0ZU9iamVjdFVSTCddICkge1xuXHRcdFx0XHRyZXR1cm4gd2luZG93WydVUkwnXVsnY3JlYXRlT2JqZWN0VVJMJ10oIGZpbGVCbG9iICk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICggd2luZG93Wyd3ZWJraXRVUkwnXSApe1xuXHRcdFx0XHRyZXR1cm4gd2luZG93Wyd3ZWJraXRVUkwnXVsnY3JlYXRlT2JqZWN0VVJMJ10oIGZpbGVCbG9iICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRwcml2YXRlIGJpbkZpbGVMb2FkZWQoZXZlbnQ6RXZlbnQpOnZvaWRcblx0e1xuXHRcdHZhciBsb2FkZXI6VVJMTG9hZGVyID0gPFVSTExvYWRlcj4gZXZlbnQudGFyZ2V0O1xuXHRcdGNvbnNvbGUubG9nKCAnTG9hZGVyVGVzdC5iaW5GaWxlTG9hZGVkJyAsIGxvYWRlci5kYXRhLmxlbmd0aCApO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRVUkxWYXJzQ29tcGxldGUoZXZlbnQ6RXZlbnQpOnZvaWRcblx0e1xuXHRcdHZhciBsb2FkZXI6VVJMTG9hZGVyID0gPFVSTExvYWRlcj4gZXZlbnQudGFyZ2V0O1xuXHRcdGNvbnNvbGUubG9nKCAnTG9hZGVyVGVzdC5nZXRVUkxWYXJzQ29tcGxldGUnICwgbG9hZGVyLmRhdGEgKTtcblx0fVxuXG5cdHByaXZhdGUgaHR0cFN0YXR1c0NoYW5nZShldmVudDpIVFRQU3RhdHVzRXZlbnQpOnZvaWRcblx0e1xuXHRcdGNvbnNvbGUubG9nKCAnTG9hZGVyVGVzdC5odHRwU3RhdHVzQ2hhbmdlJyAsIGV2ZW50LnN0YXR1cyApO1xuXHR9XG5cblx0cHJpdmF0ZSBpb0Vycm9yKGV2ZW50OklPRXJyb3JFdmVudCk6dm9pZFxuXHR7XG5cdFx0dmFyIGxvYWRlcjpVUkxMb2FkZXIgPSA8VVJMTG9hZGVyPiBldmVudC50YXJnZXQ7XG5cdFx0Y29uc29sZS5sb2coICdMb2FkZXJUZXN0LmlvRXJyb3InICwgbG9hZGVyLnVybCApO1xuXHR9XG5cblx0cHJpdmF0ZSBlcnJvckNvbXBsZXRlKCBldmVudCApOnZvaWRcblx0e1xuXHRcdHZhciBsb2FkZXI6VVJMTG9hZGVyID0gPFVSTExvYWRlcj4gZXZlbnQudGFyZ2V0O1xuXHRcdGNvbnNvbGUubG9nKCAnTG9hZGVyLmVycm9yQ29tcGxldGUnICk7Ly8sIGxvYWRlci5kYXRhICk7XG5cdH1cblxuXHRwcml2YXRlIHBvc3RVUkxUZXN0Q29tcGxldGUoZXZlbnQ6RXZlbnQpOnZvaWRcblx0e1xuXHRcdHZhciBsb2FkZXI6VVJMTG9hZGVyID0gPFVSTExvYWRlcj4gZXZlbnQudGFyZ2V0O1xuXHRcdGNvbnNvbGUubG9nKCAnTG9hZGVyVGVzdC5wb3N0VVJMVGVzdENvbXBsZXRlJyAsIGxvYWRlci5kYXRhICk7XG5cdH1cblxuXHRwcml2YXRlIGdldENzdkNvbXBsZXRlKGV2ZW50OkV2ZW50KTp2b2lkXG5cdHtcblx0XHR2YXIgbG9hZGVyOlVSTExvYWRlciA9IDxVUkxMb2FkZXI+IGV2ZW50LnRhcmdldDtcblx0XHRjb25zb2xlLmxvZyggJ0xvYWRlclRlc3QuZ2V0Q3N2Q29tcGxldGUnICk7Ly8sIGxvYWRlci5kYXRhICk7XG5cdH1cblxuXHRwcml2YXRlIGdldENzdk9wZW4oIGV2ZW50ICk6dm9pZFxuXHR7XG5cdFx0dmFyIGxvYWRlcjpVUkxMb2FkZXIgPSA8VVJMTG9hZGVyPiBldmVudC50YXJnZXQ7XG5cdFx0Y29uc29sZS5sb2coICdMb2FkZXJUZXN0LmdldENzdk9wZW4nICk7XG5cdH1cbn0iXX0=