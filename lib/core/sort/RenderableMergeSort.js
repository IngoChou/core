/**
* @class away.sort.RenderableMergeSort
*/
var RenderableMergeSort = (function () {
    function RenderableMergeSort() {
    }
    RenderableMergeSort.prototype.sortBlendedRenderables = function (head) {
        var headB;
        var fast;
        var slow;

        if (!head || !head.next) {
            return head;
        }

        // split in two sublists
        slow = head;
        fast = head.next;

        while (fast) {
            fast = fast.next;
            if (fast) {
                slow = slow.next;
                fast = fast.next;
            }
        }

        headB = slow.next;
        slow.next = null;

        // recurse
        head = this.sortBlendedRenderables(head);
        headB = this.sortBlendedRenderables(headB);

        // merge sublists while respecting order
        var result;
        var curr;
        var l;

        if (!head)
            return headB;
        if (!headB)
            return head;

        while (head && headB) {
            if (head.zIndex < headB.zIndex) {
                l = head;
                head = head.next;
            } else {
                l = headB;
                headB = headB.next;
            }

            if (!result)
                result = l;
            else
                curr.next = l;

            curr = l;
        }

        if (head)
            curr.next = head;
        else if (headB)
            curr.next = headB;

        return result;
    };

    RenderableMergeSort.prototype.sortOpaqueRenderables = function (head) {
        var headB;
        var fast, slow;

        if (!head || !head.next) {
            return head;
        }

        // split in two sublists
        slow = head;
        fast = head.next;

        while (fast) {
            fast = fast.next;
            if (fast) {
                slow = slow.next;
                fast = fast.next;
            }
        }

        headB = slow.next;
        slow.next = null;

        // recurse
        head = this.sortOpaqueRenderables(head);
        headB = this.sortOpaqueRenderables(headB);

        // merge sublists while respecting order
        var result;
        var curr;
        var l;
        var cmp = 0;

        if (!head)
            return headB;
        if (!headB)
            return head;

        while (head && headB && head != null && headB != null) {
            // first sort per render order id (reduces program3D switches),
            // then on material id (reduces setting props),
            // then on zIndex (reduces overdraw)
            var aid = head.renderOrderId;
            var bid = headB.renderOrderId;

            if (aid == bid) {
                var ma = head.materialId;
                var mb = headB.materialId;

                if (ma == mb) {
                    if (head.zIndex < headB.zIndex)
                        cmp = 1;
                    else
                        cmp = -1;
                } else if (ma > mb) {
                    cmp = 1;
                } else {
                    cmp = -1;
                }
            } else if (aid > bid) {
                cmp = 1;
            } else {
                cmp = -1;
            }

            if (cmp < 0) {
                l = head;
                head = head.next;
            } else {
                l = headB;
                headB = headB.next;
            }

            if (!result) {
                result = l;
                curr = l;
            } else {
                curr.next = l;
                curr = l;
            }
        }

        if (head)
            curr.next = head;
        else if (headB)
            curr.next = headB;

        return result;
    };
    return RenderableMergeSort;
})();

module.exports = RenderableMergeSort;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvcmUvc29ydC9SZW5kZXJhYmxlTWVyZ2VTb3J0LnRzIl0sIm5hbWVzIjpbIlJlbmRlcmFibGVNZXJnZVNvcnQiLCJSZW5kZXJhYmxlTWVyZ2VTb3J0LmNvbnN0cnVjdG9yIiwiUmVuZGVyYWJsZU1lcmdlU29ydC5zb3J0QmxlbmRlZFJlbmRlcmFibGVzIiwiUmVuZGVyYWJsZU1lcmdlU29ydC5zb3J0T3BhcXVlUmVuZGVyYWJsZXMiXSwibWFwcGluZ3MiOiJBQUFBOztFQUtHO0FBQ0g7SUFBQUE7SUF5SkFDLENBQUNBO0FBQUFELElBdkpBQSx1REFBQUEsVUFBOEJBLElBQWdCQTtRQUU3Q0UsSUFBSUEsS0FBS0E7UUFDVEEsSUFBSUEsSUFBSUE7UUFDUkEsSUFBSUEsSUFBSUE7O1FBRVJBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUVBO1lBQ3hCQSxPQUFPQSxJQUFJQTtTQUNYQTs7UUFFREEsd0JBQXdCQTtRQUN4QkEsSUFBSUEsR0FBR0EsSUFBSUE7UUFDWEEsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsSUFBSUE7O1FBRWhCQSxPQUFPQSxJQUFJQSxDQUFFQTtZQUNaQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQTtZQUNoQkEsSUFBSUEsSUFBSUEsQ0FBRUE7Z0JBQ1RBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLElBQUlBO2dCQUNoQkEsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsSUFBSUE7YUFDaEJBO1NBQ0RBOztRQUVEQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQTtRQUNqQkEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsSUFBSUE7O1FBRWhCQSxVQUFVQTtRQUNWQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxzQkFBc0JBLENBQUNBLElBQUlBLENBQUNBO1FBQ3hDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxzQkFBc0JBLENBQUNBLEtBQUtBLENBQUNBOztRQUUxQ0Esd0NB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QSxNQUFNQTtJQUNkQSxDQUFDQTtJQUNGSCwyQkFBQ0E7QUFBREEsQ0FBQ0EsSUFBQTs7QUFFRCxvQ0FBNkIsQ0FBQSIsImZpbGUiOiJjb3JlL3NvcnQvUmVuZGVyYWJsZU1lcmdlU29ydC5qcyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvcm9iYmF0ZW1hbi9XZWJzdG9ybVByb2plY3RzL2F3YXlqcy1jb3JlLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJUmVuZGVyYWJsZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvY29yZS9wb29sL0lSZW5kZXJhYmxlXCIpO1xuaW1wb3J0IElFbnRpdHlTb3J0ZXJcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9jb3JlL3NvcnQvSUVudGl0eVNvcnRlclwiKTtcblxuLyoqXG4gKiBAY2xhc3MgYXdheS5zb3J0LlJlbmRlcmFibGVNZXJnZVNvcnRcbiAqL1xuY2xhc3MgUmVuZGVyYWJsZU1lcmdlU29ydCBpbXBsZW1lbnRzIElFbnRpdHlTb3J0ZXJcbntcblx0cHVibGljIHNvcnRCbGVuZGVkUmVuZGVyYWJsZXMoaGVhZDpJUmVuZGVyYWJsZSk6SVJlbmRlcmFibGVcblx0e1xuXHRcdHZhciBoZWFkQjpJUmVuZGVyYWJsZTtcblx0XHR2YXIgZmFzdDpJUmVuZGVyYWJsZTtcblx0XHR2YXIgc2xvdzpJUmVuZGVyYWJsZTtcblxuXHRcdGlmICghaGVhZCB8fCAhaGVhZC5uZXh0KSB7XG5cdFx0XHRyZXR1cm4gaGVhZDtcblx0XHR9XG5cblx0XHQvLyBzcGxpdCBpbiB0d28gc3VibGlzdHNcblx0XHRzbG93ID0gaGVhZDtcblx0XHRmYXN0ID0gaGVhZC5uZXh0O1xuXG5cdFx0d2hpbGUgKGZhc3QpIHtcblx0XHRcdGZhc3QgPSBmYXN0Lm5leHQ7XG5cdFx0XHRpZiAoZmFzdCkge1xuXHRcdFx0XHRzbG93ID0gc2xvdy5uZXh0O1xuXHRcdFx0XHRmYXN0ID0gZmFzdC5uZXh0O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGhlYWRCID0gc2xvdy5uZXh0O1xuXHRcdHNsb3cubmV4dCA9IG51bGw7XG5cblx0XHQvLyByZWN1cnNlXG5cdFx0aGVhZCA9IHRoaXMuc29ydEJsZW5kZWRSZW5kZXJhYmxlcyhoZWFkKTtcblx0XHRoZWFkQiA9IHRoaXMuc29ydEJsZW5kZWRSZW5kZXJhYmxlcyhoZWFkQik7XG5cblx0XHQvLyBtZXJnZSBzdWJsaXN0cyB3aGlsZSByZXNwZWN0aW5nIG9yZGVyXG5cdFx0dmFyIHJlc3VsdDpJUmVuZGVyYWJsZTtcblx0XHR2YXIgY3VycjpJUmVuZGVyYWJsZTtcblx0XHR2YXIgbDpJUmVuZGVyYWJsZTtcblxuXHRcdGlmICghaGVhZClcblx0XHRcdHJldHVybiBoZWFkQjtcblx0XHRpZiAoIWhlYWRCKVxuXHRcdFx0cmV0dXJuIGhlYWQ7XG5cblx0XHR3aGlsZSAoaGVhZCAmJiBoZWFkQikge1xuXHRcdFx0aWYgKGhlYWQuekluZGV4IDwgaGVhZEIuekluZGV4KSB7XG5cdFx0XHRcdGwgPSBoZWFkO1xuXHRcdFx0XHRoZWFkID0gaGVhZC5uZXh0O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bCA9IGhlYWRCO1xuXHRcdFx0XHRoZWFkQiA9IGhlYWRCLm5leHQ7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghcmVzdWx0KVxuXHRcdFx0XHRyZXN1bHQgPSBsOyBlbHNlXG5cdFx0XHRcdGN1cnIubmV4dCA9IGw7XG5cblx0XHRcdGN1cnIgPSBsO1xuXHRcdH1cblxuXHRcdGlmIChoZWFkKVxuXHRcdFx0Y3Vyci5uZXh0ID0gaGVhZDsgZWxzZSBpZiAoaGVhZEIpXG5cdFx0XHRjdXJyLm5leHQgPSBoZWFkQjtcblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHRwdWJsaWMgc29ydE9wYXF1ZVJlbmRlcmFibGVzKGhlYWQ6SVJlbmRlcmFibGUpOklSZW5kZXJhYmxlXG5cdHtcblx0XHR2YXIgaGVhZEI6SVJlbmRlcmFibGU7XG5cdFx0dmFyIGZhc3Q6SVJlbmRlcmFibGUsIHNsb3c6SVJlbmRlcmFibGU7XG5cblx0XHRpZiAoIWhlYWQgfHwgIWhlYWQubmV4dCkge1xuXHRcdFx0cmV0dXJuIGhlYWQ7XG5cdFx0fVxuXG5cdFx0Ly8gc3BsaXQgaW4gdHdvIHN1Ymxpc3RzXG5cdFx0c2xvdyA9IGhlYWQ7XG5cdFx0ZmFzdCA9IGhlYWQubmV4dDtcblxuXHRcdHdoaWxlIChmYXN0KSB7XG5cdFx0XHRmYXN0ID0gZmFzdC5uZXh0O1xuXHRcdFx0aWYgKGZhc3QpIHtcblx0XHRcdFx0c2xvdyA9IHNsb3cubmV4dDtcblx0XHRcdFx0ZmFzdCA9IGZhc3QubmV4dDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRoZWFkQiA9IHNsb3cubmV4dDtcblx0XHRzbG93Lm5leHQgPSBudWxsO1xuXG5cdFx0Ly8gcmVjdXJzZVxuXHRcdGhlYWQgPSB0aGlzLnNvcnRPcGFxdWVSZW5kZXJhYmxlcyhoZWFkKTtcblx0XHRoZWFkQiA9IHRoaXMuc29ydE9wYXF1ZVJlbmRlcmFibGVzKGhlYWRCKTtcblxuXHRcdC8vIG1lcmdlIHN1Ymxpc3RzIHdoaWxlIHJlc3BlY3Rpbmcgb3JkZXJcblx0XHR2YXIgcmVzdWx0OklSZW5kZXJhYmxlO1xuXHRcdHZhciBjdXJyOklSZW5kZXJhYmxlO1xuXHRcdHZhciBsOklSZW5kZXJhYmxlO1xuXHRcdHZhciBjbXA6bnVtYmVyID0gMDtcblxuXHRcdGlmICghaGVhZClcblx0XHRcdHJldHVybiBoZWFkQjtcblx0XHRpZiAoIWhlYWRCKVxuXHRcdFx0cmV0dXJuIGhlYWQ7XG5cblx0XHR3aGlsZSAoaGVhZCAmJiBoZWFkQiAmJiBoZWFkICE9IG51bGwgJiYgaGVhZEIgIT0gbnVsbCkge1xuXG5cdFx0XHQvLyBmaXJzdCBzb3J0IHBlciByZW5kZXIgb3JkZXIgaWQgKHJlZHVjZXMgcHJvZ3JhbTNEIHN3aXRjaGVzKSxcblx0XHRcdC8vIHRoZW4gb24gbWF0ZXJpYWwgaWQgKHJlZHVjZXMgc2V0dGluZyBwcm9wcyksXG5cdFx0XHQvLyB0aGVuIG9uIHpJbmRleCAocmVkdWNlcyBvdmVyZHJhdylcblx0XHRcdHZhciBhaWQ6bnVtYmVyID0gaGVhZC5yZW5kZXJPcmRlcklkO1xuXHRcdFx0dmFyIGJpZDpudW1iZXIgPSBoZWFkQi5yZW5kZXJPcmRlcklkO1xuXG5cdFx0XHRpZiAoYWlkID09IGJpZCkge1xuXHRcdFx0XHR2YXIgbWE6bnVtYmVyID0gaGVhZC5tYXRlcmlhbElkO1xuXHRcdFx0XHR2YXIgbWI6bnVtYmVyID0gaGVhZEIubWF0ZXJpYWxJZDtcblxuXHRcdFx0XHRpZiAobWEgPT0gbWIpIHtcblx0XHRcdFx0XHRpZiAoaGVhZC56SW5kZXggPCBoZWFkQi56SW5kZXgpXG5cdFx0XHRcdFx0XHRjbXAgPSAxOyBlbHNlXG5cdFx0XHRcdFx0XHRjbXAgPSAtMTtcblx0XHRcdFx0fSBlbHNlIGlmIChtYSA+IG1iKSB7XG5cdFx0XHRcdFx0Y21wID0gMTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjbXAgPSAtMTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChhaWQgPiBiaWQpIHtcblx0XHRcdFx0Y21wID0gMTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNtcCA9IC0xO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoY21wIDwgMCkge1xuXHRcdFx0XHRsID0gaGVhZDtcblx0XHRcdFx0aGVhZCA9IGhlYWQubmV4dDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGwgPSBoZWFkQjtcblx0XHRcdFx0aGVhZEIgPSBoZWFkQi5uZXh0O1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIXJlc3VsdCkge1xuXHRcdFx0XHRyZXN1bHQgPSBsO1xuXHRcdFx0XHRjdXJyID0gbDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGN1cnIubmV4dCA9IGw7XG5cdFx0XHRcdGN1cnIgPSBsO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChoZWFkKVxuXHRcdFx0Y3Vyci5uZXh0ID0gaGVhZDsgZWxzZSBpZiAoaGVhZEIpXG5cdFx0XHRjdXJyLm5leHQgPSBoZWFkQjtcblxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cbn1cblxuZXhwb3J0ID0gUmVuZGVyYWJsZU1lcmdlU29ydDsiXX0=