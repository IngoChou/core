var PlaneClassification = require("awayjs-core/lib/geom/PlaneClassification");
var Plane3D = (function () {
    /**
     * Create a Plane3D with ABCD coefficients
     */
    function Plane3D(a, b, c, d) {
        if (a === void 0) { a = 0; }
        if (b === void 0) { b = 0; }
        if (c === void 0) { c = 0; }
        if (d === void 0) { d = 0; }
        this.a = a;
        this.b = b;
        this.c = c;
        this.d = d;
        if (a == 0 && b == 0) {
            this._iAlignment = Plane3D.ALIGN_XY_AXIS;
        }
        else if (b == 0 && c == 0) {
            this._iAlignment = Plane3D.ALIGN_YZ_AXIS;
        }
        else if (a == 0 && c == 0) {
            this._iAlignment = Plane3D.ALIGN_XZ_AXIS;
        }
        else {
            this._iAlignment = Plane3D.ALIGN_ANY;
        }
    }
    /**
     * Fills this Plane3D with the coefficients from 3 points in 3d space.
     * @param p0 Vector3D
     * @param p1 Vector3D
     * @param p2 Vector3D
     */
    Plane3D.prototype.fromPoints = function (p0, p1, p2) {
        var d1x = p1.x - p0.x;
        var d1y = p1.y - p0.y;
        var d1z = p1.z - p0.z;
        var d2x = p2.x - p0.x;
        var d2y = p2.y - p0.y;
        var d2z = p2.z - p0.z;
        this.a = d1y * d2z - d1z * d2y;
        this.b = d1z * d2x - d1x * d2z;
        this.c = d1x * d2y - d1y * d2x;
        this.d = this.a * p0.x + this.b * p0.y + this.c * p0.z;
        // not using epsilon, since a plane is infinite and a small incorrection can grow very large
        if (this.a == 0 && this.b == 0) {
            this._iAlignment = Plane3D.ALIGN_XY_AXIS;
        }
        else if (this.b == 0 && this.c == 0) {
            this._iAlignment = Plane3D.ALIGN_YZ_AXIS;
        }
        else if (this.a == 0 && this.c == 0) {
            this._iAlignment = Plane3D.ALIGN_XZ_AXIS;
        }
        else {
            this._iAlignment = Plane3D.ALIGN_ANY;
        }
    };
    /**
     * Fills this Plane3D with the coefficients from the plane's normal and a point in 3d space.
     * @param normal Vector3D
     * @param point  Vector3D
     */
    Plane3D.prototype.fromNormalAndPoint = function (normal, point) {
        this.a = normal.x;
        this.b = normal.y;
        this.c = normal.z;
        this.d = this.a * point.x + this.b * point.y + this.c * point.z;
        if (this.a == 0 && this.b == 0) {
            this._iAlignment = Plane3D.ALIGN_XY_AXIS;
        }
        else if (this.b == 0 && this.c == 0) {
            this._iAlignment = Plane3D.ALIGN_YZ_AXIS;
        }
        else if (this.a == 0 && this.c == 0) {
            this._iAlignment = Plane3D.ALIGN_XZ_AXIS;
        }
        else {
            this._iAlignment = Plane3D.ALIGN_ANY;
        }
    };
    /**
     * Normalize this Plane3D
     * @return Plane3D This Plane3D.
     */
    Plane3D.prototype.normalize = function () {
        var len = 1 / Math.sqrt(this.a * this.a + this.b * this.b + this.c * this.c);
        this.a *= len;
        this.b *= len;
        this.c *= len;
        this.d *= len;
        return this;
    };
    /**
     * Returns the signed distance between this Plane3D and the point p.
     * @param p Vector3D
     * @returns Number
     */
    Plane3D.prototype.distance = function (p) {
        if (this._iAlignment == Plane3D.ALIGN_YZ_AXIS) {
            return this.a * p.x - this.d;
        }
        else if (this._iAlignment == Plane3D.ALIGN_XZ_AXIS) {
            return this.b * p.y - this.d;
        }
        else if (this._iAlignment == Plane3D.ALIGN_XY_AXIS) {
            return this.c * p.z - this.d;
        }
        else {
            return this.a * p.x + this.b * p.y + this.c * p.z - this.d;
        }
    };
    /**
     * Classify a point against this Plane3D. (in front, back or intersecting)
     * @param p Vector3D
     * @return int Plane3.FRONT or Plane3D.BACK or Plane3D.INTERSECT
     */
    Plane3D.prototype.classifyPoint = function (p, epsilon) {
        if (epsilon === void 0) { epsilon = 0.01; }
        // check NaN
        if (this.d != this.d)
            return PlaneClassification.FRONT;
        var len;
        if (this._iAlignment == Plane3D.ALIGN_YZ_AXIS)
            len = this.a * p.x - this.d;
        else if (this._iAlignment == Plane3D.ALIGN_XZ_AXIS)
            len = this.b * p.y - this.d;
        else if (this._iAlignment == Plane3D.ALIGN_XY_AXIS)
            len = this.c * p.z - this.d;
        else
            len = this.a * p.x + this.b * p.y + this.c * p.z - this.d;
        if (len < -epsilon)
            return PlaneClassification.BACK;
        else if (len > epsilon)
            return PlaneClassification.FRONT;
        else
            return PlaneClassification.INTERSECT;
    };
    Plane3D.prototype.toString = function () {
        return "Plane3D [a:" + this.a + ", b:" + this.b + ", c:" + this.c + ", d:" + this.d + "]";
    };
    // indicates the alignment of the plane
    Plane3D.ALIGN_ANY = 0;
    Plane3D.ALIGN_XY_AXIS = 1;
    Plane3D.ALIGN_YZ_AXIS = 2;
    Plane3D.ALIGN_XZ_AXIS = 3;
    return Plane3D;
})();
module.exports = Plane3D;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1jb3JlL2xpYi9nZW9tL3BsYW5lM2QudHMiXSwibmFtZXMiOlsiUGxhbmUzRCIsIlBsYW5lM0QuY29uc3RydWN0b3IiLCJQbGFuZTNELmZyb21Qb2ludHMiLCJQbGFuZTNELmZyb21Ob3JtYWxBbmRQb2ludCIsIlBsYW5lM0Qubm9ybWFsaXplIiwiUGxhbmUzRC5kaXN0YW5jZSIsIlBsYW5lM0QuY2xhc3NpZnlQb2ludCIsIlBsYW5lM0QudG9TdHJpbmciXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sbUJBQW1CLFdBQVcsMENBQTBDLENBQUMsQ0FBQztBQUdqRixJQUFNLE9BQU87SUE4QlpBOztPQUVHQTtJQUNIQSxTQWpDS0EsT0FBT0EsQ0FpQ0FBLENBQVlBLEVBQUVBLENBQVlBLEVBQUVBLENBQVlBLEVBQUVBLENBQVlBO1FBQXREQyxpQkFBWUEsR0FBWkEsS0FBWUE7UUFBRUEsaUJBQVlBLEdBQVpBLEtBQVlBO1FBQUVBLGlCQUFZQSxHQUFaQSxLQUFZQTtRQUFFQSxpQkFBWUEsR0FBWkEsS0FBWUE7UUFFakVBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ1hBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ1hBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ1hBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBRVhBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRXRCQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQTtRQUUxQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFN0JBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBO1FBRTFDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUU3QkEsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7UUFFMUNBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBRVBBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLFNBQVNBLENBQUNBO1FBRXRDQSxDQUFDQTtJQUVGQSxDQUFDQTtJQUVERDs7Ozs7T0FLR0E7SUFDSUEsNEJBQVVBLEdBQWpCQSxVQUFrQkEsRUFBV0EsRUFBRUEsRUFBV0EsRUFBRUEsRUFBV0E7UUFFdERFLElBQUlBLEdBQUdBLEdBQVVBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO1FBQzdCQSxJQUFJQSxHQUFHQSxHQUFVQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUM3QkEsSUFBSUEsR0FBR0EsR0FBVUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFFN0JBLElBQUlBLEdBQUdBLEdBQVVBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO1FBQzdCQSxJQUFJQSxHQUFHQSxHQUFVQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUM3QkEsSUFBSUEsR0FBR0EsR0FBVUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFFN0JBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLEdBQUNBLEdBQUdBLEdBQUdBLEdBQUdBLEdBQUNBLEdBQUdBLENBQUNBO1FBQzNCQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxHQUFDQSxHQUFHQSxHQUFHQSxHQUFHQSxHQUFDQSxHQUFHQSxDQUFDQTtRQUMzQkEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsR0FBQ0EsR0FBR0EsR0FBR0EsR0FBR0EsR0FBQ0EsR0FBR0EsQ0FBQ0E7UUFDM0JBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO1FBRWpEQSxBQUNBQSw0RkFENEZBO1FBQzVGQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUVoQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7UUFFMUNBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRXZDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQTtRQUUxQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFdkNBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBO1FBRTFDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUVQQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxPQUFPQSxDQUFDQSxTQUFTQSxDQUFDQTtRQUV0Q0EsQ0FBQ0E7SUFFRkEsQ0FBQ0E7SUFFREY7Ozs7T0FJR0E7SUFDSUEsb0NBQWtCQSxHQUF6QkEsVUFBMEJBLE1BQWVBLEVBQUVBLEtBQWNBO1FBRXhERyxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNsQkEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDbEJBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ2xCQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUMxREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFaENBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBO1FBRTFDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUV2Q0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7UUFFMUNBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRXZDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQTtRQUUxQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFFUEEsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0EsU0FBU0EsQ0FBQ0E7UUFFdENBLENBQUNBO0lBRUZBLENBQUNBO0lBRURIOzs7T0FHR0E7SUFDSUEsMkJBQVNBLEdBQWhCQTtRQUVDSSxJQUFJQSxHQUFHQSxHQUFVQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUM1RUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDZEEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDZEEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDZEEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDZEEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7SUFDYkEsQ0FBQ0E7SUFFREo7Ozs7T0FJR0E7SUFDSUEsMEJBQVFBLEdBQWZBLFVBQWdCQSxDQUFVQTtRQUd6QkssRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsSUFBSUEsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFL0NBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBRTVCQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxJQUFJQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN0REEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDNUJBLENBQUNBO1FBRURBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLElBQUlBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBLENBQUNBLENBQUNBO1lBRXBEQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUU1QkEsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFFUEEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFFdERBLENBQUNBO0lBRUZBLENBQUNBO0lBRURMOzs7O09BSUdBO0lBQ0lBLCtCQUFhQSxHQUFwQkEsVUFBcUJBLENBQVVBLEVBQUVBLE9BQXFCQTtRQUFyQk0sdUJBQXFCQSxHQUFyQkEsY0FBcUJBO1FBRXJEQSxBQUNBQSxZQURZQTtRQUNaQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNwQkEsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxLQUFLQSxDQUFDQTtRQUVsQ0EsSUFBSUEsR0FBVUEsQ0FBQ0E7UUFDZkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsSUFBSUEsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7WUFDN0NBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLElBQUlBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBO1lBQzlFQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxJQUFJQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQTtZQUM5RUEsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUE7WUFDL0JBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBRXJEQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxDQUFDQSxPQUFPQSxDQUFDQTtZQUNsQkEsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxJQUFJQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxPQUFPQSxDQUFDQTtZQUN4REEsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxLQUFLQSxDQUFDQTtRQUFDQSxJQUFJQTtZQUN0Q0EsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxTQUFTQSxDQUFDQTtJQUN2Q0EsQ0FBQ0E7SUFFTU4sMEJBQVFBLEdBQWZBO1FBRUNPLE1BQU1BLENBQUNBLGFBQWFBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBO0lBQzNGQSxDQUFDQTtJQWxMRFAsdUNBQXVDQTtJQUN6QkEsaUJBQVNBLEdBQVVBLENBQUNBLENBQUNBO0lBQ3JCQSxxQkFBYUEsR0FBVUEsQ0FBQ0EsQ0FBQ0E7SUFDekJBLHFCQUFhQSxHQUFVQSxDQUFDQSxDQUFDQTtJQUN6QkEscUJBQWFBLEdBQVVBLENBQUNBLENBQUNBO0lBK0t4Q0EsY0FBQ0E7QUFBREEsQ0EzTUEsQUEyTUNBLElBQUE7QUFFRCxBQUFpQixpQkFBUixPQUFPLENBQUMiLCJmaWxlIjoiZ2VvbS9QbGFuZTNELmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBQbGFuZUNsYXNzaWZpY2F0aW9uXHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9QbGFuZUNsYXNzaWZpY2F0aW9uXCIpO1xuaW1wb3J0IFZlY3RvcjNEXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9WZWN0b3IzRFwiKTtcblxuY2xhc3MgUGxhbmUzRFxue1xuXHQvKipcblx0ICogVGhlIEEgY29lZmZpY2llbnQgb2YgdGhpcyBwbGFuZS4gKEFsc28gdGhlIHggZGltZW5zaW9uIG9mIHRoZSBwbGFuZSBub3JtYWwpXG5cdCAqL1xuXHRwdWJsaWMgYTpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBCIGNvZWZmaWNpZW50IG9mIHRoaXMgcGxhbmUuIChBbHNvIHRoZSB5IGRpbWVuc2lvbiBvZiB0aGUgcGxhbmUgbm9ybWFsKVxuXHQgKi9cblx0cHVibGljIGI6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgQyBjb2VmZmljaWVudCBvZiB0aGlzIHBsYW5lLiAoQWxzbyB0aGUgeiBkaW1lbnNpb24gb2YgdGhlIHBsYW5lIG5vcm1hbClcblx0ICovXG5cdHB1YmxpYyBjOm51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIEQgY29lZmZpY2llbnQgb2YgdGhpcyBwbGFuZS4gKEFsc28gdGhlIGludmVyc2UgZG90IHByb2R1Y3QgYmV0d2VlbiBub3JtYWwgYW5kIHBvaW50KVxuXHQgKi9cblx0cHVibGljIGQ6bnVtYmVyO1xuXG5cdHB1YmxpYyBfaUFsaWdubWVudDpudW1iZXI7XG5cblx0Ly8gaW5kaWNhdGVzIHRoZSBhbGlnbm1lbnQgb2YgdGhlIHBsYW5lXG5cdHB1YmxpYyBzdGF0aWMgQUxJR05fQU5ZOm51bWJlciA9IDA7XG5cdHB1YmxpYyBzdGF0aWMgQUxJR05fWFlfQVhJUzpudW1iZXIgPSAxO1xuXHRwdWJsaWMgc3RhdGljIEFMSUdOX1laX0FYSVM6bnVtYmVyID0gMjtcblx0cHVibGljIHN0YXRpYyBBTElHTl9YWl9BWElTOm51bWJlciA9IDM7XG5cblx0LyoqXG5cdCAqIENyZWF0ZSBhIFBsYW5lM0Qgd2l0aCBBQkNEIGNvZWZmaWNpZW50c1xuXHQgKi9cblx0Y29uc3RydWN0b3IoYTpudW1iZXIgPSAwLCBiOm51bWJlciA9IDAsIGM6bnVtYmVyID0gMCwgZDpudW1iZXIgPSAwKVxuXHR7XG5cdFx0dGhpcy5hID0gYTtcblx0XHR0aGlzLmIgPSBiO1xuXHRcdHRoaXMuYyA9IGM7XG5cdFx0dGhpcy5kID0gZDtcblxuXHRcdGlmIChhID09IDAgJiYgYiA9PSAwKSB7XG5cblx0XHRcdHRoaXMuX2lBbGlnbm1lbnQgPSBQbGFuZTNELkFMSUdOX1hZX0FYSVM7XG5cblx0XHR9IGVsc2UgaWYgKGIgPT0gMCAmJiBjID09IDApIHtcblxuXHRcdFx0dGhpcy5faUFsaWdubWVudCA9IFBsYW5lM0QuQUxJR05fWVpfQVhJUztcblxuXHRcdH0gZWxzZSBpZiAoYSA9PSAwICYmIGMgPT0gMCkge1xuXG5cdFx0XHR0aGlzLl9pQWxpZ25tZW50ID0gUGxhbmUzRC5BTElHTl9YWl9BWElTO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0dGhpcy5faUFsaWdubWVudCA9IFBsYW5lM0QuQUxJR05fQU5ZO1xuXG5cdFx0fVxuXG5cdH1cblxuXHQvKipcblx0ICogRmlsbHMgdGhpcyBQbGFuZTNEIHdpdGggdGhlIGNvZWZmaWNpZW50cyBmcm9tIDMgcG9pbnRzIGluIDNkIHNwYWNlLlxuXHQgKiBAcGFyYW0gcDAgVmVjdG9yM0Rcblx0ICogQHBhcmFtIHAxIFZlY3RvcjNEXG5cdCAqIEBwYXJhbSBwMiBWZWN0b3IzRFxuXHQgKi9cblx0cHVibGljIGZyb21Qb2ludHMocDA6VmVjdG9yM0QsIHAxOlZlY3RvcjNELCBwMjpWZWN0b3IzRClcblx0e1xuXHRcdHZhciBkMXg6bnVtYmVyID0gcDEueCAtIHAwLng7XG5cdFx0dmFyIGQxeTpudW1iZXIgPSBwMS55IC0gcDAueTtcblx0XHR2YXIgZDF6Om51bWJlciA9IHAxLnogLSBwMC56O1xuXG5cdFx0dmFyIGQyeDpudW1iZXIgPSBwMi54IC0gcDAueDtcblx0XHR2YXIgZDJ5Om51bWJlciA9IHAyLnkgLSBwMC55O1xuXHRcdHZhciBkMno6bnVtYmVyID0gcDIueiAtIHAwLno7XG5cblx0XHR0aGlzLmEgPSBkMXkqZDJ6IC0gZDF6KmQyeTtcblx0XHR0aGlzLmIgPSBkMXoqZDJ4IC0gZDF4KmQyejtcblx0XHR0aGlzLmMgPSBkMXgqZDJ5IC0gZDF5KmQyeDtcblx0XHR0aGlzLmQgPSB0aGlzLmEqcDAueCArIHRoaXMuYipwMC55ICsgdGhpcy5jKnAwLno7XG5cblx0XHQvLyBub3QgdXNpbmcgZXBzaWxvbiwgc2luY2UgYSBwbGFuZSBpcyBpbmZpbml0ZSBhbmQgYSBzbWFsbCBpbmNvcnJlY3Rpb24gY2FuIGdyb3cgdmVyeSBsYXJnZVxuXHRcdGlmICh0aGlzLmEgPT0gMCAmJiB0aGlzLmIgPT0gMCkge1xuXG5cdFx0XHR0aGlzLl9pQWxpZ25tZW50ID0gUGxhbmUzRC5BTElHTl9YWV9BWElTO1xuXG5cdFx0fSBlbHNlIGlmICh0aGlzLmIgPT0gMCAmJiB0aGlzLmMgPT0gMCkge1xuXG5cdFx0XHR0aGlzLl9pQWxpZ25tZW50ID0gUGxhbmUzRC5BTElHTl9ZWl9BWElTO1xuXG5cdFx0fSBlbHNlIGlmICh0aGlzLmEgPT0gMCAmJiB0aGlzLmMgPT0gMCkge1xuXG5cdFx0XHR0aGlzLl9pQWxpZ25tZW50ID0gUGxhbmUzRC5BTElHTl9YWl9BWElTO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0dGhpcy5faUFsaWdubWVudCA9IFBsYW5lM0QuQUxJR05fQU5ZO1xuXG5cdFx0fVxuXG5cdH1cblxuXHQvKipcblx0ICogRmlsbHMgdGhpcyBQbGFuZTNEIHdpdGggdGhlIGNvZWZmaWNpZW50cyBmcm9tIHRoZSBwbGFuZSdzIG5vcm1hbCBhbmQgYSBwb2ludCBpbiAzZCBzcGFjZS5cblx0ICogQHBhcmFtIG5vcm1hbCBWZWN0b3IzRFxuXHQgKiBAcGFyYW0gcG9pbnQgIFZlY3RvcjNEXG5cdCAqL1xuXHRwdWJsaWMgZnJvbU5vcm1hbEFuZFBvaW50KG5vcm1hbDpWZWN0b3IzRCwgcG9pbnQ6VmVjdG9yM0QpXG5cdHtcblx0XHR0aGlzLmEgPSBub3JtYWwueDtcblx0XHR0aGlzLmIgPSBub3JtYWwueTtcblx0XHR0aGlzLmMgPSBub3JtYWwuejtcblx0XHR0aGlzLmQgPSB0aGlzLmEqcG9pbnQueCArIHRoaXMuYipwb2ludC55ICsgdGhpcy5jKnBvaW50Lno7XG5cdFx0aWYgKHRoaXMuYSA9PSAwICYmIHRoaXMuYiA9PSAwKSB7XG5cblx0XHRcdHRoaXMuX2lBbGlnbm1lbnQgPSBQbGFuZTNELkFMSUdOX1hZX0FYSVM7XG5cblx0XHR9IGVsc2UgaWYgKHRoaXMuYiA9PSAwICYmIHRoaXMuYyA9PSAwKSB7XG5cblx0XHRcdHRoaXMuX2lBbGlnbm1lbnQgPSBQbGFuZTNELkFMSUdOX1laX0FYSVM7XG5cblx0XHR9IGVsc2UgaWYgKHRoaXMuYSA9PSAwICYmIHRoaXMuYyA9PSAwKSB7XG5cblx0XHRcdHRoaXMuX2lBbGlnbm1lbnQgPSBQbGFuZTNELkFMSUdOX1haX0FYSVM7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHR0aGlzLl9pQWxpZ25tZW50ID0gUGxhbmUzRC5BTElHTl9BTlk7XG5cblx0XHR9XG5cblx0fVxuXG5cdC8qKlxuXHQgKiBOb3JtYWxpemUgdGhpcyBQbGFuZTNEXG5cdCAqIEByZXR1cm4gUGxhbmUzRCBUaGlzIFBsYW5lM0QuXG5cdCAqL1xuXHRwdWJsaWMgbm9ybWFsaXplKCk6UGxhbmUzRFxuXHR7XG5cdFx0dmFyIGxlbjpudW1iZXIgPSAxL01hdGguc3FydCh0aGlzLmEqdGhpcy5hICsgdGhpcy5iKnRoaXMuYiArIHRoaXMuYyp0aGlzLmMpO1xuXHRcdHRoaXMuYSAqPSBsZW47XG5cdFx0dGhpcy5iICo9IGxlbjtcblx0XHR0aGlzLmMgKj0gbGVuO1xuXHRcdHRoaXMuZCAqPSBsZW47XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHQvKipcblx0ICogUmV0dXJucyB0aGUgc2lnbmVkIGRpc3RhbmNlIGJldHdlZW4gdGhpcyBQbGFuZTNEIGFuZCB0aGUgcG9pbnQgcC5cblx0ICogQHBhcmFtIHAgVmVjdG9yM0Rcblx0ICogQHJldHVybnMgTnVtYmVyXG5cdCAqL1xuXHRwdWJsaWMgZGlzdGFuY2UocDpWZWN0b3IzRCk6bnVtYmVyXG5cdHtcblxuXHRcdGlmICh0aGlzLl9pQWxpZ25tZW50ID09IFBsYW5lM0QuQUxJR05fWVpfQVhJUykge1xuXG5cdFx0XHRyZXR1cm4gdGhpcy5hKnAueCAtIHRoaXMuZDtcblxuXHRcdH0gZWxzZSBpZiAodGhpcy5faUFsaWdubWVudCA9PSBQbGFuZTNELkFMSUdOX1haX0FYSVMpIHtcblx0XHRcdHJldHVybiB0aGlzLmIqcC55IC0gdGhpcy5kO1xuXHRcdH1cblxuXHRcdGVsc2UgaWYgKHRoaXMuX2lBbGlnbm1lbnQgPT0gUGxhbmUzRC5BTElHTl9YWV9BWElTKSB7XG5cblx0XHRcdHJldHVybiB0aGlzLmMqcC56IC0gdGhpcy5kO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0cmV0dXJuIHRoaXMuYSpwLnggKyB0aGlzLmIqcC55ICsgdGhpcy5jKnAueiAtIHRoaXMuZDtcblxuXHRcdH1cblxuXHR9XG5cblx0LyoqXG5cdCAqIENsYXNzaWZ5IGEgcG9pbnQgYWdhaW5zdCB0aGlzIFBsYW5lM0QuIChpbiBmcm9udCwgYmFjayBvciBpbnRlcnNlY3RpbmcpXG5cdCAqIEBwYXJhbSBwIFZlY3RvcjNEXG5cdCAqIEByZXR1cm4gaW50IFBsYW5lMy5GUk9OVCBvciBQbGFuZTNELkJBQ0sgb3IgUGxhbmUzRC5JTlRFUlNFQ1Rcblx0ICovXG5cdHB1YmxpYyBjbGFzc2lmeVBvaW50KHA6VmVjdG9yM0QsIGVwc2lsb246bnVtYmVyID0gMC4wMSk6bnVtYmVyXG5cdHtcblx0XHQvLyBjaGVjayBOYU5cblx0XHRpZiAodGhpcy5kICE9IHRoaXMuZClcblx0XHRcdHJldHVybiBQbGFuZUNsYXNzaWZpY2F0aW9uLkZST05UO1xuXG5cdFx0dmFyIGxlbjpudW1iZXI7XG5cdFx0aWYgKHRoaXMuX2lBbGlnbm1lbnQgPT0gUGxhbmUzRC5BTElHTl9ZWl9BWElTKVxuXHRcdFx0bGVuID0gdGhpcy5hKnAueCAtIHRoaXMuZDsgZWxzZSBpZiAodGhpcy5faUFsaWdubWVudCA9PSBQbGFuZTNELkFMSUdOX1haX0FYSVMpXG5cdFx0XHRsZW4gPSB0aGlzLmIqcC55IC0gdGhpcy5kOyBlbHNlIGlmICh0aGlzLl9pQWxpZ25tZW50ID09IFBsYW5lM0QuQUxJR05fWFlfQVhJUylcblx0XHRcdGxlbiA9IHRoaXMuYypwLnogLSB0aGlzLmQ7IGVsc2Vcblx0XHRcdGxlbiA9IHRoaXMuYSpwLnggKyB0aGlzLmIqcC55ICsgdGhpcy5jKnAueiAtIHRoaXMuZDtcblxuXHRcdGlmIChsZW4gPCAtZXBzaWxvbilcblx0XHRcdHJldHVybiBQbGFuZUNsYXNzaWZpY2F0aW9uLkJBQ0s7IGVsc2UgaWYgKGxlbiA+IGVwc2lsb24pXG5cdFx0XHRyZXR1cm4gUGxhbmVDbGFzc2lmaWNhdGlvbi5GUk9OVDsgZWxzZVxuXHRcdFx0cmV0dXJuIFBsYW5lQ2xhc3NpZmljYXRpb24uSU5URVJTRUNUO1xuXHR9XG5cblx0cHVibGljIHRvU3RyaW5nKCk6c3RyaW5nXG5cdHtcblx0XHRyZXR1cm4gXCJQbGFuZTNEIFthOlwiICsgdGhpcy5hICsgXCIsIGI6XCIgKyB0aGlzLmIgKyBcIiwgYzpcIiArIHRoaXMuYyArIFwiLCBkOlwiICsgdGhpcy5kICsgXCJdXCI7XG5cdH1cbn1cblxuZXhwb3J0ID0gUGxhbmUzRDsiXX0=