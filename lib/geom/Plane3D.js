var PlaneClassification = require("awayjs-core/lib/geom/PlaneClassification");
var Plane3D = (function () {
    /**
     * Create a Plane3D with ABCD coefficients
     */
    function Plane3D(a, b, c, d) {
        if (a === void 0) { a = 0; }
        if (b === void 0) { b = 0; }
        if (c === void 0) { c = 0; }
        if (d === void 0) { d = 0; }
        this.a = a;
        this.b = b;
        this.c = c;
        this.d = d;
        if (a == 0 && b == 0) {
            this._iAlignment = Plane3D.ALIGN_XY_AXIS;
        }
        else if (b == 0 && c == 0) {
            this._iAlignment = Plane3D.ALIGN_YZ_AXIS;
        }
        else if (a == 0 && c == 0) {
            this._iAlignment = Plane3D.ALIGN_XZ_AXIS;
        }
        else {
            this._iAlignment = Plane3D.ALIGN_ANY;
        }
    }
    /**
     * Fills this Plane3D with the coefficients from 3 points in 3d space.
     * @param p0 Vector3D
     * @param p1 Vector3D
     * @param p2 Vector3D
     */
    Plane3D.prototype.fromPoints = function (p0, p1, p2) {
        var d1x = p1.x - p0.x;
        var d1y = p1.y - p0.y;
        var d1z = p1.z - p0.z;
        var d2x = p2.x - p0.x;
        var d2y = p2.y - p0.y;
        var d2z = p2.z - p0.z;
        this.a = d1y * d2z - d1z * d2y;
        this.b = d1z * d2x - d1x * d2z;
        this.c = d1x * d2y - d1y * d2x;
        this.d = this.a * p0.x + this.b * p0.y + this.c * p0.z;
        // not using epsilon, since a plane is infinite and a small incorrection can grow very large
        if (this.a == 0 && this.b == 0) {
            this._iAlignment = Plane3D.ALIGN_XY_AXIS;
        }
        else if (this.b == 0 && this.c == 0) {
            this._iAlignment = Plane3D.ALIGN_YZ_AXIS;
        }
        else if (this.a == 0 && this.c == 0) {
            this._iAlignment = Plane3D.ALIGN_XZ_AXIS;
        }
        else {
            this._iAlignment = Plane3D.ALIGN_ANY;
        }
    };
    /**
     * Fills this Plane3D with the coefficients from the plane's normal and a point in 3d space.
     * @param normal Vector3D
     * @param point  Vector3D
     */
    Plane3D.prototype.fromNormalAndPoint = function (normal, point) {
        this.a = normal.x;
        this.b = normal.y;
        this.c = normal.z;
        this.d = this.a * point.x + this.b * point.y + this.c * point.z;
        if (this.a == 0 && this.b == 0) {
            this._iAlignment = Plane3D.ALIGN_XY_AXIS;
        }
        else if (this.b == 0 && this.c == 0) {
            this._iAlignment = Plane3D.ALIGN_YZ_AXIS;
        }
        else if (this.a == 0 && this.c == 0) {
            this._iAlignment = Plane3D.ALIGN_XZ_AXIS;
        }
        else {
            this._iAlignment = Plane3D.ALIGN_ANY;
        }
    };
    /**
     * Normalize this Plane3D
     * @return Plane3D This Plane3D.
     */
    Plane3D.prototype.normalize = function () {
        var len = 1 / Math.sqrt(this.a * this.a + this.b * this.b + this.c * this.c);
        this.a *= len;
        this.b *= len;
        this.c *= len;
        this.d *= len;
        return this;
    };
    /**
     * Returns the signed distance between this Plane3D and the point p.
     * @param p Vector3D
     * @returns Number
     */
    Plane3D.prototype.distance = function (p) {
        if (this._iAlignment == Plane3D.ALIGN_YZ_AXIS) {
            return this.a * p.x - this.d;
        }
        else if (this._iAlignment == Plane3D.ALIGN_XZ_AXIS) {
            return this.b * p.y - this.d;
        }
        else if (this._iAlignment == Plane3D.ALIGN_XY_AXIS) {
            return this.c * p.z - this.d;
        }
        else {
            return this.a * p.x + this.b * p.y + this.c * p.z - this.d;
        }
    };
    /**
     * Classify a point against this Plane3D. (in front, back or intersecting)
     * @param p Vector3D
     * @return int Plane3.FRONT or Plane3D.BACK or Plane3D.INTERSECT
     */
    Plane3D.prototype.classifyPoint = function (p, epsilon) {
        if (epsilon === void 0) { epsilon = 0.01; }
        // check NaN
        if (this.d != this.d)
            return PlaneClassification.FRONT;
        var len;
        if (this._iAlignment == Plane3D.ALIGN_YZ_AXIS)
            len = this.a * p.x - this.d;
        else if (this._iAlignment == Plane3D.ALIGN_XZ_AXIS)
            len = this.b * p.y - this.d;
        else if (this._iAlignment == Plane3D.ALIGN_XY_AXIS)
            len = this.c * p.z - this.d;
        else
            len = this.a * p.x + this.b * p.y + this.c * p.z - this.d;
        if (len < -epsilon)
            return PlaneClassification.BACK;
        else if (len > epsilon)
            return PlaneClassification.FRONT;
        else
            return PlaneClassification.INTERSECT;
    };
    Plane3D.prototype.toString = function () {
        return "Plane3D [a:" + this.a + ", b:" + this.b + ", c:" + this.c + ", d:" + this.d + "]";
    };
    // indicates the alignment of the plane
    Plane3D.ALIGN_ANY = 0;
    Plane3D.ALIGN_XY_AXIS = 1;
    Plane3D.ALIGN_YZ_AXIS = 2;
    Plane3D.ALIGN_XZ_AXIS = 3;
    return Plane3D;
})();
module.exports = Plane3D;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1jb3JlL2xpYi9nZW9tL1BsYW5lM0QudHMiXSwibmFtZXMiOlsiUGxhbmUzRCIsIlBsYW5lM0QuY29uc3RydWN0b3IiLCJQbGFuZTNELmZyb21Qb2ludHMiLCJQbGFuZTNELmZyb21Ob3JtYWxBbmRQb2ludCIsIlBsYW5lM0Qubm9ybWFsaXplIiwiUGxhbmUzRC5kaXN0YW5jZSIsIlBsYW5lM0QuY2xhc3NpZnlQb2ludCIsIlBsYW5lM0QudG9TdHJpbmciXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sbUJBQW1CLFdBQVcsMENBQTBDLENBQUMsQ0FBQztBQUdqRixJQUFNLE9BQU87SUE4QlpBOztPQUVHQTtJQUNIQSxTQWpDS0EsT0FBT0EsQ0FpQ0FBLENBQVlBLEVBQUVBLENBQVlBLEVBQUVBLENBQVlBLEVBQUVBLENBQVlBO1FBQXREQyxpQkFBWUEsR0FBWkEsS0FBWUE7UUFBRUEsaUJBQVlBLEdBQVpBLEtBQVlBO1FBQUVBLGlCQUFZQSxHQUFaQSxLQUFZQTtRQUFFQSxpQkFBWUEsR0FBWkEsS0FBWUE7UUFFakVBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ1hBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ1hBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ1hBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBRVhBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRXRCQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQTtRQUUxQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFN0JBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBO1FBRTFDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUU3QkEsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7UUFFMUNBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBRVBBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLFNBQVNBLENBQUNBO1FBRXRDQSxDQUFDQTtJQUVGQSxDQUFDQTtJQUVERDs7Ozs7T0FLR0E7SUFDSUEsNEJBQVVBLEdBQWpCQSxVQUFrQkEsRUFBV0EsRUFBRUEsRUFBV0EsRUFBRUEsRUFBV0E7UUFFdERFLElBQUlBLEdBQUdBLEdBQVVBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO1FBQzdCQSxJQUFJQSxHQUFHQSxHQUFVQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUM3QkEsSUFBSUEsR0FBR0EsR0FBVUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFFN0JBLElBQUlBLEdBQUdBLEdBQVVBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO1FBQzdCQSxJQUFJQSxHQUFHQSxHQUFVQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUM3QkEsSUFBSUEsR0FBR0EsR0FBVUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFFN0JBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLEdBQUNBLEdBQUdBLEdBQUdBLEdBQUdBLEdBQUNBLEdBQUdBLENBQUNBO1FBQzNCQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxHQUFDQSxHQUFHQSxHQUFHQSxHQUFHQSxHQUFDQSxHQUFHQSxDQUFDQTtRQUMzQkEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsR0FBQ0EsR0FBR0EsR0FBR0EsR0FBR0EsR0FBQ0EsR0FBR0EsQ0FBQ0E7UUFDM0JBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO1FBRWpEQSxBQUNBQSw0RkFENEZBO1FBQzVGQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUVoQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7UUFFMUNBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRXZDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQTtRQUUxQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFdkNBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBO1FBRTFDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUVQQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxPQUFPQSxDQUFDQSxTQUFTQSxDQUFDQTtRQUV0Q0EsQ0FBQ0E7SUFFRkEsQ0FBQ0E7SUFFREY7Ozs7T0FJR0E7SUFDSUEsb0NBQWtCQSxHQUF6QkEsVUFBMEJBLE1BQWVBLEVBQUVBLEtBQWNBO1FBRXhERyxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNsQkEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDbEJBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ2xCQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUMxREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFaENBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBO1FBRTFDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUV2Q0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7UUFFMUNBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBRXZDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQTtRQUUxQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFFUEEsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsT0FBT0EsQ0FBQ0EsU0FBU0EsQ0FBQ0E7UUFFdENBLENBQUNBO0lBRUZBLENBQUNBO0lBRURIOzs7T0FHR0E7SUFDSUEsMkJBQVNBLEdBQWhCQTtRQUVDSSxJQUFJQSxHQUFHQSxHQUFVQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUM1RUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDZEEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDZEEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDZEEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDZEEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7SUFDYkEsQ0FBQ0E7SUFFREo7Ozs7T0FJR0E7SUFDSUEsMEJBQVFBLEdBQWZBLFVBQWdCQSxDQUFVQTtRQUd6QkssRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsSUFBSUEsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFL0NBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBRTVCQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxJQUFJQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN0REEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDNUJBLENBQUNBO1FBRURBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLElBQUlBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBLENBQUNBLENBQUNBO1lBRXBEQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUU1QkEsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFFUEEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFFdERBLENBQUNBO0lBRUZBLENBQUNBO0lBRURMOzs7O09BSUdBO0lBQ0lBLCtCQUFhQSxHQUFwQkEsVUFBcUJBLENBQVVBLEVBQUVBLE9BQXFCQTtRQUFyQk0sdUJBQXFCQSxHQUFyQkEsY0FBcUJBO1FBRXJEQSxBQUNBQSxZQURZQTtRQUNaQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNwQkEsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxLQUFLQSxDQUFDQTtRQUVsQ0EsSUFBSUEsR0FBVUEsQ0FBQ0E7UUFDZkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsSUFBSUEsT0FBT0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7WUFDN0NBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLElBQUlBLE9BQU9BLENBQUNBLGFBQWFBLENBQUNBO1lBQzlFQSxHQUFHQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxJQUFJQSxPQUFPQSxDQUFDQSxhQUFhQSxDQUFDQTtZQUM5RUEsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFBQ0EsSUFBSUE7WUFDL0JBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1FBRXJEQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxDQUFDQSxPQUFPQSxDQUFDQTtZQUNsQkEsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxJQUFJQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxPQUFPQSxDQUFDQTtZQUN4REEsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxLQUFLQSxDQUFDQTtRQUFDQSxJQUFJQTtZQUN0Q0EsTUFBTUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxTQUFTQSxDQUFDQTtJQUN2Q0EsQ0FBQ0E7SUFFTU4sMEJBQVFBLEdBQWZBO1FBRUNPLE1BQU1BLENBQUNBLGFBQWFBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBO0lBQzNGQSxDQUFDQTtJQWxMRFAsdUNBQXVDQTtJQUN6QkEsaUJBQVNBLEdBQVVBLENBQUNBLENBQUNBO0lBQ3JCQSxxQkFBYUEsR0FBVUEsQ0FBQ0EsQ0FBQ0E7SUFDekJBLHFCQUFhQSxHQUFVQSxDQUFDQSxDQUFDQTtJQUN6QkEscUJBQWFBLEdBQVVBLENBQUNBLENBQUNBO0lBK0t4Q0EsY0FBQ0E7QUFBREEsQ0EzTUEsQUEyTUNBLElBQUE7QUFFRCxBQUFpQixpQkFBUixPQUFPLENBQUMiLCJmaWxlIjoiZ2VvbS9QbGFuZTNELmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBQbGFuZUNsYXNzaWZpY2F0aW9uXHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9QbGFuZUNsYXNzaWZpY2F0aW9uXCIpO1xyXG5pbXBvcnQgVmVjdG9yM0RcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1ZlY3RvcjNEXCIpO1xyXG5cclxuY2xhc3MgUGxhbmUzRFxyXG57XHJcblx0LyoqXHJcblx0ICogVGhlIEEgY29lZmZpY2llbnQgb2YgdGhpcyBwbGFuZS4gKEFsc28gdGhlIHggZGltZW5zaW9uIG9mIHRoZSBwbGFuZSBub3JtYWwpXHJcblx0ICovXHJcblx0cHVibGljIGE6bnVtYmVyO1xyXG5cclxuXHQvKipcclxuXHQgKiBUaGUgQiBjb2VmZmljaWVudCBvZiB0aGlzIHBsYW5lLiAoQWxzbyB0aGUgeSBkaW1lbnNpb24gb2YgdGhlIHBsYW5lIG5vcm1hbClcclxuXHQgKi9cclxuXHRwdWJsaWMgYjpudW1iZXI7XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZSBDIGNvZWZmaWNpZW50IG9mIHRoaXMgcGxhbmUuIChBbHNvIHRoZSB6IGRpbWVuc2lvbiBvZiB0aGUgcGxhbmUgbm9ybWFsKVxyXG5cdCAqL1xyXG5cdHB1YmxpYyBjOm51bWJlcjtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIEQgY29lZmZpY2llbnQgb2YgdGhpcyBwbGFuZS4gKEFsc28gdGhlIGludmVyc2UgZG90IHByb2R1Y3QgYmV0d2VlbiBub3JtYWwgYW5kIHBvaW50KVxyXG5cdCAqL1xyXG5cdHB1YmxpYyBkOm51bWJlcjtcclxuXHJcblx0cHVibGljIF9pQWxpZ25tZW50Om51bWJlcjtcclxuXHJcblx0Ly8gaW5kaWNhdGVzIHRoZSBhbGlnbm1lbnQgb2YgdGhlIHBsYW5lXHJcblx0cHVibGljIHN0YXRpYyBBTElHTl9BTlk6bnVtYmVyID0gMDtcclxuXHRwdWJsaWMgc3RhdGljIEFMSUdOX1hZX0FYSVM6bnVtYmVyID0gMTtcclxuXHRwdWJsaWMgc3RhdGljIEFMSUdOX1laX0FYSVM6bnVtYmVyID0gMjtcclxuXHRwdWJsaWMgc3RhdGljIEFMSUdOX1haX0FYSVM6bnVtYmVyID0gMztcclxuXHJcblx0LyoqXHJcblx0ICogQ3JlYXRlIGEgUGxhbmUzRCB3aXRoIEFCQ0QgY29lZmZpY2llbnRzXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IoYTpudW1iZXIgPSAwLCBiOm51bWJlciA9IDAsIGM6bnVtYmVyID0gMCwgZDpudW1iZXIgPSAwKVxyXG5cdHtcclxuXHRcdHRoaXMuYSA9IGE7XHJcblx0XHR0aGlzLmIgPSBiO1xyXG5cdFx0dGhpcy5jID0gYztcclxuXHRcdHRoaXMuZCA9IGQ7XHJcblxyXG5cdFx0aWYgKGEgPT0gMCAmJiBiID09IDApIHtcclxuXHJcblx0XHRcdHRoaXMuX2lBbGlnbm1lbnQgPSBQbGFuZTNELkFMSUdOX1hZX0FYSVM7XHJcblxyXG5cdFx0fSBlbHNlIGlmIChiID09IDAgJiYgYyA9PSAwKSB7XHJcblxyXG5cdFx0XHR0aGlzLl9pQWxpZ25tZW50ID0gUGxhbmUzRC5BTElHTl9ZWl9BWElTO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAoYSA9PSAwICYmIGMgPT0gMCkge1xyXG5cclxuXHRcdFx0dGhpcy5faUFsaWdubWVudCA9IFBsYW5lM0QuQUxJR05fWFpfQVhJUztcclxuXHJcblx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0dGhpcy5faUFsaWdubWVudCA9IFBsYW5lM0QuQUxJR05fQU5ZO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBGaWxscyB0aGlzIFBsYW5lM0Qgd2l0aCB0aGUgY29lZmZpY2llbnRzIGZyb20gMyBwb2ludHMgaW4gM2Qgc3BhY2UuXHJcblx0ICogQHBhcmFtIHAwIFZlY3RvcjNEXHJcblx0ICogQHBhcmFtIHAxIFZlY3RvcjNEXHJcblx0ICogQHBhcmFtIHAyIFZlY3RvcjNEXHJcblx0ICovXHJcblx0cHVibGljIGZyb21Qb2ludHMocDA6VmVjdG9yM0QsIHAxOlZlY3RvcjNELCBwMjpWZWN0b3IzRClcclxuXHR7XHJcblx0XHR2YXIgZDF4Om51bWJlciA9IHAxLnggLSBwMC54O1xyXG5cdFx0dmFyIGQxeTpudW1iZXIgPSBwMS55IC0gcDAueTtcclxuXHRcdHZhciBkMXo6bnVtYmVyID0gcDEueiAtIHAwLno7XHJcblxyXG5cdFx0dmFyIGQyeDpudW1iZXIgPSBwMi54IC0gcDAueDtcclxuXHRcdHZhciBkMnk6bnVtYmVyID0gcDIueSAtIHAwLnk7XHJcblx0XHR2YXIgZDJ6Om51bWJlciA9IHAyLnogLSBwMC56O1xyXG5cclxuXHRcdHRoaXMuYSA9IGQxeSpkMnogLSBkMXoqZDJ5O1xyXG5cdFx0dGhpcy5iID0gZDF6KmQyeCAtIGQxeCpkMno7XHJcblx0XHR0aGlzLmMgPSBkMXgqZDJ5IC0gZDF5KmQyeDtcclxuXHRcdHRoaXMuZCA9IHRoaXMuYSpwMC54ICsgdGhpcy5iKnAwLnkgKyB0aGlzLmMqcDAuejtcclxuXHJcblx0XHQvLyBub3QgdXNpbmcgZXBzaWxvbiwgc2luY2UgYSBwbGFuZSBpcyBpbmZpbml0ZSBhbmQgYSBzbWFsbCBpbmNvcnJlY3Rpb24gY2FuIGdyb3cgdmVyeSBsYXJnZVxyXG5cdFx0aWYgKHRoaXMuYSA9PSAwICYmIHRoaXMuYiA9PSAwKSB7XHJcblxyXG5cdFx0XHR0aGlzLl9pQWxpZ25tZW50ID0gUGxhbmUzRC5BTElHTl9YWV9BWElTO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAodGhpcy5iID09IDAgJiYgdGhpcy5jID09IDApIHtcclxuXHJcblx0XHRcdHRoaXMuX2lBbGlnbm1lbnQgPSBQbGFuZTNELkFMSUdOX1laX0FYSVM7XHJcblxyXG5cdFx0fSBlbHNlIGlmICh0aGlzLmEgPT0gMCAmJiB0aGlzLmMgPT0gMCkge1xyXG5cclxuXHRcdFx0dGhpcy5faUFsaWdubWVudCA9IFBsYW5lM0QuQUxJR05fWFpfQVhJUztcclxuXHJcblx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0dGhpcy5faUFsaWdubWVudCA9IFBsYW5lM0QuQUxJR05fQU5ZO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBGaWxscyB0aGlzIFBsYW5lM0Qgd2l0aCB0aGUgY29lZmZpY2llbnRzIGZyb20gdGhlIHBsYW5lJ3Mgbm9ybWFsIGFuZCBhIHBvaW50IGluIDNkIHNwYWNlLlxyXG5cdCAqIEBwYXJhbSBub3JtYWwgVmVjdG9yM0RcclxuXHQgKiBAcGFyYW0gcG9pbnQgIFZlY3RvcjNEXHJcblx0ICovXHJcblx0cHVibGljIGZyb21Ob3JtYWxBbmRQb2ludChub3JtYWw6VmVjdG9yM0QsIHBvaW50OlZlY3RvcjNEKVxyXG5cdHtcclxuXHRcdHRoaXMuYSA9IG5vcm1hbC54O1xyXG5cdFx0dGhpcy5iID0gbm9ybWFsLnk7XHJcblx0XHR0aGlzLmMgPSBub3JtYWwuejtcclxuXHRcdHRoaXMuZCA9IHRoaXMuYSpwb2ludC54ICsgdGhpcy5iKnBvaW50LnkgKyB0aGlzLmMqcG9pbnQuejtcclxuXHRcdGlmICh0aGlzLmEgPT0gMCAmJiB0aGlzLmIgPT0gMCkge1xyXG5cclxuXHRcdFx0dGhpcy5faUFsaWdubWVudCA9IFBsYW5lM0QuQUxJR05fWFlfQVhJUztcclxuXHJcblx0XHR9IGVsc2UgaWYgKHRoaXMuYiA9PSAwICYmIHRoaXMuYyA9PSAwKSB7XHJcblxyXG5cdFx0XHR0aGlzLl9pQWxpZ25tZW50ID0gUGxhbmUzRC5BTElHTl9ZWl9BWElTO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAodGhpcy5hID09IDAgJiYgdGhpcy5jID09IDApIHtcclxuXHJcblx0XHRcdHRoaXMuX2lBbGlnbm1lbnQgPSBQbGFuZTNELkFMSUdOX1haX0FYSVM7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdHRoaXMuX2lBbGlnbm1lbnQgPSBQbGFuZTNELkFMSUdOX0FOWTtcclxuXHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogTm9ybWFsaXplIHRoaXMgUGxhbmUzRFxyXG5cdCAqIEByZXR1cm4gUGxhbmUzRCBUaGlzIFBsYW5lM0QuXHJcblx0ICovXHJcblx0cHVibGljIG5vcm1hbGl6ZSgpOlBsYW5lM0RcclxuXHR7XHJcblx0XHR2YXIgbGVuOm51bWJlciA9IDEvTWF0aC5zcXJ0KHRoaXMuYSp0aGlzLmEgKyB0aGlzLmIqdGhpcy5iICsgdGhpcy5jKnRoaXMuYyk7XHJcblx0XHR0aGlzLmEgKj0gbGVuO1xyXG5cdFx0dGhpcy5iICo9IGxlbjtcclxuXHRcdHRoaXMuYyAqPSBsZW47XHJcblx0XHR0aGlzLmQgKj0gbGVuO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZXR1cm5zIHRoZSBzaWduZWQgZGlzdGFuY2UgYmV0d2VlbiB0aGlzIFBsYW5lM0QgYW5kIHRoZSBwb2ludCBwLlxyXG5cdCAqIEBwYXJhbSBwIFZlY3RvcjNEXHJcblx0ICogQHJldHVybnMgTnVtYmVyXHJcblx0ICovXHJcblx0cHVibGljIGRpc3RhbmNlKHA6VmVjdG9yM0QpOm51bWJlclxyXG5cdHtcclxuXHJcblx0XHRpZiAodGhpcy5faUFsaWdubWVudCA9PSBQbGFuZTNELkFMSUdOX1laX0FYSVMpIHtcclxuXHJcblx0XHRcdHJldHVybiB0aGlzLmEqcC54IC0gdGhpcy5kO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAodGhpcy5faUFsaWdubWVudCA9PSBQbGFuZTNELkFMSUdOX1haX0FYSVMpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuYipwLnkgLSB0aGlzLmQ7XHJcblx0XHR9XHJcblxyXG5cdFx0ZWxzZSBpZiAodGhpcy5faUFsaWdubWVudCA9PSBQbGFuZTNELkFMSUdOX1hZX0FYSVMpIHtcclxuXHJcblx0XHRcdHJldHVybiB0aGlzLmMqcC56IC0gdGhpcy5kO1xyXG5cclxuXHRcdH0gZWxzZSB7XHJcblxyXG5cdFx0XHRyZXR1cm4gdGhpcy5hKnAueCArIHRoaXMuYipwLnkgKyB0aGlzLmMqcC56IC0gdGhpcy5kO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDbGFzc2lmeSBhIHBvaW50IGFnYWluc3QgdGhpcyBQbGFuZTNELiAoaW4gZnJvbnQsIGJhY2sgb3IgaW50ZXJzZWN0aW5nKVxyXG5cdCAqIEBwYXJhbSBwIFZlY3RvcjNEXHJcblx0ICogQHJldHVybiBpbnQgUGxhbmUzLkZST05UIG9yIFBsYW5lM0QuQkFDSyBvciBQbGFuZTNELklOVEVSU0VDVFxyXG5cdCAqL1xyXG5cdHB1YmxpYyBjbGFzc2lmeVBvaW50KHA6VmVjdG9yM0QsIGVwc2lsb246bnVtYmVyID0gMC4wMSk6bnVtYmVyXHJcblx0e1xyXG5cdFx0Ly8gY2hlY2sgTmFOXHJcblx0XHRpZiAodGhpcy5kICE9IHRoaXMuZClcclxuXHRcdFx0cmV0dXJuIFBsYW5lQ2xhc3NpZmljYXRpb24uRlJPTlQ7XHJcblxyXG5cdFx0dmFyIGxlbjpudW1iZXI7XHJcblx0XHRpZiAodGhpcy5faUFsaWdubWVudCA9PSBQbGFuZTNELkFMSUdOX1laX0FYSVMpXHJcblx0XHRcdGxlbiA9IHRoaXMuYSpwLnggLSB0aGlzLmQ7IGVsc2UgaWYgKHRoaXMuX2lBbGlnbm1lbnQgPT0gUGxhbmUzRC5BTElHTl9YWl9BWElTKVxyXG5cdFx0XHRsZW4gPSB0aGlzLmIqcC55IC0gdGhpcy5kOyBlbHNlIGlmICh0aGlzLl9pQWxpZ25tZW50ID09IFBsYW5lM0QuQUxJR05fWFlfQVhJUylcclxuXHRcdFx0bGVuID0gdGhpcy5jKnAueiAtIHRoaXMuZDsgZWxzZVxyXG5cdFx0XHRsZW4gPSB0aGlzLmEqcC54ICsgdGhpcy5iKnAueSArIHRoaXMuYypwLnogLSB0aGlzLmQ7XHJcblxyXG5cdFx0aWYgKGxlbiA8IC1lcHNpbG9uKVxyXG5cdFx0XHRyZXR1cm4gUGxhbmVDbGFzc2lmaWNhdGlvbi5CQUNLOyBlbHNlIGlmIChsZW4gPiBlcHNpbG9uKVxyXG5cdFx0XHRyZXR1cm4gUGxhbmVDbGFzc2lmaWNhdGlvbi5GUk9OVDsgZWxzZVxyXG5cdFx0XHRyZXR1cm4gUGxhbmVDbGFzc2lmaWNhdGlvbi5JTlRFUlNFQ1Q7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgdG9TdHJpbmcoKTpzdHJpbmdcclxuXHR7XHJcblx0XHRyZXR1cm4gXCJQbGFuZTNEIFthOlwiICsgdGhpcy5hICsgXCIsIGI6XCIgKyB0aGlzLmIgKyBcIiwgYzpcIiArIHRoaXMuYyArIFwiLCBkOlwiICsgdGhpcy5kICsgXCJdXCI7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgPSBQbGFuZTNEOyJdfQ==