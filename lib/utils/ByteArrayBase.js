var AbstractMethodError = require("awayjs-core/lib/errors/AbstractMethodError");

var ByteArrayBase = (function () {
    function ByteArrayBase() {
        this.position = 0;
        this.length = 0;
        this._mode = "";
    }
    ByteArrayBase.prototype.writeByte = function (b) {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.readByte = function () {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.writeUnsignedByte = function (b) {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.readUnsignedByte = function () {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.writeUnsignedShort = function (b) {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.readUnsignedShort = function () {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.writeUnsignedInt = function (b) {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.readUnsignedInt = function () {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.writeFloat = function (b) {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.toFloatBits = function (x) {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.readFloat = function (b) {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.fromFloatBits = function (x) {
        throw "Virtual method";
    };

    ByteArrayBase.prototype.getBytesAvailable = function () {
        throw new AbstractMethodError('ByteArrayBase, getBytesAvailable() not implemented ');
    };

    ByteArrayBase.prototype.toString = function () {
        return "[ByteArray] ( " + this._mode + " ) position=" + this.position + " length=" + this.length;
    };

    ByteArrayBase.prototype.compareEqual = function (other, count) {
        if (count == undefined || count > this.length - this.position)
            count = this.length - this.position;
        if (count > other.length - other.position)
            count = other.length - other.position;
        var co0 = count;
        var r = true;
        while (r && count >= 4) {
            count -= 4;
            if (this.readUnsignedInt() != other.readUnsignedInt())
                r = false;
        }
        while (r && count >= 1) {
            count--;
            if (this.readUnsignedByte() != other.readUnsignedByte())
                r = false;
        }
        var c0;
        this.position -= (c0 - count);
        other.position -= (c0 - count);
        return r;
    };

    ByteArrayBase.prototype.writeBase64String = function (s) {
        for (var i = 0; i < s.length; i++) {
            var v = s.charAt(i);
        }
    };

    ByteArrayBase.prototype.dumpToConsole = function () {
        var oldpos = this.position;
        this.position = 0;
        var nstep = 8;

        function asHexString(x, digits) {
            var lut = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f"];
            var sh = "";
            for (var d = 0; d < digits; d++) {
                sh = lut[(x >> (d << 2)) & 0xf] + sh;
            }
            return sh;
        }

        for (var i = 0; i < this.length; i += nstep) {
            var s = asHexString(i, 4) + ":";
            for (var j = 0; j < nstep && i + j < this.length; j++) {
                s += " " + asHexString(this.readUnsignedByte(), 2);
            }
            console.log(s);
        }
        this.position = oldpos;
    };

    ByteArrayBase.prototype.readBase64String = function (count) {
        if (count == undefined || count > this.length - this.position)
            count = this.length - this.position;
        if (!(count > 0))
            return "";

        return ByteArrayBase.internalGetBase64String(count, this.readUnsignedByte, this);
    };

    ByteArrayBase.internalGetBase64String = function (count, getUnsignedByteFunc, self) {
        var r = "";
        var b0, b1, b2, enc1, enc2, enc3, enc4;
        var base64Key = ByteArrayBase.Base64Key;
        while (count >= 3) {
            b0 = getUnsignedByteFunc.apply(self);
            b1 = getUnsignedByteFunc.apply(self);
            b2 = getUnsignedByteFunc.apply(self);
            enc1 = b0 >> 2;
            enc2 = ((b0 & 3) << 4) | (b1 >> 4);
            enc3 = ((b1 & 15) << 2) | (b2 >> 6);
            enc4 = b2 & 63;
            r += base64Key.charAt(enc1) + base64Key.charAt(enc2) + base64Key.charAt(enc3) + base64Key.charAt(enc4);
            count -= 3;
        }

        // pad
        if (count == 2) {
            b0 = getUnsignedByteFunc.apply(self);
            b1 = getUnsignedByteFunc.apply(self);
            enc1 = b0 >> 2;
            enc2 = ((b0 & 3) << 4) | (b1 >> 4);
            enc3 = ((b1 & 15) << 2);
            r += base64Key.charAt(enc1) + base64Key.charAt(enc2) + base64Key.charAt(enc3) + "=";
        } else if (count == 1) {
            b0 = getUnsignedByteFunc.apply(self);
            enc1 = b0 >> 2;
            enc2 = ((b0 & 3) << 4);
            r += base64Key.charAt(enc1) + base64Key.charAt(enc2) + "==";
        }
        return r;
    };
    ByteArrayBase.Base64Key = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    return ByteArrayBase;
})();

module.exports = ByteArrayBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzL0J5dGVBcnJheUJhc2UudHMiXSwibmFtZXMiOlsiQnl0ZUFycmF5QmFzZSIsIkJ5dGVBcnJheUJhc2UuY29uc3RydWN0b3IiLCJCeXRlQXJyYXlCYXNlLndyaXRlQnl0ZSIsIkJ5dGVBcnJheUJhc2UucmVhZEJ5dGUiLCJCeXRlQXJyYXlCYXNlLndyaXRlVW5zaWduZWRCeXRlIiwiQnl0ZUFycmF5QmFzZS5yZWFkVW5zaWduZWRCeXRlIiwiQnl0ZUFycmF5QmFzZS53cml0ZVVuc2lnbmVkU2hvcnQiLCJCeXRlQXJyYXlCYXNlLnJlYWRVbnNpZ25lZFNob3J0IiwiQnl0ZUFycmF5QmFzZS53cml0ZVVuc2lnbmVkSW50IiwiQnl0ZUFycmF5QmFzZS5yZWFkVW5zaWduZWRJbnQiLCJCeXRlQXJyYXlCYXNlLndyaXRlRmxvYXQiLCJCeXRlQXJyYXlCYXNlLnRvRmxvYXRCaXRzIiwiQnl0ZUFycmF5QmFzZS5yZWFkRmxvYXQiLCJCeXRlQXJyYXlCYXNlLmZyb21GbG9hdEJpdHMiLCJCeXRlQXJyYXlCYXNlLmdldEJ5dGVzQXZhaWxhYmxlIiwiQnl0ZUFycmF5QmFzZS50b1N0cmluZyIsIkJ5dGVBcnJheUJhc2UuY29tcGFyZUVxdWFsIiwiQnl0ZUFycmF5QmFzZS53cml0ZUJhc2U2NFN0cmluZyIsIkJ5dGVBcnJheUJhc2UuZHVtcFRvQ29uc29sZSIsIkJ5dGVBcnJheUJhc2UuZHVtcFRvQ29uc29sZS5hc0hleFN0cmluZyIsIkJ5dGVBcnJheUJhc2UucmVhZEJhc2U2NFN0cmluZyIsIkJ5dGVBcnJheUJhc2UuaW50ZXJuYWxHZXRCYXNlNjRTdHJpbmciXSwibWFwcGluZ3MiOiJBQUFBLCtFQUFvRjs7QUFFcEY7SUFRQ0E7UUFOQUMsS0FBT0EsUUFBUUEsR0FBVUEsQ0FBQ0EsQ0FBQ0E7UUFDM0JBLEtBQU9BLE1BQU1BLEdBQVVBLENBQUNBLENBQUNBO1FBQ3pCQSxLQUFPQSxLQUFLQSxHQUFVQSxFQUFFQSxDQUFDQTtJQU16QkEsQ0FBQ0E7SUFFREQs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QW1CQSxFQUFFQSxJQUFJQTtRQUVyRXFCLElBQUlBLENBQUNBLEdBQUdBLEVBQUVBO1FBQ1ZBLElBQUlBLEVBQUVBLEVBQUVBLEVBQUVBLEVBQUVBLEVBQUVBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBO1FBQ3RDQSxJQUFJQSxTQUFTQSxHQUFHQSxhQUFhQSxDQUFDQSxTQUFTQTtRQUN2Q0EsT0FBT0EsS0FBS0EsSUFBSUEsQ0FBQ0EsQ0FBRUE7WUFDbEJBLEVBQUVBLEdBQUdBLG1CQUFtQkEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0E7WUFDcENBLEVBQUVBLEdBQUdBLG1CQUFtQkEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0E7WUFDcENBLEVBQUVBLEdBQUdBLG1CQUFtQkEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsSUFBSUEsQ0FBQ0E7WUFDcENBLElBQUlBLEdBQUdBLEVBQUVBLElBQUlBLENBQUNBO1lBQ2RBLElBQUlBLEdBQUdBLENBQUNBLENBQUNBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBO1lBQ2xDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxFQUFFQSxHQUFHQSxFQUFFQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNuQ0EsSUFBSUEsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUE7WUFDZEEsQ0FBQ0EsSUFBSUEsU0FBU0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsU0FBU0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsU0FBU0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsU0FBU0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7WUFDdEdBLEtBQUtBLElBQUlBLENBQUNBO1NBQ1ZBOztRQUNEQSxNQUFNQTtRQUNOQSxJQUFJQSxLQUFLQSxJQUFJQSxDQUFDQSxDQUFFQTtZQUNmQSxFQUFFQSxHQUFHQSxtQkFBbUJBLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBO1lBQ3BDQSxFQUFFQSxHQUFHQSxtQkFBbUJBLENBQUNBLEtBQUtBLENBQUNBLElBQUlBLENBQUNBO1lBQ3BDQSxJQUFJQSxHQUFHQSxFQUFFQSxJQUFJQSxDQUFDQTtZQUNkQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNsQ0EsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsRUFBRUEsR0FBR0EsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDdkJBLENBQUNBLElBQUlBLFNBQVNBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLFNBQVNBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLFNBQVNBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLEdBQUdBO1NBQ25GQSxNQUFNQSxJQUFJQSxLQUFLQSxJQUFJQSxDQUFDQSxDQUFFQTtZQUN0QkEsRUFBRUEsR0FBR0EsbUJBQW1CQSxDQUFDQSxLQUFLQSxDQUFDQSxJQUFJQSxDQUFDQTtZQUNwQ0EsSUFBSUEsR0FBR0EsRUFBRUEsSUFBSUEsQ0FBQ0E7WUFDZEEsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDdEJBLENBQUNBLElBQUlBLFNBQVNBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLFNBQVNBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLElBQUlBO1NBQzNEQTtRQUNEQSxPQUFPQSxDQUFDQTtJQUNUQSxDQUFDQTtJQTNLRHJCLDBCQUEwQkEsa0VBQWtFQTtJQTRLN0ZBLHFCQUFDQTtBQUFEQSxDQUFDQSxJQUFBOztBQUVELDhCQUF1QixDQUFBIiwiZmlsZSI6InV0aWxzL0J5dGVBcnJheUJhc2UuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL3JvYmJhdGVtYW4vV2Vic3Rvcm1Qcm9qZWN0cy9hd2F5anMtY29yZS8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQWJzdHJhY3RNZXRob2RFcnJvclx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXJyb3JzL0Fic3RyYWN0TWV0aG9kRXJyb3JcIik7XG5cbmNsYXNzIEJ5dGVBcnJheUJhc2Vcbntcblx0cHVibGljIHBvc2l0aW9uOm51bWJlciA9IDA7XG5cdHB1YmxpYyBsZW5ndGg6bnVtYmVyID0gMDtcblx0cHVibGljIF9tb2RlOnN0cmluZyA9IFwiXCI7XG5cblx0cHVibGljIHN0YXRpYyBCYXNlNjRLZXkgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIjtcblxuXHRjb25zdHJ1Y3RvcigpXG5cdHtcblx0fVxuXG5cdHB1YmxpYyB3cml0ZUJ5dGUoYjpudW1iZXIpXG5cdHtcblx0XHR0aHJvdyBcIlZpcnR1YWwgbWV0aG9kXCI7XG5cdH1cblxuXHRwdWJsaWMgcmVhZEJ5dGUoKTpudW1iZXJcblx0e1xuXHRcdHRocm93IFwiVmlydHVhbCBtZXRob2RcIjtcblx0fVxuXG5cdHB1YmxpYyB3cml0ZVVuc2lnbmVkQnl0ZShiOm51bWJlcilcblx0e1xuXHRcdHRocm93IFwiVmlydHVhbCBtZXRob2RcIjtcblx0fVxuXG5cdHB1YmxpYyByZWFkVW5zaWduZWRCeXRlKCk6bnVtYmVyXG5cdHtcblx0XHR0aHJvdyBcIlZpcnR1YWwgbWV0aG9kXCI7XG5cdH1cblxuXHRwdWJsaWMgd3JpdGVVbnNpZ25lZFNob3J0KGI6bnVtYmVyKVxuXHR7XG5cdFx0dGhyb3cgXCJWaXJ0dWFsIG1ldGhvZFwiO1xuXHR9XG5cblx0cHVibGljIHJlYWRVbnNpZ25lZFNob3J0KCk6bnVtYmVyXG5cdHtcblx0XHR0aHJvdyBcIlZpcnR1YWwgbWV0aG9kXCI7XG5cdH1cblxuXHRwdWJsaWMgd3JpdGVVbnNpZ25lZEludChiOm51bWJlcilcblx0e1xuXHRcdHRocm93IFwiVmlydHVhbCBtZXRob2RcIjtcblx0fVxuXG5cdHB1YmxpYyByZWFkVW5zaWduZWRJbnQoKTpudW1iZXJcblx0e1xuXHRcdHRocm93IFwiVmlydHVhbCBtZXRob2RcIjtcblx0fVxuXG5cdHB1YmxpYyB3cml0ZUZsb2F0KGI6bnVtYmVyKVxuXHR7XG5cdFx0dGhyb3cgXCJWaXJ0dWFsIG1ldGhvZFwiO1xuXHR9XG5cblx0cHVibGljIHRvRmxvYXRCaXRzKHg6bnVtYmVyKVxuXHR7XG5cdFx0dGhyb3cgXCJWaXJ0dWFsIG1ldGhvZFwiO1xuXHR9XG5cblx0cHVibGljIHJlYWRGbG9hdChiOm51bWJlcilcblx0e1xuXHRcdHRocm93IFwiVmlydHVhbCBtZXRob2RcIjtcblx0fVxuXG5cdHB1YmxpYyBmcm9tRmxvYXRCaXRzKHg6bnVtYmVyKVxuXHR7XG5cdFx0dGhyb3cgXCJWaXJ0dWFsIG1ldGhvZFwiO1xuXHR9XG5cblx0cHVibGljIGdldEJ5dGVzQXZhaWxhYmxlKCk6bnVtYmVyXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcignQnl0ZUFycmF5QmFzZSwgZ2V0Qnl0ZXNBdmFpbGFibGUoKSBub3QgaW1wbGVtZW50ZWQgJyk7XG5cdH1cblxuXHRwdWJsaWMgdG9TdHJpbmcoKTpzdHJpbmdcblx0e1xuXHRcdHJldHVybiBcIltCeXRlQXJyYXldICggXCIgKyB0aGlzLl9tb2RlICsgXCIgKSBwb3NpdGlvbj1cIiArIHRoaXMucG9zaXRpb24gKyBcIiBsZW5ndGg9XCIgKyB0aGlzLmxlbmd0aDtcblx0fVxuXG5cdHB1YmxpYyBjb21wYXJlRXF1YWwob3RoZXIsIGNvdW50KVxuXHR7XG5cdFx0aWYgKGNvdW50ID09IHVuZGVmaW5lZCB8fCBjb3VudCA+IHRoaXMubGVuZ3RoIC0gdGhpcy5wb3NpdGlvbilcblx0XHRcdGNvdW50ID0gdGhpcy5sZW5ndGggLSB0aGlzLnBvc2l0aW9uO1xuXHRcdGlmIChjb3VudCA+IG90aGVyLmxlbmd0aCAtIG90aGVyLnBvc2l0aW9uKVxuXHRcdFx0Y291bnQgPSBvdGhlci5sZW5ndGggLSBvdGhlci5wb3NpdGlvbjtcblx0XHR2YXIgY28wID0gY291bnQ7XG5cdFx0dmFyIHIgPSB0cnVlO1xuXHRcdHdoaWxlIChyICYmIGNvdW50ID49IDQpIHtcblx0XHRcdGNvdW50IC09IDQ7XG5cdFx0XHRpZiAodGhpcy5yZWFkVW5zaWduZWRJbnQoKSAhPSBvdGhlci5yZWFkVW5zaWduZWRJbnQoKSkgciA9IGZhbHNlO1xuXHRcdH1cblx0XHR3aGlsZSAociAmJiBjb3VudCA+PSAxKSB7XG5cdFx0XHRjb3VudC0tO1xuXHRcdFx0aWYgKHRoaXMucmVhZFVuc2lnbmVkQnl0ZSgpICE9IG90aGVyLnJlYWRVbnNpZ25lZEJ5dGUoKSkgciA9IGZhbHNlO1xuXHRcdH1cblx0XHR2YXIgYzA7XG5cdFx0dGhpcy5wb3NpdGlvbiAtPSAoYzAgLSBjb3VudCk7XG5cdFx0b3RoZXIucG9zaXRpb24gLT0gKGMwIC0gY291bnQpO1xuXHRcdHJldHVybiByO1xuXHR9XG5cblx0cHVibGljIHdyaXRlQmFzZTY0U3RyaW5nKHM6c3RyaW5nKVxuXHR7XG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHYgPSBzLmNoYXJBdChpKTtcblx0XHR9XG5cdH1cblxuXHRwdWJsaWMgZHVtcFRvQ29uc29sZSgpXG5cdHtcblx0XHR2YXIgb2xkcG9zID0gdGhpcy5wb3NpdGlvbjtcblx0XHR0aGlzLnBvc2l0aW9uID0gMDtcblx0XHR2YXIgbnN0ZXA6bnVtYmVyID0gODtcblxuXHRcdGZ1bmN0aW9uIGFzSGV4U3RyaW5nKHgsIGRpZ2l0cylcblx0XHR7XG5cdFx0XHR2YXIgbHV0OkFycmF5PHN0cmluZz4gPSBbIFwiMFwiLCBcIjFcIiwgXCIyXCIsIFwiM1wiLCBcIjRcIiwgXCI1XCIsIFwiNlwiLCBcIjdcIiwgXCI4XCIsIFwiOVwiLCBcImFcIiwgXCJiXCIsIFwiY1wiLCBcImRcIiwgXCJlXCIsIFwiZlwiIF07XG5cdFx0XHR2YXIgc2g6c3RyaW5nID0gXCJcIjtcblx0XHRcdGZvciAodmFyIGQ6bnVtYmVyID0gMDsgZCA8IGRpZ2l0czsgZCsrKSB7XG5cdFx0XHRcdHNoID0gbHV0Wyh4ID4+IChkIDw8IDIpKSAmIDB4Zl0gKyBzaDtcblx0XHRcdH1cblx0XHRcdHJldHVybiBzaDtcblx0XHR9XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpICs9IG5zdGVwKSB7XG5cdFx0XHR2YXIgczpzdHJpbmcgPSBhc0hleFN0cmluZyhpLCA0KSArIFwiOlwiO1xuXHRcdFx0Zm9yICh2YXIgajpudW1iZXIgPSAwOyBqIDwgbnN0ZXAgJiYgaSArIGogPCB0aGlzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdHMgKz0gXCIgXCIgKyBhc0hleFN0cmluZyh0aGlzLnJlYWRVbnNpZ25lZEJ5dGUoKSwgMik7XG5cdFx0XHR9XG5cdFx0XHRjb25zb2xlLmxvZyhzKTtcblx0XHR9XG5cdFx0dGhpcy5wb3NpdGlvbiA9IG9sZHBvcztcblx0fVxuXG5cdHB1YmxpYyByZWFkQmFzZTY0U3RyaW5nKGNvdW50Om51bWJlcilcblx0e1xuXHRcdGlmIChjb3VudCA9PSB1bmRlZmluZWQgfHwgY291bnQgPiB0aGlzLmxlbmd0aCAtIHRoaXMucG9zaXRpb24pXG5cdFx0XHRjb3VudCA9IHRoaXMubGVuZ3RoIC0gdGhpcy5wb3NpdGlvbjtcblx0XHRpZiAoIShjb3VudCA+IDApKSByZXR1cm4gXCJcIjtcblxuXHRcdHJldHVybiBCeXRlQXJyYXlCYXNlLmludGVybmFsR2V0QmFzZTY0U3RyaW5nKGNvdW50LCB0aGlzLnJlYWRVbnNpZ25lZEJ5dGUsIHRoaXMpO1xuXHR9XG5cblx0cHVibGljIHN0YXRpYyBpbnRlcm5hbEdldEJhc2U2NFN0cmluZyhjb3VudCwgZ2V0VW5zaWduZWRCeXRlRnVuYywgc2VsZilcblx0eyAvLyByZXR1cm4gYmFzZTY0IHN0cmluZyBvZiB0aGUgbmV4dCBjb3VudCBieXRlc1xuXHRcdHZhciByID0gXCJcIjtcblx0XHR2YXIgYjAsIGIxLCBiMiwgZW5jMSwgZW5jMiwgZW5jMywgZW5jNDtcblx0XHR2YXIgYmFzZTY0S2V5ID0gQnl0ZUFycmF5QmFzZS5CYXNlNjRLZXk7XG5cdFx0d2hpbGUgKGNvdW50ID49IDMpIHtcblx0XHRcdGIwID0gZ2V0VW5zaWduZWRCeXRlRnVuYy5hcHBseShzZWxmKTtcblx0XHRcdGIxID0gZ2V0VW5zaWduZWRCeXRlRnVuYy5hcHBseShzZWxmKTtcblx0XHRcdGIyID0gZ2V0VW5zaWduZWRCeXRlRnVuYy5hcHBseShzZWxmKTtcblx0XHRcdGVuYzEgPSBiMCA+PiAyO1xuXHRcdFx0ZW5jMiA9ICgoYjAgJiAzKSA8PCA0KSB8IChiMSA+PiA0KTtcblx0XHRcdGVuYzMgPSAoKGIxICYgMTUpIDw8IDIpIHwgKGIyID4+IDYpO1xuXHRcdFx0ZW5jNCA9IGIyICYgNjM7XG5cdFx0XHRyICs9IGJhc2U2NEtleS5jaGFyQXQoZW5jMSkgKyBiYXNlNjRLZXkuY2hhckF0KGVuYzIpICsgYmFzZTY0S2V5LmNoYXJBdChlbmMzKSArIGJhc2U2NEtleS5jaGFyQXQoZW5jNCk7XG5cdFx0XHRjb3VudCAtPSAzO1xuXHRcdH1cblx0XHQvLyBwYWRcblx0XHRpZiAoY291bnQgPT0gMikge1xuXHRcdFx0YjAgPSBnZXRVbnNpZ25lZEJ5dGVGdW5jLmFwcGx5KHNlbGYpO1xuXHRcdFx0YjEgPSBnZXRVbnNpZ25lZEJ5dGVGdW5jLmFwcGx5KHNlbGYpO1xuXHRcdFx0ZW5jMSA9IGIwID4+IDI7XG5cdFx0XHRlbmMyID0gKChiMCAmIDMpIDw8IDQpIHwgKGIxID4+IDQpO1xuXHRcdFx0ZW5jMyA9ICgoYjEgJiAxNSkgPDwgMik7XG5cdFx0XHRyICs9IGJhc2U2NEtleS5jaGFyQXQoZW5jMSkgKyBiYXNlNjRLZXkuY2hhckF0KGVuYzIpICsgYmFzZTY0S2V5LmNoYXJBdChlbmMzKSArIFwiPVwiO1xuXHRcdH0gZWxzZSBpZiAoY291bnQgPT0gMSkge1xuXHRcdFx0YjAgPSBnZXRVbnNpZ25lZEJ5dGVGdW5jLmFwcGx5KHNlbGYpO1xuXHRcdFx0ZW5jMSA9IGIwID4+IDI7XG5cdFx0XHRlbmMyID0gKChiMCAmIDMpIDw8IDQpO1xuXHRcdFx0ciArPSBiYXNlNjRLZXkuY2hhckF0KGVuYzEpICsgYmFzZTY0S2V5LmNoYXJBdChlbmMyKSArIFwiPT1cIjtcblx0XHR9XG5cdFx0cmV0dXJuIHI7XG5cdH1cbn1cblxuZXhwb3J0ID0gQnl0ZUFycmF5QmFzZTsiXX0=