var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var PrimitivePrefabBase = require("awayjs-core/lib/prefabs/PrimitivePrefabBase");

/**
* A UV Sphere primitive mesh.
*/
var PrimitiveSpherePrefab = (function (_super) {
    __extends(PrimitiveSpherePrefab, _super);
    /**
    * Creates a new Sphere object.
    *
    * @param radius The radius of the sphere.
    * @param segmentsW Defines the number of horizontal segments that make up the sphere.
    * @param segmentsH Defines the number of vertical segments that make up the sphere.
    * @param yUp Defines whether the sphere poles should lay on the Y-axis (true) or on the Z-axis (false).
    */
    function PrimitiveSpherePrefab(radius, segmentsW, segmentsH, yUp) {
        if (typeof radius === "undefined") { radius = 50; }
        if (typeof segmentsW === "undefined") { segmentsW = 16; }
        if (typeof segmentsH === "undefined") { segmentsH = 12; }
        if (typeof yUp === "undefined") { yUp = true; }
        _super.call(this);

        this._radius = radius;
        this._segmentsW = segmentsW;
        this._segmentsH = segmentsH;
        this._yUp = yUp;
    }
    Object.defineProperty(PrimitiveSpherePrefab.prototype, "radius", {
        /**
        * The radius of the sphere.
        */
        get: function () {
            return this._radius;
        },
        set: function (value) {
            this._radius = value;

            this._pInvalidateGeometry();
        },
        enumerable: true,
        configurable: true
    });


    Object.defineProperty(PrimitiveSpherePrefab.prototype, "segmentsW", {
        /**
        * Defines the number of horizontal segments that make up the sphere. Defaults to 16.
        */
        get: function () {
            return this._segmentsW;
        },
        set: function (value) {
            this._segmentsW = value;

            this._pInvalidateGeometry();
            this._pInvalidateUVs();
        },
        enumerable: true,
        configurable: true
    });


    Object.defineProperty(PrimitiveSpherePrefab.prototype, "segmentsH", {
        /**
        * Defines the number of vertical segments that make up the sphere. Defaults to 12.
        */
        get: function () {
            return this._segmentsH;
        },
        set: function (value) {
            this._segmentsH = value;

            this._pInvalidateGeometry();
            this._pInvalidateUVs();
        },
        enumerable: true,
        configurable: true
    });


    Object.defineProperty(PrimitiveSpherePrefab.prototype, "yUp", {
        /**
        * Defines whether the sphere poles should lay on the Y-axis (true) or on the Z-axis (false).
        */
        get: function () {
            return this._yUp;
        },
        set: function (value) {
            this._yUp = value;

            this._pInvalidateGeometry();
        },
        enumerable: true,
        configurable: true
    });


    /**
    * @inheritDoc
    */
    PrimitiveSpherePrefab.prototype._pBuildGeometry = function (target, geometryType) {
        var indices;
        var positions;
        var normals;
        var tangents;

        var i;
        var j;
        var vidx, fidx;

        var comp1;
        var comp2;
        var numVertices;

        if (geometryType == "triangleSubGeometry") {
            var triangleGeometry = target;

            numVertices = (this._segmentsH + 1) * (this._segmentsW + 1);

            if (numVertices == triangleGeometry.numVertices && triangleGeometry.indices != null) {
                indices = triangleGeometry.indices;
                positions = triangleGeometry.positions;
                normals = triangleGeometry.vertexNormals;
                tangents = triangleGeometry.vertexTangents;
            } else {
                indices = new Array((this._segmentsH - 1) * this._segmentsW * 6);
                positions = new Array(numVertices * 3);
                normals = new Array(numVertices * 3);
                tangents = new Array(numVertices * 3);

                this._pInvalidateUVs();
            }

            vidx = 0;
            fidx = 0;

            var startIndex;
            var t1;
            var t2;

            for (j = 0; j <= this._segmentsH; ++j) {
                startIndex = vidx;

                var horangle = Math.PI * j / this._segmentsH;
                var z = -this._radius * Math.cos(horangle);
                var ringradius = this._radius * Math.sin(horangle);

                for (i = 0; i <= this._segmentsW; ++i) {
                    var verangle = 2 * Math.PI * i / this._segmentsW;
                    var x = ringradius * Math.cos(verangle);
                    var y = ringradius * Math.sin(verangle);
                    var normLen = 1 / Math.sqrt(x * x + y * y + z * z);
                    var tanLen = Math.sqrt(y * y + x * x);

                    if (this._yUp) {
                        t1 = 0;
                        t2 = tanLen > .007 ? x / tanLen : 0;
                        comp1 = -z;
                        comp2 = y;
                    } else {
                        t1 = tanLen > .007 ? x / tanLen : 0;
                        t2 = 0;
                        comp1 = y;
                        comp2 = z;
                    }

                    if (i == this._segmentsW) {
                        positions[vidx] = positions[startIndex];
                        positions[vidx + 1] = positions[startIndex + 1];
                        positions[vidx + 2] = positions[startIndex + 2];
                        normals[vidx] = normals[startIndex] + (x * normLen) * .5;
                        normals[vidx + 1] = normals[startIndex + 1] + (comp1 * normLen) * .5;
                        normals[vidx + 2] = normals[startIndex + 2] + (comp2 * normLen) * .5;
                        tangents[vidx] = tanLen > .007 ? -y / tanLen : 1;
                        tangents[vidx + 1] = t1;
                        tangents[vidx + 2] = t2;
                    } else {
                        positions[vidx] = x;
                        positions[vidx + 1] = comp1;
                        positions[vidx + 2] = comp2;
                        normals[vidx] = x * normLen;
                        normals[vidx + 1] = comp1 * normLen;
                        normals[vidx + 2] = comp2 * normLen;
                        tangents[vidx] = tanLen > .007 ? -y / tanLen : 1;
                        tangents[vidx + 1] = t1;
                        tangents[vidx + 2] = t2;
                    }

                    if (i > 0 && j > 0) {
                        var a = (this._segmentsW + 1) * j + i;
                        var b = (this._segmentsW + 1) * j + i - 1;
                        var c = (this._segmentsW + 1) * (j - 1) + i - 1;
                        var d = (this._segmentsW + 1) * (j - 1) + i;

                        if (j == this._segmentsH) {
                            positions[vidx] = positions[startIndex];
                            positions[vidx + 1] = positions[startIndex + 1];
                            positions[vidx + 2] = positions[startIndex + 2];

                            indices[fidx++] = a;
                            indices[fidx++] = c;
                            indices[fidx++] = d;
                        } else if (j == 1) {
                            indices[fidx++] = a;
                            indices[fidx++] = b;
                            indices[fidx++] = c;
                        } else {
                            indices[fidx++] = a;
                            indices[fidx++] = b;
                            indices[fidx++] = c;
                            indices[fidx++] = a;
                            indices[fidx++] = c;
                            indices[fidx++] = d;
                        }
                    }

                    vidx += 3;
                }
            }

            triangleGeometry.updateIndices(indices);

            triangleGeometry.updatePositions(positions);
            triangleGeometry.updateVertexNormals(normals);
            triangleGeometry.updateVertexTangents(tangents);
        } else if (geometryType == "lineSubGeometry") {
            var lineGeometry = target;

            var numSegments = (this._segmentsH - 1) * this._segmentsW * 2;
            var startPositions;
            var endPositions;
            var thickness;

            if (lineGeometry.indices != null && numSegments == lineGeometry.numSegments) {
                startPositions = lineGeometry.startPositions;
                endPositions = lineGeometry.endPositions;
                thickness = lineGeometry.thickness;
            } else {
                startPositions = new Array(numSegments * 3);
                endPositions = new Array(numSegments * 3);
                thickness = new Array(numSegments);
            }

            vidx = 0;

            fidx = 0;

            for (j = 0; j <= this._segmentsH; ++j) {
                var horangle = Math.PI * j / this._segmentsH;
                var z = -this._radius * Math.cos(horangle);
                var ringradius = this._radius * Math.sin(horangle);

                for (i = 0; i <= this._segmentsW; ++i) {
                    var verangle = 2 * Math.PI * i / this._segmentsW;
                    var x = ringradius * Math.cos(verangle);
                    var y = ringradius * Math.sin(verangle);

                    if (this._yUp) {
                        comp1 = -z;
                        comp2 = y;
                    } else {
                        comp1 = y;
                        comp2 = z;
                    }

                    if (i > 0 && j > 0) {
                        //horizonal lines
                        if (j < this._segmentsH) {
                            endPositions[vidx] = x;
                            endPositions[vidx + 1] = comp1;
                            endPositions[vidx + 2] = comp2;

                            thickness[fidx++] = 1;

                            vidx += 3;
                        }

                        //vertical lines
                        startPositions[vidx] = endPositions[vidx - this._segmentsW * 6];
                        startPositions[vidx + 1] = endPositions[vidx + 1 - this._segmentsW * 6];
                        startPositions[vidx + 2] = endPositions[vidx + 2 - this._segmentsW * 6];

                        endPositions[vidx] = x;
                        endPositions[vidx + 1] = comp1;
                        endPositions[vidx + 2] = comp2;

                        thickness[fidx++] = 1;

                        vidx += 3;
                    }

                    if (i < this._segmentsW && j > 0 && j < this._segmentsH) {
                        startPositions[vidx] = x;
                        startPositions[vidx + 1] = comp1;
                        startPositions[vidx + 2] = comp2;
                    }
                }
            }

            // build real data from raw data
            lineGeometry.updatePositions(startPositions, endPositions);
            lineGeometry.updateThickness(thickness);
        }
    };

    /**
    * @inheritDoc
    */
    PrimitiveSpherePrefab.prototype._pBuildUVs = function (target, geometryType) {
        var i, j;
        var numVertices = (this._segmentsH + 1) * (this._segmentsW + 1);
        var uvs;

        if (geometryType == "triangleSubGeometry") {
            numVertices = (this._segmentsH + 1) * (this._segmentsW + 1);

            var triangleGeometry = target;

            if (numVertices == triangleGeometry.numVertices && triangleGeometry.uvs != null) {
                uvs = triangleGeometry.uvs;
            } else {
                uvs = new Array(numVertices * 2);
            }

            var index = 0;
            for (j = 0; j <= this._segmentsH; ++j) {
                for (i = 0; i <= this._segmentsW; ++i) {
                    uvs[index++] = (i / this._segmentsW) * triangleGeometry.scaleU;
                    uvs[index++] = (j / this._segmentsH) * triangleGeometry.scaleV;
                }
            }

            triangleGeometry.updateUVs(uvs);
        } else if (geometryType == "lineSubGeometry") {
            //nothing to do here
        }
    };
    return PrimitiveSpherePrefab;
})(PrimitivePrefabBase);

module.exports = PrimitiveSpherePrefab;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByZWZhYnMvUHJpbWl0aXZlU3BoZXJlUHJlZmFiLnRzIl0sIm5hbWVzIjpbIlByaW1pdGl2ZVNwaGVyZVByZWZhYiIsIlByaW1pdGl2ZVNwaGVyZVByZWZhYi5jb25zdHJ1Y3RvciIsIlByaW1pdGl2ZVNwaGVyZVByZWZhYi5fcEJ1aWxkR2VvbWV0cnkiLCJQcmltaXRpdmVTcGhlcmVQcmVmYWIuX3BCdWlsZFVWcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsZ0ZBSXFGOztBQUVyRjs7RUFFRztBQUNIO0lBQW9DQSx3Q0FBbUJBO0lBNkV0REE7Ozs7Ozs7TUFER0E7SUFDSEEsK0JBQVlBLE1BQWtCQSxFQUFFQSxTQUFxQkEsRUFBRUEsU0FBcUJBLEVBQUVBLEdBQWtCQTtRQUFwRkMscUNBQUFBLE1BQU1BLEdBQVVBLEVBQUVBO0FBQUFBLFFBQUVBLHdDQUFBQSxTQUFTQSxHQUFVQSxFQUFFQTtBQUFBQSxRQUFFQSx3Q0FBQUEsU0FBU0EsR0FBVUEsRUFBRUE7QUFBQUEsUUFBRUEsa0NBQUFBLEdBQUdBLEdBQVdBLElBQUlBO0FBQUFBLFFBRS9GQSxXQUFNQSxLQUFBQSxDQUFDQTs7UUFFUEEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsTUFBTUE7UUFDckJBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLFNBQVNBO1FBQzNCQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxTQUFTQTtRQUMzQkEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsR0FBR0E7SUFDaEJBLENBQUNBO0lBM0VERDtRQUFBQTs7VUFER0E7YUFDSEE7WUFFQ0EsT0FBT0EsSUFBSUEsQ0FBQ0EsT0FBT0E7UUFDcEJBLENBQUNBO1FBRURBLEtBQUFBLFVBQWtCQSxLQUFZQTtZQUU3QkEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsS0FBS0E7O1lBRXBCQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBO1FBQzVCQSxDQUFDQTs7OztBQVBBQTs7SUFZREE7UUFBQUE7O1VBREdBO2FBQ0hBO1lBRUNBLE9BQU9BLElBQUlBLENBQUNBLFVBQVVBO1FBQ3ZCQSxDQUFDQTtRQUVEQSxLQUFBQSxVQUFxQkEsS0FBWUE7WUFFaENBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLEtBQUtBOztZQUV2QkEsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQTtZQUMzQkEsSUFBSUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsQ0FBQ0E7UUFDdkJBLENBQUNBOzs7O0FBUkFBOztJQWFEQTtRQUFBQTs7VUFER0E7YUFDSEE7WUFFQ0EsT0FBT0EsSUFBSUEsQ0FBQ0EsVUFBVUE7UUFDdkJBLENBQUNBO1FBRURBLEtBQUFBLFVBQXFCQSxLQUFZQTtZQUVoQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsS0FBS0E7O1lBRXZCQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBO1lBQzNCQSxJQUFJQSxDQUFDQSxlQUFlQSxDQUFDQSxDQUFDQTtRQUN2QkEsQ0FBQ0E7Ozs7QUFSQUE7O0lBYURBO1FBQUFBOztVQURHQTthQUNIQTtZQUVDQSxPQUFPQSxJQUFJQSxDQUFDQSxJQUFJQTtRQUNqQkEsQ0FBQ0E7UUFFREEsS0FBQUEsVUFBZUEsS0FBYUE7WUFFM0JBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLEtBQUtBOztZQUVqQkEsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQTtRQUM1QkEsQ0FBQ0E7Ozs7QUFQQUE7O0lBOEJEQTs7TUFER0E7c0RBQ0hBLFVBQXVCQSxNQUFzQkEsRUFBRUEsWUFBbUJBO1FBRWpFRSxJQUFJQSxPQUFPQTtRQUNYQSxJQUFJQSxTQUFTQTtRQUNiQSxJQUFJQSxPQUFPQTtRQUNYQSxJQUFJQSxRQUFRQTs7UUFFWkEsSUFBSUEsQ0FBQ0E7UUFDTEEsSUFBSUEsQ0FBQ0E7UUFDTEEsSUFBSUEsSUFBSUEsRUFBU0EsSUFBSUE7O1FBRXJCQSxJQUFJQSxLQUFLQTtRQUNUQSxJQUFJQSxLQUFLQTtRQUNUQSxJQUFJQSxXQUFXQTs7UUFHZkEsSUFBSUEsWUFBWUEsSUFBSUEscUJBQXFCQSxDQUFFQTtZQUUxQ0EsSUFBSUEsZ0JBQWdCQSxHQUE2Q0EsTUFBTUE7O1lBRXZFQSxXQUFXQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxDQUFDQSxDQUFDQTs7WUFFekRBLElBQUlBLFdBQVdBLElBQUlBLGdCQUFnQkEsQ0FBQ0EsV0FBV0EsSUFBSUEsZ0JBQWdCQSxDQUFDQSxPQUFPQSxJQUFJQSxJQUFJQSxDQUFFQTtnQkFDcEZBLE9BQU9BLEdBQUdBLGdCQUFnQkEsQ0FBQ0EsT0FBT0E7Z0JBQ2xDQSxTQUFTQSxHQUFHQSxnQkFBZ0JBLENBQUNBLFNBQVNBO2dCQUN0Q0EsT0FBT0EsR0FBR0EsZ0JBQWdCQSxDQUFDQSxhQUFhQTtnQkFDeENBLFFBQVFBLEdBQUdBLGdCQUFnQkEsQ0FBQ0EsY0FBY0E7YUFDMUNBLEtBQU1BO2dCQUNOQSxPQUFPQSxHQUFHQSxJQUFJQSxLQUFLQSxDQUFTQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFDQSxDQUFDQSxDQUFDQTtnQkFDcEVBLFNBQVNBLEdBQUdBLElBQUlBLEtBQUtBLENBQVNBLFdBQVdBLEdBQUNBLENBQUNBLENBQUNBO2dCQUM1Q0EsT0FBT0EsR0FBR0EsSUFBSUEsS0FBS0EsQ0FBU0EsV0FBV0EsR0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzFDQSxRQUFRQSxHQUFHQSxJQUFJQSxLQUFLQSxDQUFTQSxXQUFXQSxHQUFDQSxDQUFDQSxDQUFDQTs7Z0JBRTNDQSxJQUFJQSxDQUFDQSxlQUFlQSxDQUFDQSxDQUFDQTthQUN0QkE7O1lBRURBLElBQUlBLEdBQUdBLENBQUNBO1lBQ1JBLElBQUlBLEdBQUdBLENBQUNBOztZQUVSQSxJQUFJQSxVQUFVQTtZQUNkQSxJQUFJQSxFQUFFQTtZQUNOQSxJQUFJQSxFQUFFQTs7WUFFTkEsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsVUFBVUEsRUFBRUEsRUFBRUEsQ0FBQ0EsQ0FBRUE7Z0JBRXRDQSxVQUFVQSxHQUFHQSxJQUFJQTs7Z0JBRWpCQSxJQUFJQSxRQUFRQSxHQUFVQSxJQUFJQSxDQUFDQSxFQUFFQSxHQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxVQUFVQTtnQkFDL0NBLElBQUlBLENBQUNBLEdBQVVBLENBQUNBLElBQUlBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLFFBQVFBLENBQUNBO2dCQUMvQ0EsSUFBSUEsVUFBVUEsR0FBVUEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsUUFBUUEsQ0FBQ0E7O2dCQUV2REEsS0FBS0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsVUFBVUEsRUFBRUEsRUFBRUEsQ0FBQ0EsQ0FBRUE7b0JBQ3RDQSxJQUFJQSxRQUFRQSxHQUFVQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxHQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxVQUFVQTtvQkFDakRBLElBQUlBLENBQUNBLEdBQVVBLFVBQVVBLEdBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLFFBQVFBLENBQUNBO29CQUM1Q0EsSUFBSUEsQ0FBQ0EsR0FBVUEsVUFBVUEsR0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsUUFBUUEsQ0FBQ0E7b0JBQzVDQSxJQUFJQSxPQUFPQSxHQUFVQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFDQSxDQUFDQSxDQUFDQTtvQkFDakRBLElBQUlBLE1BQU1BLEdBQVVBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBOztvQkFFeENBLElBQUlBLElBQUlBLENBQUNBLElBQUlBLENBQUVBO3dCQUVkQSxFQUFFQSxHQUFHQSxDQUFDQTt3QkFDTkEsRUFBRUEsR0FBR0EsTUFBTUEsR0FBR0EsSUFBSUEsR0FBRUEsQ0FBQ0EsR0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0E7d0JBQ2hDQSxLQUFLQSxHQUFHQSxDQUFDQSxDQUFDQTt3QkFDVkEsS0FBS0EsR0FBR0EsQ0FBQ0E7cUJBRVRBLEtBQU1BO3dCQUNOQSxFQUFFQSxHQUFHQSxNQUFNQSxHQUFHQSxJQUFJQSxHQUFFQSxDQUFDQSxHQUFDQSxNQUFNQSxHQUFHQSxDQUFDQTt3QkFDaENBLEVBQUVBLEdBQUdBLENBQUNBO3dCQUNOQSxLQUFLQSxHQUFHQSxDQUFDQTt3QkFDVEEsS0FBS0EsR0FBR0EsQ0FBQ0E7cUJBQ1RBOztvQkFFREEsSUFBSUEsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBRUE7d0JBQ3pCQSxTQUFTQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxTQUFTQSxDQUFDQSxVQUFVQSxDQUFDQTt3QkFDdkNBLFNBQVNBLENBQUNBLElBQUlBLEdBQUNBLENBQUNBLENBQUNBLEdBQUdBLFNBQVNBLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBO3dCQUM3Q0EsU0FBU0EsQ0FBQ0EsSUFBSUEsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsU0FBU0EsQ0FBQ0EsVUFBVUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7d0JBQzdDQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxPQUFPQSxDQUFDQSxVQUFVQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFDQSxPQUFPQSxDQUFDQSxHQUFDQSxFQUFFQTt3QkFDcERBLE9BQU9BLENBQUNBLElBQUlBLEdBQUNBLENBQUNBLENBQUNBLEdBQUdBLE9BQU9BLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUVBLEtBQUtBLEdBQUNBLE9BQU9BLENBQUNBLEdBQUNBLEVBQUVBO3dCQUMvREEsT0FBT0EsQ0FBQ0EsSUFBSUEsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsT0FBT0EsQ0FBQ0EsVUFBVUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsS0FBS0EsR0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBQ0EsRUFBRUE7d0JBQzlEQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxNQUFNQSxHQUFHQSxJQUFJQSxHQUFFQSxDQUFDQSxDQUFDQSxHQUFDQSxNQUFNQSxHQUFHQSxDQUFDQTt3QkFDN0NBLFFBQVFBLENBQUNBLElBQUlBLEdBQUNBLENBQUNBLENBQUNBLEdBQUdBLEVBQUVBO3dCQUNyQkEsUUFBUUEsQ0FBQ0EsSUFBSUEsR0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsRUFBRUE7cUJBRXJCQSxLQUFNQTt3QkFFTkEsU0FBU0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0E7d0JBQ25CQSxTQUFTQSxDQUFDQSxJQUFJQSxHQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxLQUFLQTt3QkFDekJBLFNBQVNBLENBQUNBLElBQUlBLEdBQUNBLENBQUNBLENBQUNBLEdBQUdBLEtBQUtBO3dCQUN6QkEsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBQ0EsT0FBT0E7d0JBQ3pCQSxPQUFPQSxDQUFDQSxJQUFJQSxHQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxLQUFLQSxHQUFDQSxPQUFPQTt3QkFDL0JBLE9BQU9BLENBQUNBLElBQUlBLEdBQUNBLENBQUNBLENBQUNBLEdBQUdBLEtBQUtBLEdBQUNBLE9BQU9BO3dCQUMvQkEsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsTUFBTUEsR0FBR0EsSUFBSUEsR0FBRUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0E7d0JBQzdDQSxRQUFRQSxDQUFDQSxJQUFJQSxHQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxFQUFFQTt3QkFDckJBLFFBQVFBLENBQUNBLElBQUlBLEdBQUNBLENBQUNBLENBQUNBLEdBQUdBLEVBQUVBO3FCQUNyQkE7O29CQUVEQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFFQTt3QkFFbkJBLElBQUlBLENBQUNBLEdBQVVBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLENBQUNBO3dCQUMxQ0EsSUFBSUEsQ0FBQ0EsR0FBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBR0EsQ0FBQ0E7d0JBQzlDQSxJQUFJQSxDQUFDQSxHQUFVQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxDQUFDQTt3QkFDcERBLElBQUlBLENBQUNBLEdBQVVBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBOzt3QkFFaERBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLFVBQVVBLENBQUVBOzRCQUV6QkEsU0FBU0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsU0FBU0EsQ0FBQ0EsVUFBVUEsQ0FBQ0E7NEJBQ3ZDQSxTQUFTQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxTQUFTQSxDQUFDQSxVQUFVQSxHQUFHQSxDQUFDQSxDQUFDQTs0QkFDL0NBLFNBQVNBLENBQUNBLElBQUlBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLFNBQVNBLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBOzs0QkFFL0NBLE9BQU9BLENBQUNBLElBQUlBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBOzRCQUNuQkEsT0FBT0EsQ0FBQ0EsSUFBSUEsRUFBRUEs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RURBLGdDQUFnQ0E7WUFDaENBLFlBQVlBLENBQUNBLGVBQWVBLENBQUNBLGNBQWNBLEVBQUVBLFlBQVlBLENBQUNBO1lBQzFEQSxZQUFZQSxDQUFDQSxlQUFlQSxDQUFDQSxTQUFTQSxDQUFDQTtTQUN2Q0E7SUFDRkEsQ0FBQ0E7O0lBS0RGOztNQURHQTtpREFDSEEsVUFBa0JBLE1BQXNCQSxFQUFFQSxZQUFtQkE7UUFFNURHLElBQUlBLENBQUNBLEVBQVNBLENBQUNBO1FBQ2ZBLElBQUlBLFdBQVdBLEdBQVVBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLENBQUNBLENBQUNBO1FBQ3BFQSxJQUFJQSxHQUFHQTs7UUFHUEEsSUFBSUEsWUFBWUEsSUFBSUEscUJBQXFCQSxDQUFFQTtZQUUxQ0EsV0FBV0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7O1lBRXpEQSxJQUFJQSxnQkFBZ0JBLEdBQTZDQSxNQUFNQTs7WUFFdkVBLElBQUlBLFdBQVdBLElBQUlBLGdCQUFnQkEsQ0FBQ0EsV0FBV0EsSUFBSUEsZ0JBQWdCQSxDQUFDQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFFQTtnQkFDaEZBLEdBQUdBLEdBQUdBLGdCQUFnQkEsQ0FBQ0EsR0FBR0E7YUFDMUJBLEtBQU1BO2dCQUNOQSxHQUFHQSxHQUFHQSxJQUFJQSxLQUFLQSxDQUFTQSxXQUFXQSxHQUFDQSxDQUFDQSxDQUFDQTthQUN0Q0E7O1lBRURBLElBQUlBLEtBQUtBLEdBQVVBLENBQUNBO1lBQ3BCQSxLQUFLQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxVQUFVQSxFQUFFQSxFQUFFQSxDQUFDQSxDQUFFQTtnQkFDdENBLEtBQUtBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLFVBQVVBLEVBQUVBLEVBQUVBLENBQUNBLENBQUVBO29CQUN0Q0EsR0FBR0EsQ0FBQ0EsS0FBS0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBRUEsQ0FBQ0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBRUEsR0FBQ0EsZ0JBQWdCQSxDQUFDQSxNQUFNQTtvQkFDNURBLEdBQUdBLENBQUNBLEtBQUtBLEVBQUVBLENBQUNBLEdBQUdBLENBQUVBLENBQUNBLEdBQUNBLElBQUlBLENBQUNBLFVBQVVBLENBQUVBLEdBQUNBLGdCQUFnQkEsQ0FBQ0EsTUFBTUE7aUJBQzVEQTthQUNEQTs7WUFFREEsZ0JBQWdCQSxDQUFDQSxTQUFTQSxDQUFDQSxHQUFHQSxDQUFDQTtTQUUvQkEsTUFBTUEsSUFBSUEsWUFBWUEsSUFBSUEsaUJBQWlCQSxDQUFFQTtZQUM3Q0Esb0JBQW9CQTtTQUNwQkE7SUFDRkEsQ0FBQ0E7SUFDRkgsNkJBQUNBO0FBQURBLENBQUNBLEVBNVZtQyxtQkFBbUIsRUE0VnREOztBQUVELHNDQUErQixDQUFBIiwiZmlsZSI6InByZWZhYnMvUHJpbWl0aXZlU3BoZXJlUHJlZmFiLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9yb2JiYXRlbWFuL1dlYnN0b3JtUHJvamVjdHMvYXdheWpzLWNvcmUvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IExpbmVTdWJHZW9tZXRyeVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9jb3JlL2Jhc2UvTGluZVN1Ykdlb21ldHJ5XCIpO1xuaW1wb3J0IFN1Ykdlb21ldHJ5QmFzZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9jb3JlL2Jhc2UvU3ViR2VvbWV0cnlCYXNlXCIpO1xuaW1wb3J0IFRyaWFuZ2xlU3ViR2VvbWV0cnlcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2NvcmUvYmFzZS9UcmlhbmdsZVN1Ykdlb21ldHJ5XCIpO1xuaW1wb3J0IElBc3NldFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvY29yZS9saWJyYXJ5L0lBc3NldFwiKTtcbmltcG9ydCBQcmltaXRpdmVQcmVmYWJCYXNlXHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9wcmVmYWJzL1ByaW1pdGl2ZVByZWZhYkJhc2VcIik7XG5cbi8qKlxuICogQSBVViBTcGhlcmUgcHJpbWl0aXZlIG1lc2guXG4gKi9cbmNsYXNzIFByaW1pdGl2ZVNwaGVyZVByZWZhYiBleHRlbmRzIFByaW1pdGl2ZVByZWZhYkJhc2UgaW1wbGVtZW50cyBJQXNzZXRcbntcblx0cHJpdmF0ZSBfcmFkaXVzOm51bWJlcjtcblx0cHJpdmF0ZSBfc2VnbWVudHNXOm51bWJlcjtcblx0cHJpdmF0ZSBfc2VnbWVudHNIOm51bWJlcjtcblx0cHJpdmF0ZSBfeVVwOmJvb2xlYW47XG5cblx0LyoqXG5cdCAqIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS5cblx0ICovXG5cdHB1YmxpYyBnZXQgcmFkaXVzKCk6bnVtYmVyXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fcmFkaXVzO1xuXHR9XG5cblx0cHVibGljIHNldCByYWRpdXModmFsdWU6bnVtYmVyKVxuXHR7XG5cdFx0dGhpcy5fcmFkaXVzID0gdmFsdWU7XG5cblx0XHR0aGlzLl9wSW52YWxpZGF0ZUdlb21ldHJ5KCk7XG5cdH1cblxuXHQvKipcblx0ICogRGVmaW5lcyB0aGUgbnVtYmVyIG9mIGhvcml6b250YWwgc2VnbWVudHMgdGhhdCBtYWtlIHVwIHRoZSBzcGhlcmUuIERlZmF1bHRzIHRvIDE2LlxuXHQgKi9cblx0cHVibGljIGdldCBzZWdtZW50c1coKTpudW1iZXJcblx0e1xuXHRcdHJldHVybiB0aGlzLl9zZWdtZW50c1c7XG5cdH1cblxuXHRwdWJsaWMgc2V0IHNlZ21lbnRzVyh2YWx1ZTpudW1iZXIpXG5cdHtcblx0XHR0aGlzLl9zZWdtZW50c1cgPSB2YWx1ZTtcblxuXHRcdHRoaXMuX3BJbnZhbGlkYXRlR2VvbWV0cnkoKTtcblx0XHR0aGlzLl9wSW52YWxpZGF0ZVVWcygpO1xuXHR9XG5cblx0LyoqXG5cdCAqIERlZmluZXMgdGhlIG51bWJlciBvZiB2ZXJ0aWNhbCBzZWdtZW50cyB0aGF0IG1ha2UgdXAgdGhlIHNwaGVyZS4gRGVmYXVsdHMgdG8gMTIuXG5cdCAqL1xuXHRwdWJsaWMgZ2V0IHNlZ21lbnRzSCgpOm51bWJlclxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX3NlZ21lbnRzSDtcblx0fVxuXG5cdHB1YmxpYyBzZXQgc2VnbWVudHNIKHZhbHVlOm51bWJlcilcblx0e1xuXHRcdHRoaXMuX3NlZ21lbnRzSCA9IHZhbHVlO1xuXG5cdFx0dGhpcy5fcEludmFsaWRhdGVHZW9tZXRyeSgpO1xuXHRcdHRoaXMuX3BJbnZhbGlkYXRlVVZzKCk7XG5cdH1cblxuXHQvKipcblx0ICogRGVmaW5lcyB3aGV0aGVyIHRoZSBzcGhlcmUgcG9sZXMgc2hvdWxkIGxheSBvbiB0aGUgWS1heGlzICh0cnVlKSBvciBvbiB0aGUgWi1heGlzIChmYWxzZSkuXG5cdCAqL1xuXHRwdWJsaWMgZ2V0IHlVcCgpOmJvb2xlYW5cblx0e1xuXHRcdHJldHVybiB0aGlzLl95VXA7XG5cdH1cblxuXHRwdWJsaWMgc2V0IHlVcCh2YWx1ZTpib29sZWFuKVxuXHR7XG5cdFx0dGhpcy5feVVwID0gdmFsdWU7XG5cblx0XHR0aGlzLl9wSW52YWxpZGF0ZUdlb21ldHJ5KCk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIG5ldyBTcGhlcmUgb2JqZWN0LlxuXHQgKlxuXHQgKiBAcGFyYW0gcmFkaXVzIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS5cblx0ICogQHBhcmFtIHNlZ21lbnRzVyBEZWZpbmVzIHRoZSBudW1iZXIgb2YgaG9yaXpvbnRhbCBzZWdtZW50cyB0aGF0IG1ha2UgdXAgdGhlIHNwaGVyZS5cblx0ICogQHBhcmFtIHNlZ21lbnRzSCBEZWZpbmVzIHRoZSBudW1iZXIgb2YgdmVydGljYWwgc2VnbWVudHMgdGhhdCBtYWtlIHVwIHRoZSBzcGhlcmUuXG5cdCAqIEBwYXJhbSB5VXAgRGVmaW5lcyB3aGV0aGVyIHRoZSBzcGhlcmUgcG9sZXMgc2hvdWxkIGxheSBvbiB0aGUgWS1heGlzICh0cnVlKSBvciBvbiB0aGUgWi1heGlzIChmYWxzZSkuXG5cdCAqL1xuXHRjb25zdHJ1Y3RvcihyYWRpdXM6bnVtYmVyID0gNTAsIHNlZ21lbnRzVzpudW1iZXIgPSAxNiwgc2VnbWVudHNIOm51bWJlciA9IDEyLCB5VXA6Ym9vbGVhbiA9IHRydWUpXG5cdHtcblx0XHRzdXBlcigpO1xuXG5cdFx0dGhpcy5fcmFkaXVzID0gcmFkaXVzO1xuXHRcdHRoaXMuX3NlZ21lbnRzVyA9IHNlZ21lbnRzVztcblx0XHR0aGlzLl9zZWdtZW50c0ggPSBzZWdtZW50c0g7XG5cdFx0dGhpcy5feVVwID0geVVwO1xuXHR9XG5cblx0LyoqXG5cdCAqIEBpbmhlcml0RG9jXG5cdCAqL1xuXHRwdWJsaWMgX3BCdWlsZEdlb21ldHJ5KHRhcmdldDpTdWJHZW9tZXRyeUJhc2UsIGdlb21ldHJ5VHlwZTpzdHJpbmcpXG5cdHtcblx0XHR2YXIgaW5kaWNlczpBcnJheTxudW1iZXI+IC8qdWludCovO1xuXHRcdHZhciBwb3NpdGlvbnM6QXJyYXk8bnVtYmVyPjtcblx0XHR2YXIgbm9ybWFsczpBcnJheTxudW1iZXI+O1xuXHRcdHZhciB0YW5nZW50czpBcnJheTxudW1iZXI+O1xuXG5cdFx0dmFyIGk6bnVtYmVyO1xuXHRcdHZhciBqOm51bWJlcjtcblx0XHR2YXIgdmlkeDpudW1iZXIsIGZpZHg6bnVtYmVyOyAvLyBpbmRpY2VzXG5cblx0XHR2YXIgY29tcDE6bnVtYmVyO1xuXHRcdHZhciBjb21wMjpudW1iZXI7XG5cdFx0dmFyIG51bVZlcnRpY2VzOm51bWJlcjtcblxuXG5cdFx0aWYgKGdlb21ldHJ5VHlwZSA9PSBcInRyaWFuZ2xlU3ViR2VvbWV0cnlcIikge1xuXG5cdFx0XHR2YXIgdHJpYW5nbGVHZW9tZXRyeTpUcmlhbmdsZVN1Ykdlb21ldHJ5ID0gPFRyaWFuZ2xlU3ViR2VvbWV0cnk+IHRhcmdldDtcblxuXHRcdFx0bnVtVmVydGljZXMgPSAodGhpcy5fc2VnbWVudHNIICsgMSkqKHRoaXMuX3NlZ21lbnRzVyArIDEpO1xuXG5cdFx0XHRpZiAobnVtVmVydGljZXMgPT0gdHJpYW5nbGVHZW9tZXRyeS5udW1WZXJ0aWNlcyAmJiB0cmlhbmdsZUdlb21ldHJ5LmluZGljZXMgIT0gbnVsbCkge1xuXHRcdFx0XHRpbmRpY2VzID0gdHJpYW5nbGVHZW9tZXRyeS5pbmRpY2VzO1xuXHRcdFx0XHRwb3NpdGlvbnMgPSB0cmlhbmdsZUdlb21ldHJ5LnBvc2l0aW9ucztcblx0XHRcdFx0bm9ybWFscyA9IHRyaWFuZ2xlR2VvbWV0cnkudmVydGV4Tm9ybWFscztcblx0XHRcdFx0dGFuZ2VudHMgPSB0cmlhbmdsZUdlb21ldHJ5LnZlcnRleFRhbmdlbnRzO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aW5kaWNlcyA9IG5ldyBBcnJheTxudW1iZXI+KCh0aGlzLl9zZWdtZW50c0ggLSAxKSp0aGlzLl9zZWdtZW50c1cqNik7XG5cdFx0XHRcdHBvc2l0aW9ucyA9IG5ldyBBcnJheTxudW1iZXI+KG51bVZlcnRpY2VzKjMpO1xuXHRcdFx0XHRub3JtYWxzID0gbmV3IEFycmF5PG51bWJlcj4obnVtVmVydGljZXMqMyk7XG5cdFx0XHRcdHRhbmdlbnRzID0gbmV3IEFycmF5PG51bWJlcj4obnVtVmVydGljZXMqMyk7XG5cblx0XHRcdFx0dGhpcy5fcEludmFsaWRhdGVVVnMoKTtcblx0XHRcdH1cblxuXHRcdFx0dmlkeCA9IDA7XG5cdFx0XHRmaWR4ID0gMDtcblxuXHRcdFx0dmFyIHN0YXJ0SW5kZXg6bnVtYmVyO1xuXHRcdFx0dmFyIHQxOm51bWJlcjtcblx0XHRcdHZhciB0MjpudW1iZXI7XG5cblx0XHRcdGZvciAoaiA9IDA7IGogPD0gdGhpcy5fc2VnbWVudHNIOyArK2opIHtcblxuXHRcdFx0XHRzdGFydEluZGV4ID0gdmlkeDtcblxuXHRcdFx0XHR2YXIgaG9yYW5nbGU6bnVtYmVyID0gTWF0aC5QSSpqL3RoaXMuX3NlZ21lbnRzSDtcblx0XHRcdFx0dmFyIHo6bnVtYmVyID0gLXRoaXMuX3JhZGl1cypNYXRoLmNvcyhob3JhbmdsZSk7XG5cdFx0XHRcdHZhciByaW5ncmFkaXVzOm51bWJlciA9IHRoaXMuX3JhZGl1cypNYXRoLnNpbihob3JhbmdsZSk7XG5cblx0XHRcdFx0Zm9yIChpID0gMDsgaSA8PSB0aGlzLl9zZWdtZW50c1c7ICsraSkge1xuXHRcdFx0XHRcdHZhciB2ZXJhbmdsZTpudW1iZXIgPSAyKk1hdGguUEkqaS90aGlzLl9zZWdtZW50c1c7XG5cdFx0XHRcdFx0dmFyIHg6bnVtYmVyID0gcmluZ3JhZGl1cypNYXRoLmNvcyh2ZXJhbmdsZSk7XG5cdFx0XHRcdFx0dmFyIHk6bnVtYmVyID0gcmluZ3JhZGl1cypNYXRoLnNpbih2ZXJhbmdsZSk7XG5cdFx0XHRcdFx0dmFyIG5vcm1MZW46bnVtYmVyID0gMS9NYXRoLnNxcnQoeCp4ICsgeSp5ICsgeip6KTtcblx0XHRcdFx0XHR2YXIgdGFuTGVuOm51bWJlciA9IE1hdGguc3FydCh5KnkgKyB4KngpO1xuXG5cdFx0XHRcdFx0aWYgKHRoaXMuX3lVcCkge1xuXG5cdFx0XHRcdFx0XHR0MSA9IDA7XG5cdFx0XHRcdFx0XHR0MiA9IHRhbkxlbiA+IC4wMDc/IHgvdGFuTGVuIDogMDtcblx0XHRcdFx0XHRcdGNvbXAxID0gLXo7XG5cdFx0XHRcdFx0XHRjb21wMiA9IHk7XG5cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dDEgPSB0YW5MZW4gPiAuMDA3PyB4L3RhbkxlbiA6IDA7XG5cdFx0XHRcdFx0XHR0MiA9IDA7XG5cdFx0XHRcdFx0XHRjb21wMSA9IHk7XG5cdFx0XHRcdFx0XHRjb21wMiA9IHo7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGkgPT0gdGhpcy5fc2VnbWVudHNXKSB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbnNbdmlkeF0gPSBwb3NpdGlvbnNbc3RhcnRJbmRleF07XG5cdFx0XHRcdFx0XHRwb3NpdGlvbnNbdmlkeCsxXSA9IHBvc2l0aW9uc1tzdGFydEluZGV4ICsgMV07XG5cdFx0XHRcdFx0XHRwb3NpdGlvbnNbdmlkeCsyXSA9IHBvc2l0aW9uc1tzdGFydEluZGV4ICsgMl07XG5cdFx0XHRcdFx0XHRub3JtYWxzW3ZpZHhdID0gbm9ybWFsc1tzdGFydEluZGV4XSArICh4Km5vcm1MZW4pKi41O1xuXHRcdFx0XHRcdFx0bm9ybWFsc1t2aWR4KzFdID0gbm9ybWFsc1tzdGFydEluZGV4ICsgMV0gKyAoIGNvbXAxKm5vcm1MZW4pKi41O1xuXHRcdFx0XHRcdFx0bm9ybWFsc1t2aWR4KzJdID0gbm9ybWFsc1tzdGFydEluZGV4ICsgMl0gKyAoY29tcDIqbm9ybUxlbikqLjU7XG5cdFx0XHRcdFx0XHR0YW5nZW50c1t2aWR4XSA9IHRhbkxlbiA+IC4wMDc/IC15L3RhbkxlbiA6IDE7XG5cdFx0XHRcdFx0XHR0YW5nZW50c1t2aWR4KzFdID0gdDE7XG5cdFx0XHRcdFx0XHR0YW5nZW50c1t2aWR4KzJdID0gdDI7XG5cblx0XHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0XHRwb3NpdGlvbnNbdmlkeF0gPSB4O1xuXHRcdFx0XHRcdFx0cG9zaXRpb25zW3ZpZHgrMV0gPSBjb21wMTtcblx0XHRcdFx0XHRcdHBvc2l0aW9uc1t2aWR4KzJdID0gY29tcDI7XG5cdFx0XHRcdFx0XHRub3JtYWxzW3ZpZHhdID0geCpub3JtTGVuO1xuXHRcdFx0XHRcdFx0bm9ybWFsc1t2aWR4KzFdID0gY29tcDEqbm9ybUxlbjtcblx0XHRcdFx0XHRcdG5vcm1hbHNbdmlkeCsyXSA9IGNvbXAyKm5vcm1MZW47XG5cdFx0XHRcdFx0XHR0YW5nZW50c1t2aWR4XSA9IHRhbkxlbiA+IC4wMDc/IC15L3RhbkxlbiA6IDE7XG5cdFx0XHRcdFx0XHR0YW5nZW50c1t2aWR4KzFdID0gdDE7XG5cdFx0XHRcdFx0XHR0YW5nZW50c1t2aWR4KzJdID0gdDI7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGkgPiAwICYmIGogPiAwKSB7XG5cblx0XHRcdFx0XHRcdHZhciBhOm51bWJlciA9ICh0aGlzLl9zZWdtZW50c1cgKyAxKSpqICsgaTtcblx0XHRcdFx0XHRcdHZhciBiOm51bWJlciA9ICh0aGlzLl9zZWdtZW50c1cgKyAxKSpqICsgaSAtIDE7XG5cdFx0XHRcdFx0XHR2YXIgYzpudW1iZXIgPSAodGhpcy5fc2VnbWVudHNXICsgMSkqKGogLSAxKSArIGkgLSAxO1xuXHRcdFx0XHRcdFx0dmFyIGQ6bnVtYmVyID0gKHRoaXMuX3NlZ21lbnRzVyArIDEpKihqIC0gMSkgKyBpO1xuXG5cdFx0XHRcdFx0XHRpZiAoaiA9PSB0aGlzLl9zZWdtZW50c0gpIHtcblxuXHRcdFx0XHRcdFx0XHRwb3NpdGlvbnNbdmlkeF0gPSBwb3NpdGlvbnNbc3RhcnRJbmRleF07XG5cdFx0XHRcdFx0XHRcdHBvc2l0aW9uc1t2aWR4ICsgMV0gPSBwb3NpdGlvbnNbc3RhcnRJbmRleCArIDFdO1xuXHRcdFx0XHRcdFx0XHRwb3NpdGlvbnNbdmlkeCArIDJdID0gcG9zaXRpb25zW3N0YXJ0SW5kZXggKyAyXTtcblxuXHRcdFx0XHRcdFx0XHRpbmRpY2VzW2ZpZHgrK10gPSBhO1xuXHRcdFx0XHRcdFx0XHRpbmRpY2VzW2ZpZHgrK10gPSBjO1xuXHRcdFx0XHRcdFx0XHRpbmRpY2VzW2ZpZHgrK10gPSBkO1xuXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGogPT0gMSkge1xuXG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGE7XG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGI7XG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGM7XG5cblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGE7XG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGI7XG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGM7XG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGE7XG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGM7XG5cdFx0XHRcdFx0XHRcdGluZGljZXNbZmlkeCsrXSA9IGQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dmlkeCArPSAzO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHRyaWFuZ2xlR2VvbWV0cnkudXBkYXRlSW5kaWNlcyhpbmRpY2VzKTtcblxuXHRcdFx0dHJpYW5nbGVHZW9tZXRyeS51cGRhdGVQb3NpdGlvbnMocG9zaXRpb25zKTtcblx0XHRcdHRyaWFuZ2xlR2VvbWV0cnkudXBkYXRlVmVydGV4Tm9ybWFscyhub3JtYWxzKTtcblx0XHRcdHRyaWFuZ2xlR2VvbWV0cnkudXBkYXRlVmVydGV4VGFuZ2VudHModGFuZ2VudHMpO1xuXG5cdFx0fSBlbHNlIGlmIChnZW9tZXRyeVR5cGUgPT0gXCJsaW5lU3ViR2VvbWV0cnlcIikge1xuXG5cdFx0XHR2YXIgbGluZUdlb21ldHJ5OkxpbmVTdWJHZW9tZXRyeSA9IDxMaW5lU3ViR2VvbWV0cnk+IHRhcmdldDtcblxuXHRcdFx0dmFyIG51bVNlZ21lbnRzOm51bWJlciA9ICh0aGlzLl9zZWdtZW50c0ggLSAxKSp0aGlzLl9zZWdtZW50c1cqMjtcblx0XHRcdHZhciBzdGFydFBvc2l0aW9uczpBcnJheTxudW1iZXI+O1xuXHRcdFx0dmFyIGVuZFBvc2l0aW9uczpBcnJheTxudW1iZXI+O1xuXHRcdFx0dmFyIHRoaWNrbmVzczpBcnJheTxudW1iZXI+O1xuXG5cdFx0XHRpZiAobGluZUdlb21ldHJ5LmluZGljZXMgIT0gbnVsbCAmJiBudW1TZWdtZW50cyA9PSBsaW5lR2VvbWV0cnkubnVtU2VnbWVudHMpIHtcblx0XHRcdFx0c3RhcnRQb3NpdGlvbnMgPSBsaW5lR2VvbWV0cnkuc3RhcnRQb3NpdGlvbnM7XG5cdFx0XHRcdGVuZFBvc2l0aW9ucyA9IGxpbmVHZW9tZXRyeS5lbmRQb3NpdGlvbnM7XG5cdFx0XHRcdHRoaWNrbmVzcyA9IGxpbmVHZW9tZXRyeS50aGlja25lc3M7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzdGFydFBvc2l0aW9ucyA9IG5ldyBBcnJheTxudW1iZXI+KG51bVNlZ21lbnRzKjMpO1xuXHRcdFx0XHRlbmRQb3NpdGlvbnMgPSBuZXcgQXJyYXk8bnVtYmVyPihudW1TZWdtZW50cyozKTtcblx0XHRcdFx0dGhpY2tuZXNzID0gbmV3IEFycmF5PG51bWJlcj4obnVtU2VnbWVudHMpO1xuXHRcdFx0fVxuXG5cdFx0XHR2aWR4ID0gMDtcblxuXHRcdFx0ZmlkeCA9IDA7XG5cblx0XHRcdGZvciAoaiA9IDA7IGogPD0gdGhpcy5fc2VnbWVudHNIOyArK2opIHtcblxuXHRcdFx0XHR2YXIgaG9yYW5nbGU6bnVtYmVyID0gTWF0aC5QSSpqL3RoaXMuX3NlZ21lbnRzSDtcblx0XHRcdFx0dmFyIHo6bnVtYmVyID0gLXRoaXMuX3JhZGl1cypNYXRoLmNvcyhob3JhbmdsZSk7XG5cdFx0XHRcdHZhciByaW5ncmFkaXVzOm51bWJlciA9IHRoaXMuX3JhZGl1cypNYXRoLnNpbihob3JhbmdsZSk7XG5cblx0XHRcdFx0Zm9yIChpID0gMDsgaSA8PSB0aGlzLl9zZWdtZW50c1c7ICsraSkge1xuXHRcdFx0XHRcdHZhciB2ZXJhbmdsZTpudW1iZXIgPSAyKk1hdGguUEkqaS90aGlzLl9zZWdtZW50c1c7XG5cdFx0XHRcdFx0dmFyIHg6bnVtYmVyID0gcmluZ3JhZGl1cypNYXRoLmNvcyh2ZXJhbmdsZSk7XG5cdFx0XHRcdFx0dmFyIHk6bnVtYmVyID0gcmluZ3JhZGl1cypNYXRoLnNpbih2ZXJhbmdsZSk7XG5cblx0XHRcdFx0XHRpZiAodGhpcy5feVVwKSB7XG5cdFx0XHRcdFx0XHRjb21wMSA9IC16O1xuXHRcdFx0XHRcdFx0Y29tcDIgPSB5O1xuXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNvbXAxID0geTtcblx0XHRcdFx0XHRcdGNvbXAyID0gejtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoaSA+IDAgJiYgaiA+IDApIHtcblx0XHRcdFx0XHRcdC8vaG9yaXpvbmFsIGxpbmVzXG5cdFx0XHRcdFx0XHRpZiAoaiA8IHRoaXMuX3NlZ21lbnRzSCkge1xuXHRcdFx0XHRcdFx0XHRlbmRQb3NpdGlvbnNbdmlkeF0gPSB4O1xuXHRcdFx0XHRcdFx0XHRlbmRQb3NpdGlvbnNbdmlkeCArIDFdID0gY29tcDE7XG5cdFx0XHRcdFx0XHRcdGVuZFBvc2l0aW9uc1t2aWR4ICsgMl0gPSBjb21wMjtcblxuXHRcdFx0XHRcdFx0XHR0aGlja25lc3NbZmlkeCsrXSA9IDE7XG5cblx0XHRcdFx0XHRcdFx0dmlkeCArPSAzO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHQvL3ZlcnRpY2FsIGxpbmVzXG5cdFx0XHRcdFx0XHRzdGFydFBvc2l0aW9uc1t2aWR4XSA9IGVuZFBvc2l0aW9uc1t2aWR4IC0gdGhpcy5fc2VnbWVudHNXKjZdO1xuXHRcdFx0XHRcdFx0c3RhcnRQb3NpdGlvbnNbdmlkeCArIDFdID0gZW5kUG9zaXRpb25zW3ZpZHggKyAxIC0gdGhpcy5fc2VnbWVudHNXKjZdO1xuXHRcdFx0XHRcdFx0c3RhcnRQb3NpdGlvbnNbdmlkeCArIDJdID0gZW5kUG9zaXRpb25zW3ZpZHggKyAyIC0gdGhpcy5fc2VnbWVudHNXKjZdO1xuXG5cdFx0XHRcdFx0XHRlbmRQb3NpdGlvbnNbdmlkeF0gPSB4O1xuXHRcdFx0XHRcdFx0ZW5kUG9zaXRpb25zW3ZpZHggKyAxXSA9IGNvbXAxO1xuXHRcdFx0XHRcdFx0ZW5kUG9zaXRpb25zW3ZpZHggKyAyXSA9IGNvbXAyO1xuXG5cdFx0XHRcdFx0XHR0aGlja25lc3NbZmlkeCsrXSA9IDE7XG5cblx0XHRcdFx0XHRcdHZpZHggKz0gMztcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoaSA8IHRoaXMuX3NlZ21lbnRzVyAmJiBqID4gMCAmJiBqIDwgdGhpcy5fc2VnbWVudHNIKSB7XG5cdFx0XHRcdFx0XHRzdGFydFBvc2l0aW9uc1t2aWR4XSA9IHg7XG5cdFx0XHRcdFx0XHRzdGFydFBvc2l0aW9uc1t2aWR4ICsgMV0gPSBjb21wMTtcblx0XHRcdFx0XHRcdHN0YXJ0UG9zaXRpb25zW3ZpZHggKyAyXSA9IGNvbXAyO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBidWlsZCByZWFsIGRhdGEgZnJvbSByYXcgZGF0YVxuXHRcdFx0bGluZUdlb21ldHJ5LnVwZGF0ZVBvc2l0aW9ucyhzdGFydFBvc2l0aW9ucywgZW5kUG9zaXRpb25zKTtcblx0XHRcdGxpbmVHZW9tZXRyeS51cGRhdGVUaGlja25lc3ModGhpY2tuZXNzKTtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQGluaGVyaXREb2Ncblx0ICovXG5cdHB1YmxpYyBfcEJ1aWxkVVZzKHRhcmdldDpTdWJHZW9tZXRyeUJhc2UsIGdlb21ldHJ5VHlwZTpzdHJpbmcpXG5cdHtcblx0XHR2YXIgaTpudW1iZXIsIGo6bnVtYmVyO1xuXHRcdHZhciBudW1WZXJ0aWNlczpudW1iZXIgPSAodGhpcy5fc2VnbWVudHNIICsgMSkqKHRoaXMuX3NlZ21lbnRzVyArIDEpO1xuXHRcdHZhciB1dnM6QXJyYXk8bnVtYmVyPjtcblxuXG5cdFx0aWYgKGdlb21ldHJ5VHlwZSA9PSBcInRyaWFuZ2xlU3ViR2VvbWV0cnlcIikge1xuXG5cdFx0XHRudW1WZXJ0aWNlcyA9ICh0aGlzLl9zZWdtZW50c0ggKyAxKSoodGhpcy5fc2VnbWVudHNXICsgMSk7XG5cblx0XHRcdHZhciB0cmlhbmdsZUdlb21ldHJ5OlRyaWFuZ2xlU3ViR2VvbWV0cnkgPSA8VHJpYW5nbGVTdWJHZW9tZXRyeT4gdGFyZ2V0O1xuXG5cdFx0XHRpZiAobnVtVmVydGljZXMgPT0gdHJpYW5nbGVHZW9tZXRyeS5udW1WZXJ0aWNlcyAmJiB0cmlhbmdsZUdlb21ldHJ5LnV2cyAhPSBudWxsKSB7XG5cdFx0XHRcdHV2cyA9IHRyaWFuZ2xlR2VvbWV0cnkudXZzO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dXZzID0gbmV3IEFycmF5PG51bWJlcj4obnVtVmVydGljZXMqMik7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBpbmRleDpudW1iZXIgPSAwO1xuXHRcdFx0Zm9yIChqID0gMDsgaiA8PSB0aGlzLl9zZWdtZW50c0g7ICsraikge1xuXHRcdFx0XHRmb3IgKGkgPSAwOyBpIDw9IHRoaXMuX3NlZ21lbnRzVzsgKytpKSB7XG5cdFx0XHRcdFx0dXZzW2luZGV4KytdID0gKCBpL3RoaXMuX3NlZ21lbnRzVyApKnRyaWFuZ2xlR2VvbWV0cnkuc2NhbGVVO1xuXHRcdFx0XHRcdHV2c1tpbmRleCsrXSA9ICggai90aGlzLl9zZWdtZW50c0ggKSp0cmlhbmdsZUdlb21ldHJ5LnNjYWxlVjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHR0cmlhbmdsZUdlb21ldHJ5LnVwZGF0ZVVWcyh1dnMpO1xuXG5cdFx0fSBlbHNlIGlmIChnZW9tZXRyeVR5cGUgPT0gXCJsaW5lU3ViR2VvbWV0cnlcIikge1xuXHRcdFx0Ly9ub3RoaW5nIHRvIGRvIGhlcmVcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0ID0gUHJpbWl0aXZlU3BoZXJlUHJlZmFiOyJdfQ==