var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var URLLoaderDataFormat = require("awayjs-core/lib/net/URLLoaderDataFormat");
var URLRequestMethod = require("awayjs-core/lib/net/URLRequestMethod");
var URLVariables = require("awayjs-core/lib/net/URLVariables");
var AwayEvent = require("awayjs-core/lib/events/Event");
var EventDispatcher = require("awayjs-core/lib/events/EventDispatcher");
var HTTPStatusEvent = require("awayjs-core/lib/events/HTTPStatusEvent");
var IOErrorEvent = require("awayjs-core/lib/events/IOErrorEvent");
var AwayProgressEvent = require("awayjs-core/lib/events/ProgressEvent");
/**
 * The URLLoader is used to load a single file, as part of a resource.
 *
 * While URLLoader can be used directly, e.g. to create a third-party asset
 * management system, it's recommended to use any of the classes Loader3D, AssetLoader
 * and AssetLibrary instead in most cases.
 *
 * @see AssetLoader
 * @see away.library.AssetLibrary
 */
var URLLoader = (function (_super) {
    __extends(URLLoader, _super);
    /**
     * Creates a new URLLoader object.
     */
    function URLLoader() {
        _super.call(this);
        this._bytesLoaded = 0;
        this._bytesTotal = 0;
        this._dataFormat = URLLoaderDataFormat.TEXT;
        this._loadError = false;
    }
    Object.defineProperty(URLLoader.prototype, "url", {
        /**
         *
         */
        get: function () {
            return this._request ? this._request.url : '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(URLLoader.prototype, "data", {
        /**
         *
         */
        get: function () {
            return this._data;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(URLLoader.prototype, "dataFormat", {
        get: function () {
            return this._dataFormat;
        },
        /**
         *
         * URLLoaderDataFormat.BINARY
         * URLLoaderDataFormat.TEXT
         * URLLoaderDataFormat.VARIABLES
         *
         * @param format
         */
        set: function (format) {
            this._dataFormat = format;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(URLLoader.prototype, "bytesLoaded", {
        /**
         *
         * @returns {number}
         */
        get: function () {
            return this._bytesLoaded;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(URLLoader.prototype, "bytesTotal", {
        /**
         *
         * @returns {number}
         */
        get: function () {
            return this._bytesTotal;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Load a resource from a file.
     *
     * @param request The URLRequest object containing the URL of the object to be loaded.
     */
    URLLoader.prototype.load = function (request) {
        this._request = request;
        this.initXHR();
        if (request.method === URLRequestMethod.POST)
            this.postRequest(request);
        else
            this.getRequest(request);
    };
    /**
     *
     */
    URLLoader.prototype.close = function () {
        this._XHR.abort();
        this.disposeXHR();
    };
    /**
     *
     */
    URLLoader.prototype.dispose = function () {
        if (this._XHR)
            this._XHR.abort();
        this.disposeXHR();
        this._data = null;
        this._dataFormat = null;
        this._bytesLoaded = null;
        this._bytesTotal = null;
    };
    /**
     *
     * @param xhr
     * @param responseType
     */
    URLLoader.prototype.setResponseType = function (xhr, responseType) {
        switch (responseType) {
            case URLLoaderDataFormat.ARRAY_BUFFER:
            case URLLoaderDataFormat.BLOB:
            case URLLoaderDataFormat.TEXT:
                xhr.responseType = responseType;
                break;
            case URLLoaderDataFormat.VARIABLES:
                xhr.responseType = URLLoaderDataFormat.TEXT;
                break;
            case URLLoaderDataFormat.BINARY:
                xhr.responseType = '';
                break;
            default:
        }
    };
    /**
     *
     * @param request {URLRequest}
     */
    URLLoader.prototype.getRequest = function (request) {
        try {
            this._XHR.open(request.method, request.url, request.async);
            this.setResponseType(this._XHR, this._dataFormat);
            this._XHR.send(); // No data to send
        }
        catch (e) {
            this.handleXmlHttpRequestException(e);
        }
    };
    /**
     *
     * @param request {URLRequest}
     */
    URLLoader.prototype.postRequest = function (request) {
        this._loadError = false;
        this._XHR.open(request.method, request.url, request.async);
        if (request.data != null) {
            if (request.data instanceof URLVariables) {
                var urlVars = request.data;
                try {
                    this._XHR.responseType = 'text';
                    this._XHR.send(urlVars.formData);
                }
                catch (e) {
                    this.handleXmlHttpRequestException(e);
                }
            }
            else {
                this.setResponseType(this._XHR, this._dataFormat);
                if (request.data)
                    this._XHR.send(request.data); // TODO: Test
                else
                    this._XHR.send(); // no data to send
            }
        }
        else {
            this._XHR.send(); // No data to send
        }
    };
    /**
     *
     * @param error {XMLHttpRequestException}
     */
    URLLoader.prototype.handleXmlHttpRequestException = function (error /* <XMLHttpRequestException> */) {
        switch (error.code) {
            case 101:
                break;
        }
    };
    /**
     *
     */
    URLLoader.prototype.initXHR = function () {
        var _this = this;
        if (!this._XHR) {
            this._XHR = new XMLHttpRequest();
            this._XHR.onloadstart = function (event) { return _this.onLoadStart(event); }; // loadstart	        - When the request starts.
            this._XHR.onprogress = function (event) { return _this.onProgress(event); }; // progress	            - While loading and sending data.
            this._XHR.onabort = function (event) { return _this.onAbort(event); }; // abort	            - When the request has been aborted, either by invoking the abort() method or navigating away from the page.
            this._XHR.onerror = function (event) { return _this.onLoadError(event); }; // error	            - When the request has failed.
            this._XHR.onload = function (event) { return _this.onLoadComplete(event); }; // load	                - When the request has successfully completed.
            this._XHR.ontimeout = function (event) { return _this.onTimeOut(event); }; // timeout	            - When the author specified timeout has passed before the request could complete.
            this._XHR.onloadend = function (event) { return _this.onLoadEnd(event); }; // loadend	            - When the request has completed, regardless of whether or not it was successful.
            this._XHR.onreadystatechange = function (event) { return _this.onReadyStateChange(event); }; // onreadystatechange   - When XHR state changes
        }
    };
    /**
     *
     */
    URLLoader.prototype.disposeXHR = function () {
        if (this._XHR !== null) {
            this._XHR.onloadstart = null;
            this._XHR.onprogress = null;
            this._XHR.onabort = null;
            this._XHR.onerror = null;
            this._XHR.onload = null;
            this._XHR.ontimeout = null;
            this._XHR.onloadend = null;
            this._XHR = null;
        }
    };
    /**
     *
     * @param source
     */
    URLLoader.prototype.decodeURLVariables = function (source) {
        var result = new Object();
        source = source.split("+").join(" ");
        var tokens, re = /[?&]?([^=]+)=([^&]*)/g;
        while (tokens = re.exec(source))
            result[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);
        return result;
    };
    // XMLHttpRequest - Event Handlers
    /**
     * When XHR state changes
     * @param event
     */
    URLLoader.prototype.onReadyStateChange = function (event) {
        if (this._XHR.readyState == 4) {
            if (this._XHR.status == 404) {
                this._loadError = true;
                if (!this._loadErrorEvent)
                    this._loadErrorEvent = new IOErrorEvent(IOErrorEvent.IO_ERROR);
                this.dispatchEvent(this._loadErrorEvent);
            }
            this.dispatchEvent(new HTTPStatusEvent(HTTPStatusEvent.HTTP_STATUS, this._XHR.status));
        }
    };
    /**
     * When the request has completed, regardless of whether or not it was successful.
     * @param event
     */
    URLLoader.prototype.onLoadEnd = function (event) {
        if (this._loadError === true)
            return;
    };
    /**
     * When the author specified timeout has passed before the request could complete.
     * @param event
     */
    URLLoader.prototype.onTimeOut = function (event) {
        //TODO: Timeout not currently implemented ( also not part of AS3 API )
    };
    /**
     * When the request has been aborted, either by invoking the abort() method or navigating away from the page.
     * @param event
     */
    URLLoader.prototype.onAbort = function (event) {
        // TODO: investigate whether this needs to be an IOError
    };
    /**
     * While loading and sending data.
     * @param event
     */
    URLLoader.prototype.onProgress = function (event) {
        if (!this._progressEvent)
            this._progressEvent = new AwayProgressEvent(AwayProgressEvent.PROGRESS);
        this._progressEvent.bytesTotal = event.total;
        this._progressEvent.bytesLoaded = event.loaded;
        this.dispatchEvent(this._progressEvent);
    };
    /**
     * When the request starts.
     * @param event
     */
    URLLoader.prototype.onLoadStart = function (event) {
        if (!this._loadStartEvent)
            this._loadStartEvent = new AwayEvent(AwayEvent.OPEN);
        this.dispatchEvent(this._loadStartEvent);
    };
    /**
     * When the request has successfully completed.
     * @param event
     */
    URLLoader.prototype.onLoadComplete = function (event) {
        if (this._loadError === true)
            return;
        switch (this._dataFormat) {
            case URLLoaderDataFormat.TEXT:
                this._data = this._XHR.responseText;
                break;
            case URLLoaderDataFormat.VARIABLES:
                this._data = this.decodeURLVariables(this._XHR.responseText);
                break;
            case URLLoaderDataFormat.BLOB:
            case URLLoaderDataFormat.ARRAY_BUFFER:
            case URLLoaderDataFormat.BINARY:
                this._data = this._XHR.response;
                break;
            default:
                this._data = this._XHR.responseText;
                break;
        }
        if (!this._loadCompleteEvent)
            this._loadCompleteEvent = new AwayEvent(AwayEvent.COMPLETE);
        this.dispatchEvent(this._loadCompleteEvent);
    };
    /**
     * When the request has failed. ( due to network issues ).
     * @param event
     */
    URLLoader.prototype.onLoadError = function (event) {
        this._loadError = true;
        if (!this._loadErrorEvent)
            this._loadErrorEvent = new IOErrorEvent(IOErrorEvent.IO_ERROR);
        this.dispatchEvent(this._loadErrorEvent);
    };
    return URLLoader;
})(EventDispatcher);
module.exports = URLLoader;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1jb3JlL2xpYi9uZXQvVVJMTG9hZGVyLnRzIl0sIm5hbWVzIjpbIlVSTExvYWRlciIsIlVSTExvYWRlci5jb25zdHJ1Y3RvciIsIlVSTExvYWRlci51cmwiLCJVUkxMb2FkZXIuZGF0YSIsIlVSTExvYWRlci5kYXRhRm9ybWF0IiwiVVJMTG9hZGVyLmJ5dGVzTG9hZGVkIiwiVVJMTG9hZGVyLmJ5dGVzVG90YWwiLCJVUkxMb2FkZXIubG9hZCIsIlVSTExvYWRlci5jbG9zZSIsIlVSTExvYWRlci5kaXNwb3NlIiwiVVJMTG9hZGVyLnNldFJlc3BvbnNlVHlwZSIsIlVSTExvYWRlci5nZXRSZXF1ZXN0IiwiVVJMTG9hZGVyLnBvc3RSZXF1ZXN0IiwiVVJMTG9hZGVyLmhhbmRsZVhtbEh0dHBSZXF1ZXN0RXhjZXB0aW9uIiwiVVJMTG9hZGVyLmluaXRYSFIiLCJVUkxMb2FkZXIuZGlzcG9zZVhIUiIsIlVSTExvYWRlci5kZWNvZGVVUkxWYXJpYWJsZXMiLCJVUkxMb2FkZXIub25SZWFkeVN0YXRlQ2hhbmdlIiwiVVJMTG9hZGVyLm9uTG9hZEVuZCIsIlVSTExvYWRlci5vblRpbWVPdXQiLCJVUkxMb2FkZXIub25BYm9ydCIsIlVSTExvYWRlci5vblByb2dyZXNzIiwiVVJMTG9hZGVyLm9uTG9hZFN0YXJ0IiwiVVJMTG9hZGVyLm9uTG9hZENvbXBsZXRlIiwiVVJMTG9hZGVyLm9uTG9hZEVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFPLG1CQUFtQixXQUFhLHlDQUF5QyxDQUFDLENBQUM7QUFFbEYsSUFBTyxnQkFBZ0IsV0FBYyxzQ0FBc0MsQ0FBQyxDQUFDO0FBQzdFLElBQU8sWUFBWSxXQUFlLGtDQUFrQyxDQUFDLENBQUM7QUFDdEUsSUFBTyxTQUFTLFdBQWUsOEJBQThCLENBQUMsQ0FBQztBQUMvRCxJQUFPLGVBQWUsV0FBYyx3Q0FBd0MsQ0FBQyxDQUFDO0FBQzlFLElBQU8sZUFBZSxXQUFjLHdDQUF3QyxDQUFDLENBQUM7QUFD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Q0EsSUFBSUEsQ0FBQ0EsVUFBVUEsS0FBS0EsSUFBSUEsQ0FBQ0E7WUFDNUJBLE1BQU1BLENBQUNBO1FBRVJBLE1BQU1BLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLENBQUNBLENBQUNBO1lBQzFCQSxLQUFLQSxtQkFBbUJBLENBQUNBLElBQUlBO2dCQUM1QkEsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0E7Z0JBQ3BDQSxLQUFLQSxDQUFDQTtZQUVQQSxLQUFLQSxtQkFBbUJBLENBQUNBLFNBQVNBO2dCQUNqQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQTtnQkFDN0RBLEtBQUtBLENBQUNBO1lBRVBBLEtBQUtBLG1CQUFtQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7WUFDOUJBLEtBQUtBLG1CQUFtQkEsQ0FBQ0EsWUFBWUEsQ0FBQ0E7WUFDdENBLEtBQUtBLG1CQUFtQkEsQ0FBQ0EsTUFBTUE7Z0JBQzlCQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQTtnQkFDaENBLEtBQUtBLENBQUNBO1lBRVBBO2dCQUNDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtnQkFDcENBLEtBQUtBLENBQUNBO1FBQ1JBLENBQUNBO1FBRURBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLGtCQUFrQkEsQ0FBQ0E7WUFDNUJBLElBQUlBLENBQUNBLGtCQUFrQkEsR0FBR0EsSUFBSUEsU0FBU0EsQ0FBQ0EsU0FBU0EsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFFN0RBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLElBQUlBLENBQUNBLGtCQUFrQkEsQ0FBQ0EsQ0FBQ0E7SUFDN0NBLENBQUNBO0lBRUR2Qjs7O09BR0dBO0lBQ0tBLCtCQUFXQSxHQUFuQkEsVUFBb0JBLEtBQVdBO1FBRTlCd0IsSUFBSUEsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFFdkJBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLGVBQWVBLENBQUNBO1lBQ3pCQSxJQUFJQSxDQUFDQSxlQUFlQSxHQUFHQSxJQUFJQSxZQUFZQSxDQUFDQSxZQUFZQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQTtRQUVoRUEsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsQ0FBQ0E7SUFDMUNBLENBQUNBO0lBQ0Z4QixnQkFBQ0E7QUFBREEsQ0EzWUEsQUEyWUNBLEVBM1l1QixlQUFlLEVBMll0QztBQUVELEFBQW1CLGlCQUFWLFNBQVMsQ0FBQyIsImZpbGUiOiJuZXQvVVJMTG9hZGVyLmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVUkxMb2FkZXJEYXRhRm9ybWF0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxMb2FkZXJEYXRhRm9ybWF0XCIpO1xyXG5pbXBvcnQgVVJMUmVxdWVzdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvbmV0L1VSTFJlcXVlc3RcIik7XHJcbmltcG9ydCBVUkxSZXF1ZXN0TWV0aG9kXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvbmV0L1VSTFJlcXVlc3RNZXRob2RcIik7XHJcbmltcG9ydCBVUkxWYXJpYWJsZXNcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxWYXJpYWJsZXNcIik7XHJcbmltcG9ydCBBd2F5RXZlbnRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2V2ZW50cy9FdmVudFwiKTtcclxuaW1wb3J0IEV2ZW50RGlzcGF0Y2hlclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2V2ZW50cy9FdmVudERpc3BhdGNoZXJcIik7XHJcbmltcG9ydCBIVFRQU3RhdHVzRXZlbnRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9ldmVudHMvSFRUUFN0YXR1c0V2ZW50XCIpO1xyXG5pbXBvcnQgSU9FcnJvckV2ZW50XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9ldmVudHMvSU9FcnJvckV2ZW50XCIpO1xyXG5pbXBvcnQgQXdheVByb2dyZXNzRXZlbnRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXZlbnRzL1Byb2dyZXNzRXZlbnRcIik7XHJcblxyXG4vKipcclxuICogVGhlIFVSTExvYWRlciBpcyB1c2VkIHRvIGxvYWQgYSBzaW5nbGUgZmlsZSwgYXMgcGFydCBvZiBhIHJlc291cmNlLlxyXG4gKlxyXG4gKiBXaGlsZSBVUkxMb2FkZXIgY2FuIGJlIHVzZWQgZGlyZWN0bHksIGUuZy4gdG8gY3JlYXRlIGEgdGhpcmQtcGFydHkgYXNzZXRcclxuICogbWFuYWdlbWVudCBzeXN0ZW0sIGl0J3MgcmVjb21tZW5kZWQgdG8gdXNlIGFueSBvZiB0aGUgY2xhc3NlcyBMb2FkZXIzRCwgQXNzZXRMb2FkZXJcclxuICogYW5kIEFzc2V0TGlicmFyeSBpbnN0ZWFkIGluIG1vc3QgY2FzZXMuXHJcbiAqXHJcbiAqIEBzZWUgQXNzZXRMb2FkZXJcclxuICogQHNlZSBhd2F5LmxpYnJhcnkuQXNzZXRMaWJyYXJ5XHJcbiAqL1xyXG5jbGFzcyBVUkxMb2FkZXIgZXh0ZW5kcyBFdmVudERpc3BhdGNoZXJcclxue1xyXG5cdHByaXZhdGUgX1hIUjpYTUxIdHRwUmVxdWVzdDtcclxuXHRwcml2YXRlIF9ieXRlc0xvYWRlZDpudW1iZXIgPSAwO1xyXG5cdHByaXZhdGUgX2J5dGVzVG90YWw6bnVtYmVyID0gMDtcclxuXHRwcml2YXRlIF9kYXRhRm9ybWF0OnN0cmluZyA9IFVSTExvYWRlckRhdGFGb3JtYXQuVEVYVDtcclxuXHRwcml2YXRlIF9sb2FkRXJyb3I6Ym9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRwcml2YXRlIF9yZXF1ZXN0OlVSTFJlcXVlc3Q7XHJcblx0cHJpdmF0ZSBfZGF0YTphbnk7XHJcblxyXG5cdHByaXZhdGUgX2xvYWRTdGFydEV2ZW50OkF3YXlFdmVudDtcclxuXHRwcml2YXRlIF9sb2FkRXJyb3JFdmVudDpJT0Vycm9yRXZlbnQ7XHJcblx0cHJpdmF0ZSBfbG9hZENvbXBsZXRlRXZlbnQ6QXdheUV2ZW50O1xyXG5cdHByaXZhdGUgX3Byb2dyZXNzRXZlbnQ6QXdheVByb2dyZXNzRXZlbnQ7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENyZWF0ZXMgYSBuZXcgVVJMTG9hZGVyIG9iamVjdC5cclxuXHQgKi9cclxuXHRjb25zdHJ1Y3RvcigpXHJcblx0e1xyXG5cdFx0c3VwZXIoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICovXHJcblx0cHVibGljIGdldCB1cmwoKTpzdHJpbmdcclxuXHR7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuX3JlcXVlc3Q/IHRoaXMuX3JlcXVlc3QudXJsIDogJyc7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXQgZGF0YSgpOmFueVxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9kYXRhO1xyXG5cdH1cclxuXHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICogVVJMTG9hZGVyRGF0YUZvcm1hdC5CSU5BUllcclxuXHQgKiBVUkxMb2FkZXJEYXRhRm9ybWF0LlRFWFRcclxuXHQgKiBVUkxMb2FkZXJEYXRhRm9ybWF0LlZBUklBQkxFU1xyXG5cdCAqXHJcblx0ICogQHBhcmFtIGZvcm1hdFxyXG5cdCAqL1xyXG5cdHB1YmxpYyBzZXQgZGF0YUZvcm1hdChmb3JtYXQ6c3RyaW5nKVxyXG5cdHtcclxuXHRcdHRoaXMuX2RhdGFGb3JtYXQgPSBmb3JtYXQ7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0IGRhdGFGb3JtYXQoKTpzdHJpbmdcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fZGF0YUZvcm1hdDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRwdWJsaWMgZ2V0IGJ5dGVzTG9hZGVkKCk6bnVtYmVyXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX2J5dGVzTG9hZGVkO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXQgYnl0ZXNUb3RhbCgpOm51bWJlclxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9ieXRlc1RvdGFsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogTG9hZCBhIHJlc291cmNlIGZyb20gYSBmaWxlLlxyXG5cdCAqXHJcblx0ICogQHBhcmFtIHJlcXVlc3QgVGhlIFVSTFJlcXVlc3Qgb2JqZWN0IGNvbnRhaW5pbmcgdGhlIFVSTCBvZiB0aGUgb2JqZWN0IHRvIGJlIGxvYWRlZC5cclxuXHQgKi9cclxuXHRwdWJsaWMgbG9hZChyZXF1ZXN0OlVSTFJlcXVlc3QpOnZvaWRcclxuXHR7XHJcblx0XHR0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcclxuXHJcblx0XHR0aGlzLmluaXRYSFIoKTtcclxuXHJcblx0XHRpZiAocmVxdWVzdC5tZXRob2QgPT09IFVSTFJlcXVlc3RNZXRob2QuUE9TVClcclxuXHRcdFx0dGhpcy5wb3N0UmVxdWVzdChyZXF1ZXN0KTtcclxuXHRcdGVsc2VcclxuXHRcdFx0dGhpcy5nZXRSZXF1ZXN0KHJlcXVlc3QpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKi9cclxuXHRwdWJsaWMgY2xvc2UoKTp2b2lkXHJcblx0e1xyXG5cdFx0dGhpcy5fWEhSLmFib3J0KCk7XHJcblx0XHR0aGlzLmRpc3Bvc2VYSFIoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICovXHJcblx0cHVibGljIGRpc3Bvc2UoKTp2b2lkXHJcblx0e1xyXG5cdFx0aWYgKHRoaXMuX1hIUilcclxuXHRcdFx0dGhpcy5fWEhSLmFib3J0KCk7XHJcblxyXG5cdFx0dGhpcy5kaXNwb3NlWEhSKCk7XHJcblxyXG5cdFx0dGhpcy5fZGF0YSA9IG51bGw7XHJcblx0XHR0aGlzLl9kYXRhRm9ybWF0ID0gbnVsbDtcclxuXHRcdHRoaXMuX2J5dGVzTG9hZGVkID0gbnVsbDtcclxuXHRcdHRoaXMuX2J5dGVzVG90YWwgPSBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKiBAcGFyYW0geGhyXHJcblx0ICogQHBhcmFtIHJlc3BvbnNlVHlwZVxyXG5cdCAqL1xyXG5cdHByaXZhdGUgc2V0UmVzcG9uc2VUeXBlKHhocjpYTUxIdHRwUmVxdWVzdCwgcmVzcG9uc2VUeXBlOnN0cmluZyk6dm9pZFxyXG5cdHtcclxuXHRcdHN3aXRjaCAocmVzcG9uc2VUeXBlKSB7XHJcblx0XHRcdGNhc2UgVVJMTG9hZGVyRGF0YUZvcm1hdC5BUlJBWV9CVUZGRVI6XHJcblx0XHRcdGNhc2UgVVJMTG9hZGVyRGF0YUZvcm1hdC5CTE9COlxyXG5cdFx0XHRjYXNlIFVSTExvYWRlckRhdGFGb3JtYXQuVEVYVDpcclxuXHRcdFx0XHR4aHIucmVzcG9uc2VUeXBlID0gcmVzcG9uc2VUeXBlO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0Y2FzZSBVUkxMb2FkZXJEYXRhRm9ybWF0LlZBUklBQkxFUzpcclxuXHRcdFx0XHR4aHIucmVzcG9uc2VUeXBlID0gVVJMTG9hZGVyRGF0YUZvcm1hdC5URVhUO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0Y2FzZSBVUkxMb2FkZXJEYXRhRm9ybWF0LkJJTkFSWTpcclxuXHRcdFx0XHR4aHIucmVzcG9uc2VUeXBlID0gJyc7XHJcblx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRkZWZhdWx0OlxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gcmVxdWVzdCB7VVJMUmVxdWVzdH1cclxuXHQgKi9cclxuXHRwcml2YXRlIGdldFJlcXVlc3QocmVxdWVzdDpVUkxSZXF1ZXN0KTp2b2lkXHJcblx0e1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0dGhpcy5fWEhSLm9wZW4ocmVxdWVzdC5tZXRob2QsIHJlcXVlc3QudXJsLCByZXF1ZXN0LmFzeW5jKTtcclxuXHRcdFx0dGhpcy5zZXRSZXNwb25zZVR5cGUodGhpcy5fWEhSLCB0aGlzLl9kYXRhRm9ybWF0KTtcclxuXHRcdFx0dGhpcy5fWEhSLnNlbmQoKTsgLy8gTm8gZGF0YSB0byBzZW5kXHJcblx0XHR9IGNhdGNoIChlIC8qIDxYTUxIdHRwUmVxdWVzdEV4Y2VwdGlvbj4gKi8pIHtcclxuXHRcdFx0dGhpcy5oYW5kbGVYbWxIdHRwUmVxdWVzdEV4Y2VwdGlvbihlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICogQHBhcmFtIHJlcXVlc3Qge1VSTFJlcXVlc3R9XHJcblx0ICovXHJcblx0cHJpdmF0ZSBwb3N0UmVxdWVzdChyZXF1ZXN0OlVSTFJlcXVlc3QpOnZvaWRcclxuXHR7XHJcblx0XHR0aGlzLl9sb2FkRXJyb3IgPSBmYWxzZTtcclxuXHJcblx0XHR0aGlzLl9YSFIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC51cmwsIHJlcXVlc3QuYXN5bmMpO1xyXG5cclxuXHRcdGlmIChyZXF1ZXN0LmRhdGEgIT0gbnVsbCkge1xyXG5cdFx0XHRpZiAocmVxdWVzdC5kYXRhIGluc3RhbmNlb2YgVVJMVmFyaWFibGVzKSB7XHJcblx0XHRcdFx0dmFyIHVybFZhcnM6VVJMVmFyaWFibGVzID0gPFVSTFZhcmlhYmxlcz4gcmVxdWVzdC5kYXRhO1xyXG5cclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0dGhpcy5fWEhSLnJlc3BvbnNlVHlwZSA9ICd0ZXh0JztcclxuXHRcdFx0XHRcdHRoaXMuX1hIUi5zZW5kKHVybFZhcnMuZm9ybURhdGEpO1xyXG5cdFx0XHRcdH0gY2F0Y2ggKGUgLyogPFhNTEh0dHBSZXF1ZXN0RXhjZXB0aW9uPiAqLykge1xyXG5cdFx0XHRcdFx0dGhpcy5oYW5kbGVYbWxIdHRwUmVxdWVzdEV4Y2VwdGlvbihlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5zZXRSZXNwb25zZVR5cGUodGhpcy5fWEhSLCB0aGlzLl9kYXRhRm9ybWF0KTtcclxuXHJcblx0XHRcdFx0aWYgKHJlcXVlc3QuZGF0YSlcclxuXHRcdFx0XHRcdHRoaXMuX1hIUi5zZW5kKHJlcXVlc3QuZGF0YSk7IC8vIFRPRE86IFRlc3RcclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHR0aGlzLl9YSFIuc2VuZCgpOyAvLyBubyBkYXRhIHRvIHNlbmRcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5fWEhSLnNlbmQoKTsgLy8gTm8gZGF0YSB0byBzZW5kXHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gZXJyb3Ige1hNTEh0dHBSZXF1ZXN0RXhjZXB0aW9ufVxyXG5cdCAqL1xyXG5cdHByaXZhdGUgaGFuZGxlWG1sSHR0cFJlcXVlc3RFeGNlcHRpb24oZXJyb3I6YW55IC8qIDxYTUxIdHRwUmVxdWVzdEV4Y2VwdGlvbj4gKi8pOnZvaWRcclxuXHR7XHJcblx0XHRzd2l0Y2ggKGVycm9yLmNvZGUpIHtcclxuXHJcblx0XHQvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcblx0XHQgKlxyXG5cdFx0ICogIFhNTEh0dHBSZXF1ZXN0RXhjZXB0aW9uIHsgbWVzc2FnZTogXCJORVRXT1JLX0VSUjogWE1MSHR0cFJlcXVlc3QgRXhjZXB0aW9uIDEwMVwiLCBuYW1lOiBcIk5FVFdPUktfRVJSXCIsIGNvZGU6IDEwMSwgc3RhY2s6IFwiRXJyb3I6IEEgbmV0d29yayBlcnJvciBvY2N1cnJlZCBpbiBzeW5jaHJvbm91cyByZXHigKZcIixORVRXT1JLX0VSUjogMTAx4oCmIH1cclxuXHRcdCAqICBjb2RlOiAxMDEgLCBtZXNzYWdlOiBcIk5FVFdPUktfRVJSOiBYTUxIdHRwUmVxdWVzdCBFeGNlcHRpb24gMTAxXCIgLCAgbmFtZTogXCJORVRXT1JLX0VSUlwiXHJcblx0XHQgKlxyXG5cdFx0ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcblx0XHRcdGNhc2UgMTAxOlxyXG5cdFx0XHRcdC8vIE5vdGU6IG9uTG9hZEVycm9yIGV2ZW50IHRocm93cyBJT19FUlJPUiBldmVudCAtIHRoaXMgY2FzZSBpcyBhbHJlYWR5IENvdmVyZWRcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICovXHJcblx0cHJpdmF0ZSBpbml0WEhSKClcclxuXHR7XHJcblx0XHRpZiAoIXRoaXMuX1hIUikge1xyXG5cdFx0XHR0aGlzLl9YSFIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuXHJcblx0XHRcdHRoaXMuX1hIUi5vbmxvYWRzdGFydCA9IChldmVudDpQcm9ncmVzc0V2ZW50KSA9PiB0aGlzLm9uTG9hZFN0YXJ0KGV2ZW50KTsgICAgICAgICAgICAgICAgIC8vIGxvYWRzdGFydFx0ICAgICAgICAtIFdoZW4gdGhlIHJlcXVlc3Qgc3RhcnRzLlxyXG5cdFx0XHR0aGlzLl9YSFIub25wcm9ncmVzcyA9IChldmVudDpQcm9ncmVzc0V2ZW50KSA9PiB0aGlzLm9uUHJvZ3Jlc3MoZXZlbnQpO1x0ICAgICAgICAgICAgICAgIC8vIHByb2dyZXNzXHQgICAgICAgICAgICAtIFdoaWxlIGxvYWRpbmcgYW5kIHNlbmRpbmcgZGF0YS5cclxuXHRcdFx0dGhpcy5fWEhSLm9uYWJvcnQgPSAoZXZlbnQ6VUlFdmVudCkgPT4gdGhpcy5vbkFib3J0KGV2ZW50KTtcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFib3J0XHQgICAgICAgICAgICAtIFdoZW4gdGhlIHJlcXVlc3QgaGFzIGJlZW4gYWJvcnRlZCwgZWl0aGVyIGJ5IGludm9raW5nIHRoZSBhYm9ydCgpIG1ldGhvZCBvciBuYXZpZ2F0aW5nIGF3YXkgZnJvbSB0aGUgcGFnZS5cclxuXHRcdFx0dGhpcy5fWEhSLm9uZXJyb3IgPSAoZXZlbnQ6RXJyb3JFdmVudCkgPT4gdGhpcy5vbkxvYWRFcnJvcihldmVudCk7ICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3JcdCAgICAgICAgICAgIC0gV2hlbiB0aGUgcmVxdWVzdCBoYXMgZmFpbGVkLlxyXG5cdFx0XHR0aGlzLl9YSFIub25sb2FkID0gKGV2ZW50OkV2ZW50KSA9PiB0aGlzLm9uTG9hZENvbXBsZXRlKGV2ZW50KTsgICAgICAgICAgICAgICAgICAgLy8gbG9hZFx0ICAgICAgICAgICAgICAgIC0gV2hlbiB0aGUgcmVxdWVzdCBoYXMgc3VjY2Vzc2Z1bGx5IGNvbXBsZXRlZC5cclxuXHRcdFx0dGhpcy5fWEhSLm9udGltZW91dCA9IChldmVudDpFdmVudCkgPT4gdGhpcy5vblRpbWVPdXQoZXZlbnQpOyAgICAgICAgICAgICAgICAgICAgIC8vIHRpbWVvdXRcdCAgICAgICAgICAgIC0gV2hlbiB0aGUgYXV0aG9yIHNwZWNpZmllZCB0aW1lb3V0IGhhcyBwYXNzZWQgYmVmb3JlIHRoZSByZXF1ZXN0IGNvdWxkIGNvbXBsZXRlLlxyXG5cdFx0XHR0aGlzLl9YSFIub25sb2FkZW5kID0gKGV2ZW50OlByb2dyZXNzRXZlbnQpID0+IHRoaXMub25Mb2FkRW5kKGV2ZW50KTsgICAgICAgICAgICAgICAgICAgICAvLyBsb2FkZW5kXHQgICAgICAgICAgICAtIFdoZW4gdGhlIHJlcXVlc3QgaGFzIGNvbXBsZXRlZCwgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIG9yIG5vdCBpdCB3YXMgc3VjY2Vzc2Z1bC5cclxuXHRcdFx0dGhpcy5fWEhSLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IChldmVudDpFdmVudCkgPT4gdGhpcy5vblJlYWR5U3RhdGVDaGFuZ2UoZXZlbnQpOyAgIC8vIG9ucmVhZHlzdGF0ZWNoYW5nZSAgIC0gV2hlbiBYSFIgc3RhdGUgY2hhbmdlc1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKi9cclxuXHRwcml2YXRlIGRpc3Bvc2VYSFIoKVxyXG5cdHtcclxuXHRcdGlmICh0aGlzLl9YSFIgIT09IG51bGwpIHtcclxuXHRcdFx0dGhpcy5fWEhSLm9ubG9hZHN0YXJ0ID0gbnVsbDtcclxuXHRcdFx0dGhpcy5fWEhSLm9ucHJvZ3Jlc3MgPSBudWxsO1xyXG5cdFx0XHR0aGlzLl9YSFIub25hYm9ydCA9IG51bGw7XHJcblx0XHRcdHRoaXMuX1hIUi5vbmVycm9yID0gbnVsbDtcclxuXHRcdFx0dGhpcy5fWEhSLm9ubG9hZCA9IG51bGw7XHJcblx0XHRcdHRoaXMuX1hIUi5vbnRpbWVvdXQgPSBudWxsO1xyXG5cdFx0XHR0aGlzLl9YSFIub25sb2FkZW5kID0gbnVsbDtcclxuXHRcdFx0dGhpcy5fWEhSID0gbnVsbDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICogQHBhcmFtIHNvdXJjZVxyXG5cdCAqL1xyXG5cdHB1YmxpYyBkZWNvZGVVUkxWYXJpYWJsZXMoc291cmNlOnN0cmluZyk6T2JqZWN0XHJcblx0e1xyXG5cdFx0dmFyIHJlc3VsdDpPYmplY3QgPSBuZXcgT2JqZWN0KCk7XHJcblxyXG5cdFx0c291cmNlID0gc291cmNlLnNwbGl0KFwiK1wiKS5qb2luKFwiIFwiKTtcclxuXHJcblx0XHR2YXIgdG9rZW5zLCByZSA9IC9bPyZdPyhbXj1dKyk9KFteJl0qKS9nO1xyXG5cclxuXHRcdHdoaWxlICh0b2tlbnMgPSByZS5leGVjKHNvdXJjZSkpXHJcblx0XHRcdHJlc3VsdFtkZWNvZGVVUklDb21wb25lbnQodG9rZW5zWzFdKV0gPSBkZWNvZGVVUklDb21wb25lbnQodG9rZW5zWzJdKTtcclxuXHJcblx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdH1cclxuXHJcblx0Ly8gWE1MSHR0cFJlcXVlc3QgLSBFdmVudCBIYW5kbGVyc1xyXG5cclxuXHQvKipcclxuXHQgKiBXaGVuIFhIUiBzdGF0ZSBjaGFuZ2VzXHJcblx0ICogQHBhcmFtIGV2ZW50XHJcblx0ICovXHJcblx0cHJpdmF0ZSBvblJlYWR5U3RhdGVDaGFuZ2UoZXZlbnQ6RXZlbnQpXHJcblx0e1xyXG5cdFx0aWYgKHRoaXMuX1hIUi5yZWFkeVN0YXRlID09IDQpIHtcclxuXHRcdFx0aWYgKHRoaXMuX1hIUi5zdGF0dXMgPT0gNDA0KSB7XHJcblx0XHRcdFx0dGhpcy5fbG9hZEVycm9yID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0aWYgKCF0aGlzLl9sb2FkRXJyb3JFdmVudClcclxuXHRcdFx0XHRcdHRoaXMuX2xvYWRFcnJvckV2ZW50ID0gbmV3IElPRXJyb3JFdmVudChJT0Vycm9yRXZlbnQuSU9fRVJST1IpO1xyXG5cclxuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5fbG9hZEVycm9yRXZlbnQpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEhUVFBTdGF0dXNFdmVudChIVFRQU3RhdHVzRXZlbnQuSFRUUF9TVEFUVVMsIHRoaXMuX1hIUi5zdGF0dXMpKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFdoZW4gdGhlIHJlcXVlc3QgaGFzIGNvbXBsZXRlZCwgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIG9yIG5vdCBpdCB3YXMgc3VjY2Vzc2Z1bC5cclxuXHQgKiBAcGFyYW0gZXZlbnRcclxuXHQgKi9cclxuXHRwcml2YXRlIG9uTG9hZEVuZChldmVudDpQcm9ncmVzc0V2ZW50KVxyXG5cdHtcclxuXHRcdGlmICh0aGlzLl9sb2FkRXJyb3IgPT09IHRydWUpXHJcblx0XHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFdoZW4gdGhlIGF1dGhvciBzcGVjaWZpZWQgdGltZW91dCBoYXMgcGFzc2VkIGJlZm9yZSB0aGUgcmVxdWVzdCBjb3VsZCBjb21wbGV0ZS5cclxuXHQgKiBAcGFyYW0gZXZlbnRcclxuXHQgKi9cclxuXHRwcml2YXRlIG9uVGltZU91dChldmVudDpFdmVudClcclxuXHR7XHJcblx0XHQvL1RPRE86IFRpbWVvdXQgbm90IGN1cnJlbnRseSBpbXBsZW1lbnRlZCAoIGFsc28gbm90IHBhcnQgb2YgQVMzIEFQSSApXHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBXaGVuIHRoZSByZXF1ZXN0IGhhcyBiZWVuIGFib3J0ZWQsIGVpdGhlciBieSBpbnZva2luZyB0aGUgYWJvcnQoKSBtZXRob2Qgb3IgbmF2aWdhdGluZyBhd2F5IGZyb20gdGhlIHBhZ2UuXHJcblx0ICogQHBhcmFtIGV2ZW50XHJcblx0ICovXHJcblx0cHJpdmF0ZSBvbkFib3J0KGV2ZW50OlVJRXZlbnQpXHJcblx0e1xyXG5cdFx0Ly8gVE9ETzogaW52ZXN0aWdhdGUgd2hldGhlciB0aGlzIG5lZWRzIHRvIGJlIGFuIElPRXJyb3JcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFdoaWxlIGxvYWRpbmcgYW5kIHNlbmRpbmcgZGF0YS5cclxuXHQgKiBAcGFyYW0gZXZlbnRcclxuXHQgKi9cclxuXHRwcml2YXRlIG9uUHJvZ3Jlc3MoZXZlbnQ6UHJvZ3Jlc3NFdmVudClcclxuXHR7XHJcblx0XHRpZiAoIXRoaXMuX3Byb2dyZXNzRXZlbnQpXHJcblx0XHRcdHRoaXMuX3Byb2dyZXNzRXZlbnQgPSBuZXcgQXdheVByb2dyZXNzRXZlbnQoQXdheVByb2dyZXNzRXZlbnQuUFJPR1JFU1MpO1xyXG5cclxuXHRcdHRoaXMuX3Byb2dyZXNzRXZlbnQuYnl0ZXNUb3RhbCA9IGV2ZW50LnRvdGFsO1xyXG5cdFx0dGhpcy5fcHJvZ3Jlc3NFdmVudC5ieXRlc0xvYWRlZCA9IGV2ZW50LmxvYWRlZDtcclxuXHJcblx0XHR0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5fcHJvZ3Jlc3NFdmVudCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBXaGVuIHRoZSByZXF1ZXN0IHN0YXJ0cy5cclxuXHQgKiBAcGFyYW0gZXZlbnRcclxuXHQgKi9cclxuXHRwcml2YXRlIG9uTG9hZFN0YXJ0KGV2ZW50OlByb2dyZXNzRXZlbnQpXHJcblx0e1xyXG5cdFx0aWYgKCF0aGlzLl9sb2FkU3RhcnRFdmVudClcclxuXHRcdFx0dGhpcy5fbG9hZFN0YXJ0RXZlbnQgPSBuZXcgQXdheUV2ZW50KEF3YXlFdmVudC5PUEVOKTtcclxuXHJcblx0XHR0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5fbG9hZFN0YXJ0RXZlbnQpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogV2hlbiB0aGUgcmVxdWVzdCBoYXMgc3VjY2Vzc2Z1bGx5IGNvbXBsZXRlZC5cclxuXHQgKiBAcGFyYW0gZXZlbnRcclxuXHQgKi9cclxuXHRwcml2YXRlIG9uTG9hZENvbXBsZXRlKGV2ZW50OkV2ZW50KVxyXG5cdHtcclxuXHRcdGlmICh0aGlzLl9sb2FkRXJyb3IgPT09IHRydWUpXHJcblx0XHRcdHJldHVybjtcclxuXHJcblx0XHRzd2l0Y2ggKHRoaXMuX2RhdGFGb3JtYXQpIHtcclxuXHRcdFx0Y2FzZSBVUkxMb2FkZXJEYXRhRm9ybWF0LlRFWFQ6XHJcblx0XHRcdFx0dGhpcy5fZGF0YSA9IHRoaXMuX1hIUi5yZXNwb25zZVRleHQ7XHJcblx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRjYXNlIFVSTExvYWRlckRhdGFGb3JtYXQuVkFSSUFCTEVTOlxyXG5cdFx0XHRcdHRoaXMuX2RhdGEgPSB0aGlzLmRlY29kZVVSTFZhcmlhYmxlcyh0aGlzLl9YSFIucmVzcG9uc2VUZXh0KTtcclxuXHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdGNhc2UgVVJMTG9hZGVyRGF0YUZvcm1hdC5CTE9COlxyXG5cdFx0XHRjYXNlIFVSTExvYWRlckRhdGFGb3JtYXQuQVJSQVlfQlVGRkVSOlxyXG5cdFx0XHRjYXNlIFVSTExvYWRlckRhdGFGb3JtYXQuQklOQVJZOlxyXG5cdFx0XHRcdHRoaXMuX2RhdGEgPSB0aGlzLl9YSFIucmVzcG9uc2U7XHJcblx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRkZWZhdWx0OlxyXG5cdFx0XHRcdHRoaXMuX2RhdGEgPSB0aGlzLl9YSFIucmVzcG9uc2VUZXh0O1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghdGhpcy5fbG9hZENvbXBsZXRlRXZlbnQpXHJcblx0XHRcdHRoaXMuX2xvYWRDb21wbGV0ZUV2ZW50ID0gbmV3IEF3YXlFdmVudChBd2F5RXZlbnQuQ09NUExFVEUpO1xyXG5cclxuXHRcdHRoaXMuZGlzcGF0Y2hFdmVudCh0aGlzLl9sb2FkQ29tcGxldGVFdmVudCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBXaGVuIHRoZSByZXF1ZXN0IGhhcyBmYWlsZWQuICggZHVlIHRvIG5ldHdvcmsgaXNzdWVzICkuXHJcblx0ICogQHBhcmFtIGV2ZW50XHJcblx0ICovXHJcblx0cHJpdmF0ZSBvbkxvYWRFcnJvcihldmVudDpFdmVudClcclxuXHR7XHJcblx0XHR0aGlzLl9sb2FkRXJyb3IgPSB0cnVlO1xyXG5cclxuXHRcdGlmICghdGhpcy5fbG9hZEVycm9yRXZlbnQpXHJcblx0XHRcdHRoaXMuX2xvYWRFcnJvckV2ZW50ID0gbmV3IElPRXJyb3JFdmVudChJT0Vycm9yRXZlbnQuSU9fRVJST1IpO1xyXG5cclxuXHRcdHRoaXMuZGlzcGF0Y2hFdmVudCh0aGlzLl9sb2FkRXJyb3JFdmVudCk7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgPSBVUkxMb2FkZXI7Il19