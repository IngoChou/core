var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var Vector3D = require("awayjs-core/lib/geom/Vector3D");
var CoordinateSystem = require("awayjs-core/lib/projections/CoordinateSystem");
var ProjectionBase = require("awayjs-core/lib/projections/ProjectionBase");
var PerspectiveProjection = (function (_super) {
    __extends(PerspectiveProjection, _super);
    function PerspectiveProjection(fieldOfView, coordinateSystem) {
        if (fieldOfView === void 0) { fieldOfView = 60; }
        if (coordinateSystem === void 0) { coordinateSystem = "leftHanded"; }
        _super.call(this, coordinateSystem);
        this._fieldOfView = 60;
        this._focalLength = 1000;
        this._hFieldOfView = 60;
        this._hFocalLength = 1000;
        this._preserveAspectRatio = true;
        this._preserveFocalLength = false;
        this.fieldOfView = fieldOfView;
    }
    Object.defineProperty(PerspectiveProjection.prototype, "preserveAspectRatio", {
        /**
         *
         */
        get: function () {
            return this._preserveAspectRatio;
        },
        set: function (value) {
            if (this._preserveAspectRatio == value)
                return;
            this._preserveAspectRatio = value;
            if (this._preserveAspectRatio)
                this.pInvalidateMatrix();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PerspectiveProjection.prototype, "preserveFocalLength", {
        /**
         *
         */
        get: function () {
            return this._preserveFocalLength;
        },
        set: function (value) {
            if (this._preserveFocalLength == value)
                return;
            this._preserveFocalLength = value;
            this.pInvalidateMatrix();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PerspectiveProjection.prototype, "fieldOfView", {
        /**
         *
         */
        get: function () {
            return this._fieldOfView;
        },
        set: function (value) {
            if (this._fieldOfView == value)
                return;
            this._fieldOfView = value;
            this.pInvalidateMatrix();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PerspectiveProjection.prototype, "focalLength", {
        /**
         *
         */
        get: function () {
            return this._focalLength;
        },
        set: function (value) {
            if (this._focalLength == value)
                return;
            this._focalLength = value;
            this.pInvalidateMatrix();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PerspectiveProjection.prototype, "hFieldOfView", {
        /**
         *
         */
        get: function () {
            return this._hFieldOfView;
        },
        set: function (value) {
            if (this._hFieldOfView == value)
                return;
            this._hFieldOfView = value;
            this._hFocalLength = 1 / Math.tan(this._hFieldOfView * Math.PI / 360);
            this.pInvalidateMatrix();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PerspectiveProjection.prototype, "hFocalLength", {
        /**
         *
         */
        get: function () {
            return this._hFocalLength;
        },
        set: function (value) {
            if (this._hFocalLength == value)
                return;
            this._hFocalLength = value;
            this.pInvalidateMatrix();
        },
        enumerable: true,
        configurable: true
    });
    //@override
    PerspectiveProjection.prototype.unproject = function (nX, nY, sZ) {
        var v = new Vector3D(nX, -nY, sZ, 1.0);
        v.x *= sZ;
        v.y *= sZ;
        v = this.unprojectionMatrix.transformVector(v);
        //z is unaffected by transform
        v.z = sZ;
        return v;
    };
    //@override
    PerspectiveProjection.prototype.clone = function () {
        var clone = new PerspectiveProjection(this._fieldOfView);
        clone._pNear = this._pNear;
        clone._pFar = this._pFar;
        clone._pAspectRatio = this._pAspectRatio;
        clone._pCoordinateSystem = this._pCoordinateSystem;
        return clone;
    };
    //@override
    PerspectiveProjection.prototype.pUpdateMatrix = function () {
        var raw = [];
        if (this._preserveFocalLength) {
            if (this._preserveAspectRatio)
                this._hFocalLength = this._focalLength;
            this._fieldOfView = Math.atan(0.5 * this._pScissorRect.height / this._focalLength) * 360 / Math.PI;
            this._hFieldOfView = Math.atan(0.5 * this._pScissorRect.width / this._hFocalLength) * 360 / Math.PI;
        }
        else {
            this._focalLength = 0.5 * this._pScissorRect.height / Math.tan(this._fieldOfView * Math.PI / 360);
            if (this._preserveAspectRatio)
                this._hFocalLength = this._focalLength;
            else
                this._hFocalLength = 0.5 * this._pScissorRect.width / Math.tan(this._hFieldOfView * Math.PI / 360);
        }
        var tanMinX = -this._pOriginX / this._hFocalLength;
        var tanMaxX = (1 - this._pOriginX) / this._hFocalLength;
        var tanMinY = -this._pOriginY / this._focalLength;
        var tanMaxY = (1 - this._pOriginY) / this._focalLength;
        var left;
        var right;
        var top;
        var bottom;
        // assume scissored frustum
        var center = -((tanMinX - tanMaxX) * this._pScissorRect.x + tanMinX * this._pScissorRect.width);
        var middle = ((tanMinY - tanMaxY) * this._pScissorRect.y + tanMinY * this._pScissorRect.height);
        left = center - (tanMaxX - tanMinX) * this._pViewPort.width;
        right = center;
        top = middle;
        bottom = middle + (tanMaxY - tanMinY) * this._pViewPort.height;
        raw[0] = 2 / (right - left);
        raw[5] = 2 / (bottom - top);
        raw[8] = (right + left) / (right - left);
        raw[9] = (bottom + top) / (bottom - top);
        raw[10] = (this._pFar + this._pNear) / (this._pFar - this._pNear);
        raw[11] = 1;
        raw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[12] = raw[13] = raw[15] = 0;
        raw[14] = -2 * this._pFar * this._pNear / (this._pFar - this._pNear);
        if (this._pCoordinateSystem == CoordinateSystem.RIGHT_HANDED)
            raw[5] = -raw[5];
        this._pMatrix.copyRawDataFrom(raw);
        this._pFrustumCorners[0] = this._pFrustumCorners[9] = this._pNear * left;
        this._pFrustumCorners[3] = this._pFrustumCorners[6] = this._pNear * right;
        this._pFrustumCorners[1] = this._pFrustumCorners[4] = this._pNear * top;
        this._pFrustumCorners[7] = this._pFrustumCorners[10] = this._pNear * bottom;
        this._pFrustumCorners[12] = this._pFrustumCorners[21] = this._pFar * left;
        this._pFrustumCorners[15] = this._pFrustumCorners[18] = this._pFar * right;
        this._pFrustumCorners[13] = this._pFrustumCorners[16] = this._pFar * top;
        this._pFrustumCorners[19] = this._pFrustumCorners[22] = this._pFar * bottom;
        this._pFrustumCorners[2] = this._pFrustumCorners[5] = this._pFrustumCorners[8] = this._pFrustumCorners[11] = this._pNear;
        this._pFrustumCorners[14] = this._pFrustumCorners[17] = this._pFrustumCorners[20] = this._pFrustumCorners[23] = this._pFar;
        this._pMatrixInvalid = false;
    };
    return PerspectiveProjection;
})(ProjectionBase);
module.exports = PerspectiveProjection;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1jb3JlL2xpYi9wcm9qZWN0aW9ucy9QZXJzcGVjdGl2ZVByb2plY3Rpb24udHMiXSwibmFtZXMiOlsiUGVyc3BlY3RpdmVQcm9qZWN0aW9uIiwiUGVyc3BlY3RpdmVQcm9qZWN0aW9uLmNvbnN0cnVjdG9yIiwiUGVyc3BlY3RpdmVQcm9qZWN0aW9uLnByZXNlcnZlQXNwZWN0UmF0aW8iLCJQZXJzcGVjdGl2ZVByb2plY3Rpb24ucHJlc2VydmVGb2NhbExlbmd0aCIsIlBlcnNwZWN0aXZlUHJvamVjdGlvbi5maWVsZE9mVmlldyIsIlBlcnNwZWN0aXZlUHJvamVjdGlvbi5mb2NhbExlbmd0aCIsIlBlcnNwZWN0aXZlUHJvamVjdGlvbi5oRmllbGRPZlZpZXciLCJQZXJzcGVjdGl2ZVByb2plY3Rpb24uaEZvY2FsTGVuZ3RoIiwiUGVyc3BlY3RpdmVQcm9qZWN0aW9uLnVucHJvamVjdCIsIlBlcnNwZWN0aXZlUHJvamVjdGlvbi5jbG9uZSIsIlBlcnNwZWN0aXZlUHJvamVjdGlvbi5wVXBkYXRlTWF0cml4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFPLFFBQVEsV0FBZSwrQkFBK0IsQ0FBQyxDQUFDO0FBQy9ELElBQU8sZ0JBQWdCLFdBQWEsOENBQThDLENBQUMsQ0FBQztBQUNwRixJQUFPLGNBQWMsV0FBYSw0Q0FBNEMsQ0FBQyxDQUFDO0FBRWhGLElBQU0scUJBQXFCO0lBQVNBLFVBQTlCQSxxQkFBcUJBLFVBQXVCQTtJQVNqREEsU0FUS0EscUJBQXFCQSxDQVNkQSxXQUF1QkEsRUFBRUEsZ0JBQXNDQTtRQUEvREMsMkJBQXVCQSxHQUF2QkEsZ0JBQXVCQTtRQUFFQSxnQ0FBc0NBLEdBQXRDQSwrQkFBc0NBO1FBRTFFQSxrQkFBTUEsZ0JBQWdCQSxDQUFDQSxDQUFDQTtRQVRqQkEsaUJBQVlBLEdBQVVBLEVBQUVBLENBQUNBO1FBQ3pCQSxpQkFBWUEsR0FBVUEsSUFBSUEsQ0FBQ0E7UUFDM0JBLGtCQUFhQSxHQUFVQSxFQUFFQSxDQUFDQTtRQUMxQkEsa0JBQWFBLEdBQVVBLElBQUlBLENBQUNBO1FBQzVCQSx5QkFBb0JBLEdBQVdBLElBQUlBLENBQUNBO1FBQ3BDQSx5QkFBb0JBLEdBQVdBLEtBQUtBLENBQUNBO1FBSzVDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxXQUFXQSxDQUFDQTtJQUNoQ0EsQ0FBQ0E7SUFLREQsc0JBQVdBLHNEQUFtQkE7UUFIOUJBOztXQUVHQTthQUNIQTtZQUVDRSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBO1FBQ2xDQSxDQUFDQTthQUVERixVQUErQkEsS0FBYUE7WUFFM0NFLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLG9CQUFvQkEsSUFBSUEsS0FBS0EsQ0FBQ0E7Z0JBQ3RDQSxNQUFNQSxDQUFDQTtZQUVSQSxJQUFJQSxDQUFDQSxvQkFBb0JBLEdBQUdBLEtBQUtBLENBQUNBO1lBRWxDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBO2dCQUM3QkEsSUFBSUEsQ0FBQ0EsaUJBQWlCQSxFQUFFQSxDQUFDQTtRQUMzQkEsQ0FBQ0E7OztPQVhBRjtJQWdCREEsc0JBQVdBLHNEQUFtQkE7UUFIOUJBOztXQUVHQTthQUNIQTtZQUVDRyxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBO1FBQ2xDQSxDQUFDQTthQUVESCxVQUErQkEsS0FBYUE7WUFFM0NHLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLG9CQUFvQkEsSUFBSUEsS0FBS0EsQ0FBQ0E7Z0JBQ3RDQSxNQUFNQSxDQUFDQTtZQUVSQSxJQUFJQSxDQUFDQSxvQkFBb0JBLEdBQUdBLEtBQUtBLENBQUNBO1lBRWxDQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEVBQUVBLENBQUNBO1FBQzFCQSxDQUFDQTs7O09BVkFIO0lBZURBLHNCQUFXQSw4Q0FBV0E7UUFIdEJBOztXQUVHQTthQUNIQTtZQUVDSSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7YUFFREosVUFBdUJBLEtBQVlBO1lBRWxDSSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxJQUFJQSxLQUFLQSxDQUFDQTtnQkFDOUJBLE1BQU1BLENBQUNBO1lBRVJBLElBQUlBLENBQUNBLFlBQVlBLEdBQUdBLEtBQUtBLENBQUNBO1lBRTFCQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEVBQUVBLENBQUNBO1FBQzFCQSxDQUFDQTs7O09BVkFKO0lBZURBLHNCQUFXQSw4Q0FBV0E7UUFIdEJBOztXQUVHQTthQUNIQTtZQUVDSyxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7YUFFREwsVUFBdUJBLEtBQVlBO1lBRWxDSyxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxJQUFJQSxLQUFLQSxDQUFDQTtnQkFDOUJBLE1BQU1BLENBQUNBO1lBRVJBLElBQUlBLENBQUNBLFlBQVlBLEdBQUdBLEtBQUtBLENBQUNBO1lBRTFCQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEVBQUVBLENBQUNBO1FBQzFCQSxDQUFDQTs7O09BVkFMO0lBZURBLHNCQUFXQSwrQ0FBWUE7UUFIdkJBOztXQUVHQTthQUNIQTtZQUVDTSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQTtRQUMzQkEsQ0FBQ0E7YUFFRE4sVUFBd0JBLEtBQVlBO1lBRW5DTSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxJQUFJQSxLQUFLQSxDQUFDQTtnQkFDL0JBLE1BQU1BLENBQUNBO1lBRVJBLElBQUlBLENBQUNBLGFBQWFBLEdBQUdBLEtBQUtBLENBQUNBO1lBRTNCQSxJQUFJQSxDQUFDQSxhQUFhQSxHQUFHQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxHQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxHQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUVoRUEsSUFBSUEsQ0FBQ0EsaUJBQWlCQSxFQUFFQSxDQUFDQTtRQUMxQkEsQ0FBQ0E7OztPQVpBTjtJQWlCREEsc0JBQVdBLCtDQUFZQTtRQUh2QkE7O1dBRUdBO2FBQ0hBO1lBRUNPLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBO1FBQzNCQSxDQUFDQTthQUVEUCxVQUF3QkEsS0FBWUE7WUFFbkNPLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLElBQUlBLEtBQUtBLENBQUNBO2dCQUMvQkEsTUFBTUEsQ0FBQ0E7WUFFUkEsSUFBSUEsQ0FBQ0EsYUFBYUEsR0FBR0EsS0FBS0EsQ0FBQ0E7WUFFM0JBLElBQUlBLENBQUNBLGlCQUFpQkEsRUFBRUEsQ0FBQ0E7UUFDMUJBLENBQUNBOzs7T0FWQVA7SUFhREEsV0FBV0E7SUFDSkEseUNBQVNBLEdBQWhCQSxVQUFpQkEsRUFBU0EsRUFBRUEsRUFBU0EsRUFBRUEsRUFBU0E7UUFFL0NRLElBQUlBLENBQUNBLEdBQVlBLElBQUlBLFFBQVFBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLEVBQUVBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBO1FBRWhEQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxFQUFFQSxDQUFDQTtRQUNWQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxFQUFFQSxDQUFDQTtRQUVWQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLGVBQWVBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1FBRS9DQSxBQUNBQSw4QkFEOEJBO1FBQzlCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQTtRQUVUQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNWQSxDQUFDQTtJQUVEUixXQUFXQTtJQUNKQSxxQ0FBS0EsR0FBWkE7UUFFQ1MsSUFBSUEsS0FBS0EsR0FBeUJBLElBQUlBLHFCQUFxQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0E7UUFDL0VBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBO1FBQzNCQSxLQUFLQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQTtRQUN6QkEsS0FBS0EsQ0FBQ0EsYUFBYUEsR0FBR0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0E7UUFDekNBLEtBQUtBLENBQUNBLGtCQUFrQkEsR0FBR0EsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQTtRQUNuREEsTUFBTUEsQ0FBQ0EsS0FBS0EsQ0FBQ0E7SUFDZEEsQ0FBQ0E7SUFFRFQsV0FBV0E7SUFDSkEsNkNBQWFBLEdBQXBCQTtRQUVDVSxJQUFJQSxHQUFHQSxHQUFZQSxFQUFFQSxDQUFDQTtRQUV0QkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUMvQkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQTtnQkFDN0JBLElBQUlBLENBQUNBLGFBQWFBLEdBQUdBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBO1lBRXhDQSxJQUFJQSxDQUFDQSxZQUFZQSxHQUFHQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxHQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxNQUFNQSxHQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxHQUFDQSxHQUFHQSxHQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQTtZQUMzRkEsSUFBSUEsQ0FBQ0EsYUFBYUEsR0FBR0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsS0FBS0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsR0FBQ0EsR0FBR0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7UUFDN0ZBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ1BBLElBQUlBLENBQUNBLFlBQVlBLEdBQUdBLEdBQUdBLEdBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLE1BQU1BLEdBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLFlBQVlBLEdBQUNBLElBQUlBLENBQUNBLEVBQUVBLEdBQUNBLEdBQUdBLENBQUNBLENBQUNBO1lBRTFGQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBO2dCQUM3QkEsSUFBSUEsQ0FBQ0EsYUFBYUEsR0FBR0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0E7WUFDeENBLElBQUlBO2dCQUNIQSxJQUFJQSxDQUFDQSxhQUFhQSxHQUFHQSxHQUFHQSxHQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxLQUFLQSxHQUFDQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxHQUFDQSxJQUFJQSxDQUFDQSxFQUFFQSxHQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtRQUM3RkEsQ0FBQ0E7UUFFREEsSUFBSUEsT0FBT0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsU0FBU0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0E7UUFDakRBLElBQUlBLE9BQU9BLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLEdBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBO1FBQ3REQSxJQUFJQSxPQUFPQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxHQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQTtRQUNoREEsSUFBSUEsT0FBT0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0E7UUFFckRBLElBQUlBLElBQVdBLENBQUNBO1FBQ2hCQSxJQUFJQSxLQUFZQSxDQUFDQTtRQUNqQkEsSUFBSUEsR0FBVUEsQ0FBQ0E7UUFDZkEsSUFBSUEsTUFBYUEsQ0FBQ0E7UUFFbEJBLEFBQ0FBLDJCQUQyQkE7WUFDdkJBLE1BQU1BLEdBQVVBLENBQUNBLENBQUNBLENBQUNBLE9BQU9BLEdBQUdBLE9BQU9BLENBQUNBLEdBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLENBQUNBLEdBQUdBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBO1FBQ25HQSxJQUFJQSxNQUFNQSxHQUFVQSxDQUFDQSxDQUFDQSxPQUFPQSxHQUFHQSxPQUFPQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxDQUFDQSxHQUFHQSxPQUFPQSxHQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtRQUVuR0EsSUFBSUEsR0FBR0EsTUFBTUEsR0FBR0EsQ0FBQ0EsT0FBT0EsR0FBR0EsT0FBT0EsQ0FBQ0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsS0FBS0EsQ0FBQ0E7UUFDMURBLEtBQUtBLEdBQUdBLE1BQU1BLENBQUNBO1FBQ2ZBLEdBQUdBLEdBQUdBLE1BQU1BLENBQUNBO1FBQ2JBLE1BQU1BLEdBQUdBLE1BQU1BLEdBQUdBLENBQUNBLE9BQU9BLEdBQUdBLE9BQU9BLENBQUNBLEdBQUNBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLE1BQU1BLENBQUNBO1FBRTdEQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFDQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUMxQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsTUFBTUEsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDMUJBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEtBQUtBLEdBQUdBLElBQUlBLENBQUNBLEdBQUNBLENBQUNBLEtBQUtBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBO1FBQ3ZDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxNQUFNQSxHQUFHQSxHQUFHQSxDQUFDQSxHQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxHQUFHQSxDQUFDQSxDQUFDQTtRQUN2Q0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7UUFDaEVBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ1pBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ3RGQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtRQUUvREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxJQUFJQSxnQkFBZ0JBLENBQUNBLFlBQVlBLENBQUNBO1lBQzVEQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUVsQkEsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFFbkNBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFDQSxJQUFJQSxDQUFDQTtRQUN2RUEsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLEdBQUNBLEtBQUtBLENBQUNBO1FBQ3hFQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBQ0EsR0FBR0EsQ0FBQ0E7UUFDdEVBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFDQSxNQUFNQSxDQUFDQTtRQUUxRUEsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLEtBQUtBLEdBQUNBLElBQUlBLENBQUNBO1FBQ3hFQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBQ0EsS0FBS0EsQ0FBQ0E7UUFDekVBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFDQSxHQUFHQSxDQUFDQTtRQUN2RUEsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLEtBQUtBLEdBQUNBLE1BQU1BLENBQUNBO1FBRTFFQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBO1FBQ3pIQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBO1FBRTNIQSxJQUFJQSxDQUFDQSxlQUFlQSxHQUFHQSxLQUFLQSxDQUFDQTtJQUc5QkEsQ0FBQ0E7SUFDRlYsNEJBQUNBO0FBQURBLENBaE9BLEFBZ09DQSxFQWhPbUMsY0FBYyxFQWdPakQ7QUFFRCxBQUErQixpQkFBdEIscUJBQXFCLENBQUMiLCJmaWxlIjoicHJvamVjdGlvbnMvUGVyc3BlY3RpdmVQcm9qZWN0aW9uLmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBWZWN0b3IzRFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9WZWN0b3IzRFwiKTtcclxuaW1wb3J0IENvb3JkaW5hdGVTeXN0ZW1cdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvcHJvamVjdGlvbnMvQ29vcmRpbmF0ZVN5c3RlbVwiKTtcclxuaW1wb3J0IFByb2plY3Rpb25CYXNlXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3Byb2plY3Rpb25zL1Byb2plY3Rpb25CYXNlXCIpO1xyXG5cclxuY2xhc3MgUGVyc3BlY3RpdmVQcm9qZWN0aW9uIGV4dGVuZHMgUHJvamVjdGlvbkJhc2Vcclxue1xyXG5cdHByaXZhdGUgX2ZpZWxkT2ZWaWV3Om51bWJlciA9IDYwO1xyXG5cdHByaXZhdGUgX2ZvY2FsTGVuZ3RoOm51bWJlciA9IDEwMDA7XHJcblx0cHJpdmF0ZSBfaEZpZWxkT2ZWaWV3Om51bWJlciA9IDYwO1xyXG5cdHByaXZhdGUgX2hGb2NhbExlbmd0aDpudW1iZXIgPSAxMDAwO1xyXG5cdHByaXZhdGUgX3ByZXNlcnZlQXNwZWN0UmF0aW86Ym9vbGVhbiA9IHRydWU7XHJcblx0cHJpdmF0ZSBfcHJlc2VydmVGb2NhbExlbmd0aDpib29sZWFuID0gZmFsc2U7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGZpZWxkT2ZWaWV3Om51bWJlciA9IDYwLCBjb29yZGluYXRlU3lzdGVtOnN0cmluZyA9IFwibGVmdEhhbmRlZFwiKVxyXG5cdHtcclxuXHRcdHN1cGVyKGNvb3JkaW5hdGVTeXN0ZW0pO1xyXG5cdFx0dGhpcy5maWVsZE9mVmlldyA9IGZpZWxkT2ZWaWV3O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKi9cclxuXHRwdWJsaWMgZ2V0IHByZXNlcnZlQXNwZWN0UmF0aW8oKTpib29sZWFuXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX3ByZXNlcnZlQXNwZWN0UmF0aW87XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IHByZXNlcnZlQXNwZWN0UmF0aW8odmFsdWU6Ym9vbGVhbilcclxuXHR7XHJcblx0XHRpZiAodGhpcy5fcHJlc2VydmVBc3BlY3RSYXRpbyA9PSB2YWx1ZSlcclxuXHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdHRoaXMuX3ByZXNlcnZlQXNwZWN0UmF0aW8gPSB2YWx1ZTtcclxuXHJcblx0XHRpZiAodGhpcy5fcHJlc2VydmVBc3BlY3RSYXRpbylcclxuXHRcdFx0dGhpcy5wSW52YWxpZGF0ZU1hdHJpeCgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKi9cclxuXHRwdWJsaWMgZ2V0IHByZXNlcnZlRm9jYWxMZW5ndGgoKTpib29sZWFuXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX3ByZXNlcnZlRm9jYWxMZW5ndGg7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IHByZXNlcnZlRm9jYWxMZW5ndGgodmFsdWU6Ym9vbGVhbilcclxuXHR7XHJcblx0XHRpZiAodGhpcy5fcHJlc2VydmVGb2NhbExlbmd0aCA9PSB2YWx1ZSlcclxuXHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdHRoaXMuX3ByZXNlcnZlRm9jYWxMZW5ndGggPSB2YWx1ZTtcclxuXHJcblx0XHR0aGlzLnBJbnZhbGlkYXRlTWF0cml4KCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXQgZmllbGRPZlZpZXcoKTpudW1iZXJcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fZmllbGRPZlZpZXc7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IGZpZWxkT2ZWaWV3KHZhbHVlOm51bWJlcilcclxuXHR7XHJcblx0XHRpZiAodGhpcy5fZmllbGRPZlZpZXcgPT0gdmFsdWUpXHJcblx0XHRcdHJldHVybjtcclxuXHJcblx0XHR0aGlzLl9maWVsZE9mVmlldyA9IHZhbHVlO1xyXG5cclxuXHRcdHRoaXMucEludmFsaWRhdGVNYXRyaXgoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqXHJcblx0ICovXHJcblx0cHVibGljIGdldCBmb2NhbExlbmd0aCgpOm51bWJlclxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9mb2NhbExlbmd0aDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgZm9jYWxMZW5ndGgodmFsdWU6bnVtYmVyKVxyXG5cdHtcclxuXHRcdGlmICh0aGlzLl9mb2NhbExlbmd0aCA9PSB2YWx1ZSlcclxuXHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdHRoaXMuX2ZvY2FsTGVuZ3RoID0gdmFsdWU7XHJcblxyXG5cdFx0dGhpcy5wSW52YWxpZGF0ZU1hdHJpeCgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKi9cclxuXHRwdWJsaWMgZ2V0IGhGaWVsZE9mVmlldygpOm51bWJlclxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9oRmllbGRPZlZpZXc7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IGhGaWVsZE9mVmlldyh2YWx1ZTpudW1iZXIpXHJcblx0e1xyXG5cdFx0aWYgKHRoaXMuX2hGaWVsZE9mVmlldyA9PSB2YWx1ZSlcclxuXHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdHRoaXMuX2hGaWVsZE9mVmlldyA9IHZhbHVlO1xyXG5cclxuXHRcdHRoaXMuX2hGb2NhbExlbmd0aCA9IDEvTWF0aC50YW4odGhpcy5faEZpZWxkT2ZWaWV3Kk1hdGguUEkvMzYwKTtcclxuXHJcblx0XHR0aGlzLnBJbnZhbGlkYXRlTWF0cml4KCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXQgaEZvY2FsTGVuZ3RoKCk6bnVtYmVyXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX2hGb2NhbExlbmd0aDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgaEZvY2FsTGVuZ3RoKHZhbHVlOm51bWJlcilcclxuXHR7XHJcblx0XHRpZiAodGhpcy5faEZvY2FsTGVuZ3RoID09IHZhbHVlKVxyXG5cdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0dGhpcy5faEZvY2FsTGVuZ3RoID0gdmFsdWU7XHJcblxyXG5cdFx0dGhpcy5wSW52YWxpZGF0ZU1hdHJpeCgpO1xyXG5cdH1cclxuXHJcblxyXG5cdC8vQG92ZXJyaWRlXHJcblx0cHVibGljIHVucHJvamVjdChuWDpudW1iZXIsIG5ZOm51bWJlciwgc1o6bnVtYmVyKTpWZWN0b3IzRFxyXG5cdHtcclxuXHRcdHZhciB2OlZlY3RvcjNEID0gbmV3IFZlY3RvcjNEKG5YLCAtblksIHNaLCAxLjApO1xyXG5cclxuXHRcdHYueCAqPSBzWjtcclxuXHRcdHYueSAqPSBzWjtcclxuXHJcblx0XHR2ID0gdGhpcy51bnByb2plY3Rpb25NYXRyaXgudHJhbnNmb3JtVmVjdG9yKHYpO1xyXG5cclxuXHRcdC8veiBpcyB1bmFmZmVjdGVkIGJ5IHRyYW5zZm9ybVxyXG5cdFx0di56ID0gc1o7XHJcblxyXG5cdFx0cmV0dXJuIHY7XHJcblx0fVxyXG5cclxuXHQvL0BvdmVycmlkZVxyXG5cdHB1YmxpYyBjbG9uZSgpOlByb2plY3Rpb25CYXNlXHJcblx0e1xyXG5cdFx0dmFyIGNsb25lOlBlcnNwZWN0aXZlUHJvamVjdGlvbiA9IG5ldyBQZXJzcGVjdGl2ZVByb2plY3Rpb24odGhpcy5fZmllbGRPZlZpZXcpO1xyXG5cdFx0Y2xvbmUuX3BOZWFyID0gdGhpcy5fcE5lYXI7XHJcblx0XHRjbG9uZS5fcEZhciA9IHRoaXMuX3BGYXI7XHJcblx0XHRjbG9uZS5fcEFzcGVjdFJhdGlvID0gdGhpcy5fcEFzcGVjdFJhdGlvO1xyXG5cdFx0Y2xvbmUuX3BDb29yZGluYXRlU3lzdGVtID0gdGhpcy5fcENvb3JkaW5hdGVTeXN0ZW07XHJcblx0XHRyZXR1cm4gY2xvbmU7XHJcblx0fVxyXG5cclxuXHQvL0BvdmVycmlkZVxyXG5cdHB1YmxpYyBwVXBkYXRlTWF0cml4KClcclxuXHR7XHJcblx0XHR2YXIgcmF3Om51bWJlcltdID0gW107XHJcblxyXG5cdFx0aWYgKHRoaXMuX3ByZXNlcnZlRm9jYWxMZW5ndGgpIHtcclxuXHRcdFx0aWYgKHRoaXMuX3ByZXNlcnZlQXNwZWN0UmF0aW8pXHJcblx0XHRcdFx0dGhpcy5faEZvY2FsTGVuZ3RoID0gdGhpcy5fZm9jYWxMZW5ndGg7XHJcblxyXG5cdFx0XHR0aGlzLl9maWVsZE9mVmlldyA9IE1hdGguYXRhbigwLjUqdGhpcy5fcFNjaXNzb3JSZWN0LmhlaWdodC90aGlzLl9mb2NhbExlbmd0aCkqMzYwL01hdGguUEk7XHJcblx0XHRcdHRoaXMuX2hGaWVsZE9mVmlldyA9IE1hdGguYXRhbigwLjUqdGhpcy5fcFNjaXNzb3JSZWN0LndpZHRoL3RoaXMuX2hGb2NhbExlbmd0aCkqMzYwL01hdGguUEk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLl9mb2NhbExlbmd0aCA9IDAuNSp0aGlzLl9wU2Npc3NvclJlY3QuaGVpZ2h0L01hdGgudGFuKHRoaXMuX2ZpZWxkT2ZWaWV3Kk1hdGguUEkvMzYwKTtcclxuXHJcblx0XHRcdGlmICh0aGlzLl9wcmVzZXJ2ZUFzcGVjdFJhdGlvKVxyXG5cdFx0XHRcdHRoaXMuX2hGb2NhbExlbmd0aCA9IHRoaXMuX2ZvY2FsTGVuZ3RoO1xyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0dGhpcy5faEZvY2FsTGVuZ3RoID0gMC41KnRoaXMuX3BTY2lzc29yUmVjdC53aWR0aC9NYXRoLnRhbih0aGlzLl9oRmllbGRPZlZpZXcqTWF0aC5QSS8zNjApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciB0YW5NaW5YID0gLXRoaXMuX3BPcmlnaW5YL3RoaXMuX2hGb2NhbExlbmd0aDtcclxuXHRcdHZhciB0YW5NYXhYID0gKDEgLSB0aGlzLl9wT3JpZ2luWCkvdGhpcy5faEZvY2FsTGVuZ3RoO1xyXG5cdFx0dmFyIHRhbk1pblkgPSAtdGhpcy5fcE9yaWdpblkvdGhpcy5fZm9jYWxMZW5ndGg7XHJcblx0XHR2YXIgdGFuTWF4WSA9ICgxIC0gdGhpcy5fcE9yaWdpblkpL3RoaXMuX2ZvY2FsTGVuZ3RoO1xyXG5cclxuXHRcdHZhciBsZWZ0Om51bWJlcjtcclxuXHRcdHZhciByaWdodDpudW1iZXI7XHJcblx0XHR2YXIgdG9wOm51bWJlcjtcclxuXHRcdHZhciBib3R0b206bnVtYmVyO1xyXG5cclxuXHRcdC8vIGFzc3VtZSBzY2lzc29yZWQgZnJ1c3R1bVxyXG5cdFx0dmFyIGNlbnRlcjpudW1iZXIgPSAtKCh0YW5NaW5YIC0gdGFuTWF4WCkqdGhpcy5fcFNjaXNzb3JSZWN0LnggKyB0YW5NaW5YKnRoaXMuX3BTY2lzc29yUmVjdC53aWR0aCk7XHJcblx0XHR2YXIgbWlkZGxlOm51bWJlciA9ICgodGFuTWluWSAtIHRhbk1heFkpKnRoaXMuX3BTY2lzc29yUmVjdC55ICsgdGFuTWluWSp0aGlzLl9wU2Npc3NvclJlY3QuaGVpZ2h0KTtcclxuXHJcblx0XHRsZWZ0ID0gY2VudGVyIC0gKHRhbk1heFggLSB0YW5NaW5YKSp0aGlzLl9wVmlld1BvcnQud2lkdGg7XHJcblx0XHRyaWdodCA9IGNlbnRlcjtcclxuXHRcdHRvcCA9IG1pZGRsZTtcclxuXHRcdGJvdHRvbSA9IG1pZGRsZSArICh0YW5NYXhZIC0gdGFuTWluWSkqdGhpcy5fcFZpZXdQb3J0LmhlaWdodDtcclxuXHJcblx0XHRyYXdbMF0gPSAyLyhyaWdodCAtIGxlZnQpO1xyXG5cdFx0cmF3WzVdID0gMi8oYm90dG9tIC0gdG9wKTtcclxuXHRcdHJhd1s4XSA9IChyaWdodCArIGxlZnQpLyhyaWdodCAtIGxlZnQpO1xyXG5cdFx0cmF3WzldID0gKGJvdHRvbSArIHRvcCkvKGJvdHRvbSAtIHRvcCk7XHJcblx0XHRyYXdbMTBdID0gKHRoaXMuX3BGYXIgKyB0aGlzLl9wTmVhcikvKHRoaXMuX3BGYXIgLSB0aGlzLl9wTmVhcik7XHJcblx0XHRyYXdbMTFdID0gMTtcclxuXHRcdHJhd1sxXSA9IHJhd1syXSA9IHJhd1szXSA9IHJhd1s0XSA9IHJhd1s2XSA9IHJhd1s3XSA9IHJhd1sxMl0gPSByYXdbMTNdID0gcmF3WzE1XSA9IDA7XHJcblx0XHRyYXdbMTRdID0gLTIqdGhpcy5fcEZhcip0aGlzLl9wTmVhci8odGhpcy5fcEZhciAtIHRoaXMuX3BOZWFyKTtcclxuXHJcblx0XHRpZiAodGhpcy5fcENvb3JkaW5hdGVTeXN0ZW0gPT0gQ29vcmRpbmF0ZVN5c3RlbS5SSUdIVF9IQU5ERUQpXHJcblx0XHRcdHJhd1s1XSA9IC1yYXdbNV07XHJcblxyXG5cdFx0dGhpcy5fcE1hdHJpeC5jb3B5UmF3RGF0YUZyb20ocmF3KTtcclxuXHJcblx0XHR0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMF0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbOV0gPSB0aGlzLl9wTmVhcipsZWZ0O1xyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzNdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzZdID0gdGhpcy5fcE5lYXIqcmlnaHQ7XHJcblx0XHR0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMV0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbNF0gPSB0aGlzLl9wTmVhcip0b3A7XHJcblx0XHR0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbN10gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMTBdID0gdGhpcy5fcE5lYXIqYm90dG9tO1xyXG5cclxuXHRcdHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxMl0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMjFdID0gdGhpcy5fcEZhcipsZWZ0O1xyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzE1XSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxOF0gPSB0aGlzLl9wRmFyKnJpZ2h0O1xyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzEzXSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxNl0gPSB0aGlzLl9wRmFyKnRvcDtcclxuXHRcdHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxOV0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMjJdID0gdGhpcy5fcEZhcipib3R0b207XHJcblxyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzJdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzVdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzhdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzExXSA9IHRoaXMuX3BOZWFyO1xyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzE0XSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxN10gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMjBdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzIzXSA9IHRoaXMuX3BGYXI7XHJcblxyXG5cdFx0dGhpcy5fcE1hdHJpeEludmFsaWQgPSBmYWxzZTtcclxuXHJcblxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0ID0gUGVyc3BlY3RpdmVQcm9qZWN0aW9uOyJdfQ==