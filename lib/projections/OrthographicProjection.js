var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var Vector3D = require("awayjs-core/lib/geom/Vector3D");
var ProjectionBase = require("awayjs-core/lib/projections/ProjectionBase");
var OrthographicProjection = (function (_super) {
    __extends(OrthographicProjection, _super);
    function OrthographicProjection(projectionHeight) {
        if (projectionHeight === void 0) { projectionHeight = 500; }
        _super.call(this);
        this._projectionHeight = projectionHeight;
    }
    Object.defineProperty(OrthographicProjection.prototype, "projectionHeight", {
        get: function () {
            return this._projectionHeight;
        },
        set: function (value) {
            if (value == this._projectionHeight) {
                return;
            }
            this._projectionHeight = value;
            this.pInvalidateMatrix();
        },
        enumerable: true,
        configurable: true
    });
    //@override
    OrthographicProjection.prototype.unproject = function (nX, nY, sZ) {
        var v = new Vector3D(nX + this.matrix.rawData[12], -nY + this.matrix.rawData[13], sZ, 1.0);
        v = this.unprojectionMatrix.transformVector(v);
        //z is unaffected by transform
        v.z = sZ;
        return v;
    };
    //@override
    OrthographicProjection.prototype.clone = function () {
        var clone = new OrthographicProjection();
        clone._pNear = this._pNear;
        clone._pFar = this._pFar;
        clone._pAspectRatio = this._pAspectRatio;
        clone.projectionHeight = this._projectionHeight;
        return clone;
    };
    //@override
    OrthographicProjection.prototype.pUpdateMatrix = function () {
        var raw = [];
        this._yMax = this._projectionHeight * .5;
        this._xMax = this._yMax * this._pAspectRatio;
        var left;
        var right;
        var top;
        var bottom;
        if (this._pScissorRect.x == 0 && this._pScissorRect.y == 0 && this._pScissorRect.width == this._pViewPort.width && this._pScissorRect.height == this._pViewPort.height) {
            // assume symmetric frustum
            left = -this._xMax;
            right = this._xMax;
            top = -this._yMax;
            bottom = this._yMax;
            raw[0] = 2 / (this._projectionHeight * this._pAspectRatio);
            raw[5] = 2 / this._projectionHeight;
            raw[10] = 1 / (this._pFar - this._pNear);
            raw[14] = this._pNear / (this._pNear - this._pFar);
            raw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[8] = raw[9] = raw[11] = raw[12] = raw[13] = 0;
            raw[15] = 1;
        }
        else {
            var xWidth = this._xMax * (this._pViewPort.width / this._pScissorRect.width);
            var yHgt = this._yMax * (this._pViewPort.height / this._pScissorRect.height);
            var center = this._xMax * (this._pScissorRect.x * 2 - this._pViewPort.width) / this._pScissorRect.width + this._xMax;
            var middle = -this._yMax * (this._pScissorRect.y * 2 - this._pViewPort.height) / this._pScissorRect.height - this._yMax;
            left = center - xWidth;
            right = center + xWidth;
            top = middle - yHgt;
            bottom = middle + yHgt;
            raw[0] = 2 * 1 / (right - left);
            raw[5] = -2 * 1 / (top - bottom);
            raw[10] = 1 / (this._pFar - this._pNear);
            raw[12] = (right + left) / (right - left);
            raw[13] = (bottom + top) / (bottom - top);
            raw[14] = this._pNear / (this.near - this.far);
            raw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[8] = raw[9] = raw[11] = 0;
            raw[15] = 1;
        }
        this._pFrustumCorners[0] = this._pFrustumCorners[9] = this._pFrustumCorners[12] = this._pFrustumCorners[21] = left;
        this._pFrustumCorners[3] = this._pFrustumCorners[6] = this._pFrustumCorners[15] = this._pFrustumCorners[18] = right;
        this._pFrustumCorners[1] = this._pFrustumCorners[4] = this._pFrustumCorners[13] = this._pFrustumCorners[16] = top;
        this._pFrustumCorners[7] = this._pFrustumCorners[10] = this._pFrustumCorners[19] = this._pFrustumCorners[22] = bottom;
        this._pFrustumCorners[2] = this._pFrustumCorners[5] = this._pFrustumCorners[8] = this._pFrustumCorners[11] = this._pNear;
        this._pFrustumCorners[14] = this._pFrustumCorners[17] = this._pFrustumCorners[20] = this._pFrustumCorners[23] = this._pFar;
        this._pMatrix.copyRawDataFrom(raw);
        this._pMatrixInvalid = false;
    };
    return OrthographicProjection;
})(ProjectionBase);
module.exports = OrthographicProjection;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1jb3JlL2xpYi9wcm9qZWN0aW9ucy9vcnRob2dyYXBoaWNwcm9qZWN0aW9uLnRzIl0sIm5hbWVzIjpbIk9ydGhvZ3JhcGhpY1Byb2plY3Rpb24iLCJPcnRob2dyYXBoaWNQcm9qZWN0aW9uLmNvbnN0cnVjdG9yIiwiT3J0aG9ncmFwaGljUHJvamVjdGlvbi5wcm9qZWN0aW9uSGVpZ2h0IiwiT3J0aG9ncmFwaGljUHJvamVjdGlvbi51bnByb2plY3QiLCJPcnRob2dyYXBoaWNQcm9qZWN0aW9uLmNsb25lIiwiT3J0aG9ncmFwaGljUHJvamVjdGlvbi5wVXBkYXRlTWF0cml4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFPLFFBQVEsV0FBZSwrQkFBK0IsQ0FBQyxDQUFDO0FBQy9ELElBQU8sY0FBYyxXQUFhLDRDQUE0QyxDQUFDLENBQUM7QUFFaEYsSUFBTSxzQkFBc0I7SUFBU0EsVUFBL0JBLHNCQUFzQkEsVUFBdUJBO0lBT2xEQSxTQVBLQSxzQkFBc0JBLENBT2ZBLGdCQUE2QkE7UUFBN0JDLGdDQUE2QkEsR0FBN0JBLHNCQUE2QkE7UUFFeENBLGlCQUFPQSxDQUFDQTtRQUNSQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEdBQUdBLGdCQUFnQkEsQ0FBQ0E7SUFDM0NBLENBQUNBO0lBRURELHNCQUFXQSxvREFBZ0JBO2FBQTNCQTtZQUVDRSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxpQkFBaUJBLENBQUNBO1FBQy9CQSxDQUFDQTthQUVERixVQUE0QkEsS0FBWUE7WUFFdkNFLEVBQUVBLENBQUNBLENBQUNBLEtBQUtBLElBQUlBLElBQUlBLENBQUNBLGlCQUFpQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3JDQSxNQUFNQSxDQUFDQTtZQUNSQSxDQUFDQTtZQUNEQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEdBQUdBLEtBQUtBLENBQUNBO1lBQy9CQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEVBQUVBLENBQUNBO1FBQzFCQSxDQUFDQTs7O09BVEFGO0lB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QUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO1lBQ3ZDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQTtZQUNqREEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDeEdBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBRWJBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBRVBBLElBQUlBLE1BQU1BLEdBQVVBLElBQUlBLENBQUNBLEtBQUtBLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLEtBQUtBLEdBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBO1lBQ2hGQSxJQUFJQSxJQUFJQSxHQUFVQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxDQUFDQSxNQUFNQSxHQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtZQUNoRkEsSUFBSUEsTUFBTUEsR0FBVUEsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0E7WUFDdEhBLElBQUlBLE1BQU1BLEdBQVVBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLE1BQU1BLENBQUNBLEdBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBO1lBRXpIQSxJQUFJQSxHQUFHQSxNQUFNQSxHQUFHQSxNQUFNQSxDQUFDQTtZQUN2QkEsS0FBS0EsR0FBR0EsTUFBTUEsR0FBR0EsTUFBTUEsQ0FBQ0E7WUFDeEJBLEdBQUdBLEdBQUdBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBO1lBQ3BCQSxNQUFNQSxHQUFHQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUV2QkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDNUJBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLEdBQUdBLE1BQU1BLENBQUNBLENBQUNBO1lBQzdCQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtZQUV2Q0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDeENBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLEdBQUdBLEdBQUdBLENBQUNBLEdBQUNBLENBQUNBLE1BQU1BLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBO1lBQ3hDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUU3Q0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDcEZBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ2JBLENBQUNBO1FBRURBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDbkhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsS0FBS0EsQ0FBQ0E7UUFDcEhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0E7UUFDbEhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsTUFBTUEsQ0FBQ0E7UUFDdEhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0E7UUFDekhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0E7UUFFM0hBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLGVBQWVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBRW5DQSxJQUFJQSxDQUFDQSxlQUFlQSxHQUFHQSxLQUFLQSxDQUFDQTtJQUM5QkEsQ0FBQ0E7SUFDRkwsNkJBQUNBO0FBQURBLENBaEhBLEFBZ0hDQSxFQWhIb0MsY0FBYyxFQWdIbEQ7QUFFRCxBQUErQixpQkFBdkIsc0JBQXNCLENBQUMiLCJmaWxlIjoicHJvamVjdGlvbnMvT3J0aG9ncmFwaGljUHJvamVjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVmVjdG9yM0RcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vVmVjdG9yM0RcIik7XG5pbXBvcnQgUHJvamVjdGlvbkJhc2VcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvcHJvamVjdGlvbnMvUHJvamVjdGlvbkJhc2VcIik7XG5cbmNsYXNzIE9ydGhvZ3JhcGhpY1Byb2plY3Rpb24gZXh0ZW5kcyBQcm9qZWN0aW9uQmFzZVxue1xuXG5cdHByaXZhdGUgX3Byb2plY3Rpb25IZWlnaHQ6bnVtYmVyO1xuXHRwcml2YXRlIF94TWF4Om51bWJlcjtcblx0cHJpdmF0ZSBfeU1heDpudW1iZXI7XG5cblx0Y29uc3RydWN0b3IocHJvamVjdGlvbkhlaWdodDpudW1iZXIgPSA1MDApXG5cdHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMuX3Byb2plY3Rpb25IZWlnaHQgPSBwcm9qZWN0aW9uSGVpZ2h0O1xuXHR9XG5cblx0cHVibGljIGdldCBwcm9qZWN0aW9uSGVpZ2h0KCk6bnVtYmVyXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fcHJvamVjdGlvbkhlaWdodDtcblx0fVxuXG5cdHB1YmxpYyBzZXQgcHJvamVjdGlvbkhlaWdodCh2YWx1ZTpudW1iZXIpXG5cdHtcblx0XHRpZiAodmFsdWUgPT0gdGhpcy5fcHJvamVjdGlvbkhlaWdodCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLl9wcm9qZWN0aW9uSGVpZ2h0ID0gdmFsdWU7XG5cdFx0dGhpcy5wSW52YWxpZGF0ZU1hdHJpeCgpO1xuXHR9XG5cblx0Ly9Ab3ZlcnJpZGVcblx0cHVibGljIHVucHJvamVjdChuWDpudW1iZXIsIG5ZOm51bWJlciwgc1o6bnVtYmVyKTpWZWN0b3IzRFxuXHR7XG5cdFx0dmFyIHY6VmVjdG9yM0QgPSBuZXcgVmVjdG9yM0QoblggKyB0aGlzLm1hdHJpeC5yYXdEYXRhWzEyXSwgLW5ZICsgdGhpcy5tYXRyaXgucmF3RGF0YVsxM10sIHNaLCAxLjApO1xuXHRcdHYgPSB0aGlzLnVucHJvamVjdGlvbk1hdHJpeC50cmFuc2Zvcm1WZWN0b3Iodik7XG5cblx0XHQvL3ogaXMgdW5hZmZlY3RlZCBieSB0cmFuc2Zvcm1cblx0XHR2LnogPSBzWjtcblxuXHRcdHJldHVybiB2O1xuXHR9XG5cblx0Ly9Ab3ZlcnJpZGVcblx0cHVibGljIGNsb25lKCk6UHJvamVjdGlvbkJhc2Vcblx0e1xuXHRcdHZhciBjbG9uZTpPcnRob2dyYXBoaWNQcm9qZWN0aW9uID0gbmV3IE9ydGhvZ3JhcGhpY1Byb2plY3Rpb24oKTtcblx0XHRjbG9uZS5fcE5lYXIgPSB0aGlzLl9wTmVhcjtcblx0XHRjbG9uZS5fcEZhciA9IHRoaXMuX3BGYXI7XG5cdFx0Y2xvbmUuX3BBc3BlY3RSYXRpbyA9IHRoaXMuX3BBc3BlY3RSYXRpbztcblx0XHRjbG9uZS5wcm9qZWN0aW9uSGVpZ2h0ID0gdGhpcy5fcHJvamVjdGlvbkhlaWdodDtcblx0XHRyZXR1cm4gY2xvbmU7XG5cdH1cblxuXHQvL0BvdmVycmlkZVxuXHRwdWJsaWMgcFVwZGF0ZU1hdHJpeCgpXG5cdHtcblx0XHR2YXIgcmF3Om51bWJlcltdID0gW107XG5cdFx0dGhpcy5feU1heCA9IHRoaXMuX3Byb2plY3Rpb25IZWlnaHQqLjU7XG5cdFx0dGhpcy5feE1heCA9IHRoaXMuX3lNYXgqdGhpcy5fcEFzcGVjdFJhdGlvO1xuXG5cdFx0dmFyIGxlZnQ6bnVtYmVyO1xuXHRcdHZhciByaWdodDpudW1iZXI7XG5cdFx0dmFyIHRvcDpudW1iZXI7XG5cdFx0dmFyIGJvdHRvbTpudW1iZXI7XG5cblx0XHRpZiAodGhpcy5fcFNjaXNzb3JSZWN0LnggPT0gMCAmJiB0aGlzLl9wU2Npc3NvclJlY3QueSA9PSAwICYmIHRoaXMuX3BTY2lzc29yUmVjdC53aWR0aCA9PSB0aGlzLl9wVmlld1BvcnQud2lkdGggJiYgdGhpcy5fcFNjaXNzb3JSZWN0LmhlaWdodCA9PSB0aGlzLl9wVmlld1BvcnQuaGVpZ2h0KSB7XG5cdFx0XHQvLyBhc3N1bWUgc3ltbWV0cmljIGZydXN0dW1cblxuXHRcdFx0bGVmdCA9IC10aGlzLl94TWF4O1xuXHRcdFx0cmlnaHQgPSB0aGlzLl94TWF4O1xuXHRcdFx0dG9wID0gLXRoaXMuX3lNYXg7XG5cdFx0XHRib3R0b20gPSB0aGlzLl95TWF4O1xuXG5cdFx0XHRyYXdbMF0gPSAyLyh0aGlzLl9wcm9qZWN0aW9uSGVpZ2h0KnRoaXMuX3BBc3BlY3RSYXRpbyk7XG5cdFx0XHRyYXdbNV0gPSAyL3RoaXMuX3Byb2plY3Rpb25IZWlnaHQ7XG5cdFx0XHRyYXdbMTBdID0gMS8odGhpcy5fcEZhciAtIHRoaXMuX3BOZWFyKTtcblx0XHRcdHJhd1sxNF0gPSB0aGlzLl9wTmVhci8odGhpcy5fcE5lYXIgLSB0aGlzLl9wRmFyKTtcblx0XHRcdHJhd1sxXSA9IHJhd1syXSA9IHJhd1szXSA9IHJhd1s0XSA9IHJhd1s2XSA9IHJhd1s3XSA9IHJhd1s4XSA9IHJhd1s5XSA9IHJhd1sxMV0gPSByYXdbMTJdID0gcmF3WzEzXSA9IDA7XG5cdFx0XHRyYXdbMTVdID0gMTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHZhciB4V2lkdGg6bnVtYmVyID0gdGhpcy5feE1heCoodGhpcy5fcFZpZXdQb3J0LndpZHRoL3RoaXMuX3BTY2lzc29yUmVjdC53aWR0aCk7XG5cdFx0XHR2YXIgeUhndDpudW1iZXIgPSB0aGlzLl95TWF4Kih0aGlzLl9wVmlld1BvcnQuaGVpZ2h0L3RoaXMuX3BTY2lzc29yUmVjdC5oZWlnaHQpO1xuXHRcdFx0dmFyIGNlbnRlcjpudW1iZXIgPSB0aGlzLl94TWF4Kih0aGlzLl9wU2Npc3NvclJlY3QueCoyIC0gdGhpcy5fcFZpZXdQb3J0LndpZHRoKS90aGlzLl9wU2Npc3NvclJlY3Qud2lkdGggKyB0aGlzLl94TWF4O1xuXHRcdFx0dmFyIG1pZGRsZTpudW1iZXIgPSAtdGhpcy5feU1heCoodGhpcy5fcFNjaXNzb3JSZWN0LnkqMiAtIHRoaXMuX3BWaWV3UG9ydC5oZWlnaHQpL3RoaXMuX3BTY2lzc29yUmVjdC5oZWlnaHQgLSB0aGlzLl95TWF4O1xuXG5cdFx0XHRsZWZ0ID0gY2VudGVyIC0geFdpZHRoO1xuXHRcdFx0cmlnaHQgPSBjZW50ZXIgKyB4V2lkdGg7XG5cdFx0XHR0b3AgPSBtaWRkbGUgLSB5SGd0O1xuXHRcdFx0Ym90dG9tID0gbWlkZGxlICsgeUhndDtcblxuXHRcdFx0cmF3WzBdID0gMioxLyhyaWdodCAtIGxlZnQpO1xuXHRcdFx0cmF3WzVdID0gLTIqMS8odG9wIC0gYm90dG9tKTtcblx0XHRcdHJhd1sxMF0gPSAxLyh0aGlzLl9wRmFyIC0gdGhpcy5fcE5lYXIpO1xuXG5cdFx0XHRyYXdbMTJdID0gKHJpZ2h0ICsgbGVmdCkvKHJpZ2h0IC0gbGVmdCk7XG5cdFx0XHRyYXdbMTNdID0gKGJvdHRvbSArIHRvcCkvKGJvdHRvbSAtIHRvcCk7XG5cdFx0XHRyYXdbMTRdID0gdGhpcy5fcE5lYXIvKHRoaXMubmVhciAtIHRoaXMuZmFyKTtcblxuXHRcdFx0cmF3WzFdID0gcmF3WzJdID0gcmF3WzNdID0gcmF3WzRdID0gcmF3WzZdID0gcmF3WzddID0gcmF3WzhdID0gcmF3WzldID0gcmF3WzExXSA9IDA7XG5cdFx0XHRyYXdbMTVdID0gMTtcblx0XHR9XG5cblx0XHR0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMF0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbOV0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMTJdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzIxXSA9IGxlZnQ7XG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzNdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzZdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzE1XSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxOF0gPSByaWdodDtcblx0XHR0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMV0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbNF0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMTNdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzE2XSA9IHRvcDtcblx0XHR0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbN10gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMTBdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzE5XSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1syMl0gPSBib3R0b207XG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzJdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzVdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzhdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzExXSA9IHRoaXMuX3BOZWFyO1xuXHRcdHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxNF0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMTddID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzIwXSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1syM10gPSB0aGlzLl9wRmFyO1xuXG5cdFx0dGhpcy5fcE1hdHJpeC5jb3B5UmF3RGF0YUZyb20ocmF3KTtcblxuXHRcdHRoaXMuX3BNYXRyaXhJbnZhbGlkID0gZmFsc2U7XG5cdH1cbn1cblxuZXhwb3J0PSBPcnRob2dyYXBoaWNQcm9qZWN0aW9uOyJdfQ==