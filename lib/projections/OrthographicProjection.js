var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var Vector3D = require("awayjs-core/lib/geom/Vector3D");
var ProjectionBase = require("awayjs-core/lib/projections/ProjectionBase");
var OrthographicProjection = (function (_super) {
    __extends(OrthographicProjection, _super);
    function OrthographicProjection(projectionHeight) {
        if (projectionHeight === void 0) { projectionHeight = 500; }
        _super.call(this);
        this._projectionHeight = projectionHeight;
    }
    Object.defineProperty(OrthographicProjection.prototype, "projectionHeight", {
        get: function () {
            return this._projectionHeight;
        },
        set: function (value) {
            if (value == this._projectionHeight) {
                return;
            }
            this._projectionHeight = value;
            this.pInvalidateMatrix();
        },
        enumerable: true,
        configurable: true
    });
    //@override
    OrthographicProjection.prototype.unproject = function (nX, nY, sZ) {
        var v = new Vector3D(nX + this.matrix.rawData[12], -nY + this.matrix.rawData[13], sZ, 1.0);
        v = this.unprojectionMatrix.transformVector(v);
        //z is unaffected by transform
        v.z = sZ;
        return v;
    };
    //@override
    OrthographicProjection.prototype.clone = function () {
        var clone = new OrthographicProjection();
        clone._pNear = this._pNear;
        clone._pFar = this._pFar;
        clone._pAspectRatio = this._pAspectRatio;
        clone.projectionHeight = this._projectionHeight;
        return clone;
    };
    //@override
    OrthographicProjection.prototype.pUpdateMatrix = function () {
        var raw = [];
        this._yMax = this._projectionHeight * .5;
        this._xMax = this._yMax * this._pAspectRatio;
        var left;
        var right;
        var top;
        var bottom;
        if (this._pScissorRect.x == 0 && this._pScissorRect.y == 0 && this._pScissorRect.width == this._pViewPort.width && this._pScissorRect.height == this._pViewPort.height) {
            // assume symmetric frustum
            left = -this._xMax;
            right = this._xMax;
            top = -this._yMax;
            bottom = this._yMax;
            raw[0] = 2 / (this._projectionHeight * this._pAspectRatio);
            raw[5] = 2 / this._projectionHeight;
            raw[10] = 1 / (this._pFar - this._pNear);
            raw[14] = this._pNear / (this._pNear - this._pFar);
            raw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[8] = raw[9] = raw[11] = raw[12] = raw[13] = 0;
            raw[15] = 1;
        }
        else {
            var xWidth = this._xMax * (this._pViewPort.width / this._pScissorRect.width);
            var yHgt = this._yMax * (this._pViewPort.height / this._pScissorRect.height);
            var center = this._xMax * (this._pScissorRect.x * 2 - this._pViewPort.width) / this._pScissorRect.width + this._xMax;
            var middle = -this._yMax * (this._pScissorRect.y * 2 - this._pViewPort.height) / this._pScissorRect.height - this._yMax;
            left = center - xWidth;
            right = center + xWidth;
            top = middle - yHgt;
            bottom = middle + yHgt;
            raw[0] = 2 * 1 / (right - left);
            raw[5] = -2 * 1 / (top - bottom);
            raw[10] = 1 / (this._pFar - this._pNear);
            raw[12] = (right + left) / (right - left);
            raw[13] = (bottom + top) / (bottom - top);
            raw[14] = this._pNear / (this.near - this.far);
            raw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[8] = raw[9] = raw[11] = 0;
            raw[15] = 1;
        }
        this._pFrustumCorners[0] = this._pFrustumCorners[9] = this._pFrustumCorners[12] = this._pFrustumCorners[21] = left;
        this._pFrustumCorners[3] = this._pFrustumCorners[6] = this._pFrustumCorners[15] = this._pFrustumCorners[18] = right;
        this._pFrustumCorners[1] = this._pFrustumCorners[4] = this._pFrustumCorners[13] = this._pFrustumCorners[16] = top;
        this._pFrustumCorners[7] = this._pFrustumCorners[10] = this._pFrustumCorners[19] = this._pFrustumCorners[22] = bottom;
        this._pFrustumCorners[2] = this._pFrustumCorners[5] = this._pFrustumCorners[8] = this._pFrustumCorners[11] = this._pNear;
        this._pFrustumCorners[14] = this._pFrustumCorners[17] = this._pFrustumCorners[20] = this._pFrustumCorners[23] = this._pFar;
        this._pMatrix.copyRawDataFrom(raw);
        this._pMatrixInvalid = false;
    };
    return OrthographicProjection;
})(ProjectionBase);
module.exports = OrthographicProjection;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1jb3JlL2xpYi9wcm9qZWN0aW9ucy9PcnRob2dyYXBoaWNQcm9qZWN0aW9uLnRzIl0sIm5hbWVzIjpbIk9ydGhvZ3JhcGhpY1Byb2plY3Rpb24iLCJPcnRob2dyYXBoaWNQcm9qZWN0aW9uLmNvbnN0cnVjdG9yIiwiT3J0aG9ncmFwaGljUHJvamVjdGlvbi5wcm9qZWN0aW9uSGVpZ2h0IiwiT3J0aG9ncmFwaGljUHJvamVjdGlvbi51bnByb2plY3QiLCJPcnRob2dyYXBoaWNQcm9qZWN0aW9uLmNsb25lIiwiT3J0aG9ncmFwaGljUHJvamVjdGlvbi5wVXBkYXRlTWF0cml4Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFPLFFBQVEsV0FBZSwrQkFBK0IsQ0FBQyxDQUFDO0FBQy9ELElBQU8sY0FBYyxXQUFhLDRDQUE0QyxDQUFDLENBQUM7QUFFaEYsSUFBTSxzQkFBc0I7SUFBU0EsVUFBL0JBLHNCQUFzQkEsVUFBdUJBO0lBT2xEQSxTQVBLQSxzQkFBc0JBLENBT2ZBLGdCQUE2QkE7UUFBN0JDLGdDQUE2QkEsR0FBN0JBLHNCQUE2QkE7UUFFeENBLGlCQUFPQSxDQUFDQTtRQUNSQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEdBQUdBLGdCQUFnQkEsQ0FBQ0E7SUFDM0NBLENBQUNBO0lBRURELHNCQUFXQSxvREFBZ0JBO2FBQTNCQTtZQUVDRSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxpQkFBaUJBLENBQUNBO1FBQy9CQSxDQUFDQTthQUVERixVQUE0QkEsS0FBWUE7WUFFdkNFLEVBQUVBLENBQUNBLENBQUNBLEtBQUtBLElBQUlBLElBQUlBLENBQUNBLGlCQUFpQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3JDQSxNQUFNQSxDQUFDQTtZQUNSQSxDQUFDQTtZQUNEQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEdBQUdBLEtBQUtBLENBQUNBO1lBQy9CQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEVBQUVBLENBQUNBO1FBQzFCQSxDQUFDQTs7O09BVEFGO0lB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QUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO1lBQ3ZDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQTtZQUNqREEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDeEdBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBRWJBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBRVBBLElBQUlBLE1BQU1BLEdBQVVBLElBQUlBLENBQUNBLEtBQUtBLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLEtBQUtBLEdBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBO1lBQ2hGQSxJQUFJQSxJQUFJQSxHQUFVQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxDQUFDQSxNQUFNQSxHQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtZQUNoRkEsSUFBSUEsTUFBTUEsR0FBVUEsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0E7WUFDdEhBLElBQUlBLE1BQU1BLEdBQVVBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLE1BQU1BLENBQUNBLEdBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBO1lBRXpIQSxJQUFJQSxHQUFHQSxNQUFNQSxHQUFHQSxNQUFNQSxDQUFDQTtZQUN2QkEsS0FBS0EsR0FBR0EsTUFBTUEsR0FBR0EsTUFBTUEsQ0FBQ0E7WUFDeEJBLEdBQUdBLEdBQUdBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBO1lBQ3BCQSxNQUFNQSxHQUFHQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUV2QkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDNUJBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLEdBQUdBLE1BQU1BLENBQUNBLENBQUNBO1lBQzdCQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQTtZQUV2Q0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDeENBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLE1BQU1BLEdBQUdBLEdBQUdBLENBQUNBLEdBQUNBLENBQUNBLE1BQU1BLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBO1lBQ3hDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUU3Q0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDcEZBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ2JBLENBQUNBO1FBRURBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDbkhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsS0FBS0EsQ0FBQ0E7UUFDcEhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0E7UUFDbEhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsTUFBTUEsQ0FBQ0E7UUFDdEhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0E7UUFDekhBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0E7UUFFM0hBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLGVBQWVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBRW5DQSxJQUFJQSxDQUFDQSxlQUFlQSxHQUFHQSxLQUFLQSxDQUFDQTtJQUM5QkEsQ0FBQ0E7SUFDRkwsNkJBQUNBO0FBQURBLENBaEhBLEFBZ0hDQSxFQWhIb0MsY0FBYyxFQWdIbEQ7QUFFRCxBQUErQixpQkFBdkIsc0JBQXNCLENBQUMiLCJmaWxlIjoicHJvamVjdGlvbnMvT3J0aG9ncmFwaGljUHJvamVjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVmVjdG9yM0RcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vVmVjdG9yM0RcIik7XHJcbmltcG9ydCBQcm9qZWN0aW9uQmFzZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9wcm9qZWN0aW9ucy9Qcm9qZWN0aW9uQmFzZVwiKTtcclxuXHJcbmNsYXNzIE9ydGhvZ3JhcGhpY1Byb2plY3Rpb24gZXh0ZW5kcyBQcm9qZWN0aW9uQmFzZVxyXG57XHJcblxyXG5cdHByaXZhdGUgX3Byb2plY3Rpb25IZWlnaHQ6bnVtYmVyO1xyXG5cdHByaXZhdGUgX3hNYXg6bnVtYmVyO1xyXG5cdHByaXZhdGUgX3lNYXg6bnVtYmVyO1xyXG5cclxuXHRjb25zdHJ1Y3Rvcihwcm9qZWN0aW9uSGVpZ2h0Om51bWJlciA9IDUwMClcclxuXHR7XHJcblx0XHRzdXBlcigpO1xyXG5cdFx0dGhpcy5fcHJvamVjdGlvbkhlaWdodCA9IHByb2plY3Rpb25IZWlnaHQ7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0IHByb2plY3Rpb25IZWlnaHQoKTpudW1iZXJcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fcHJvamVjdGlvbkhlaWdodDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgcHJvamVjdGlvbkhlaWdodCh2YWx1ZTpudW1iZXIpXHJcblx0e1xyXG5cdFx0aWYgKHZhbHVlID09IHRoaXMuX3Byb2plY3Rpb25IZWlnaHQpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5fcHJvamVjdGlvbkhlaWdodCA9IHZhbHVlO1xyXG5cdFx0dGhpcy5wSW52YWxpZGF0ZU1hdHJpeCgpO1xyXG5cdH1cclxuXHJcblx0Ly9Ab3ZlcnJpZGVcclxuXHRwdWJsaWMgdW5wcm9qZWN0KG5YOm51bWJlciwgblk6bnVtYmVyLCBzWjpudW1iZXIpOlZlY3RvcjNEXHJcblx0e1xyXG5cdFx0dmFyIHY6VmVjdG9yM0QgPSBuZXcgVmVjdG9yM0QoblggKyB0aGlzLm1hdHJpeC5yYXdEYXRhWzEyXSwgLW5ZICsgdGhpcy5tYXRyaXgucmF3RGF0YVsxM10sIHNaLCAxLjApO1xyXG5cdFx0diA9IHRoaXMudW5wcm9qZWN0aW9uTWF0cml4LnRyYW5zZm9ybVZlY3Rvcih2KTtcclxuXHJcblx0XHQvL3ogaXMgdW5hZmZlY3RlZCBieSB0cmFuc2Zvcm1cclxuXHRcdHYueiA9IHNaO1xyXG5cclxuXHRcdHJldHVybiB2O1xyXG5cdH1cclxuXHJcblx0Ly9Ab3ZlcnJpZGVcclxuXHRwdWJsaWMgY2xvbmUoKTpQcm9qZWN0aW9uQmFzZVxyXG5cdHtcclxuXHRcdHZhciBjbG9uZTpPcnRob2dyYXBoaWNQcm9qZWN0aW9uID0gbmV3IE9ydGhvZ3JhcGhpY1Byb2plY3Rpb24oKTtcclxuXHRcdGNsb25lLl9wTmVhciA9IHRoaXMuX3BOZWFyO1xyXG5cdFx0Y2xvbmUuX3BGYXIgPSB0aGlzLl9wRmFyO1xyXG5cdFx0Y2xvbmUuX3BBc3BlY3RSYXRpbyA9IHRoaXMuX3BBc3BlY3RSYXRpbztcclxuXHRcdGNsb25lLnByb2plY3Rpb25IZWlnaHQgPSB0aGlzLl9wcm9qZWN0aW9uSGVpZ2h0O1xyXG5cdFx0cmV0dXJuIGNsb25lO1xyXG5cdH1cclxuXHJcblx0Ly9Ab3ZlcnJpZGVcclxuXHRwdWJsaWMgcFVwZGF0ZU1hdHJpeCgpXHJcblx0e1xyXG5cdFx0dmFyIHJhdzpudW1iZXJbXSA9IFtdO1xyXG5cdFx0dGhpcy5feU1heCA9IHRoaXMuX3Byb2plY3Rpb25IZWlnaHQqLjU7XHJcblx0XHR0aGlzLl94TWF4ID0gdGhpcy5feU1heCp0aGlzLl9wQXNwZWN0UmF0aW87XHJcblxyXG5cdFx0dmFyIGxlZnQ6bnVtYmVyO1xyXG5cdFx0dmFyIHJpZ2h0Om51bWJlcjtcclxuXHRcdHZhciB0b3A6bnVtYmVyO1xyXG5cdFx0dmFyIGJvdHRvbTpudW1iZXI7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3BTY2lzc29yUmVjdC54ID09IDAgJiYgdGhpcy5fcFNjaXNzb3JSZWN0LnkgPT0gMCAmJiB0aGlzLl9wU2Npc3NvclJlY3Qud2lkdGggPT0gdGhpcy5fcFZpZXdQb3J0LndpZHRoICYmIHRoaXMuX3BTY2lzc29yUmVjdC5oZWlnaHQgPT0gdGhpcy5fcFZpZXdQb3J0LmhlaWdodCkge1xyXG5cdFx0XHQvLyBhc3N1bWUgc3ltbWV0cmljIGZydXN0dW1cclxuXHJcblx0XHRcdGxlZnQgPSAtdGhpcy5feE1heDtcclxuXHRcdFx0cmlnaHQgPSB0aGlzLl94TWF4O1xyXG5cdFx0XHR0b3AgPSAtdGhpcy5feU1heDtcclxuXHRcdFx0Ym90dG9tID0gdGhpcy5feU1heDtcclxuXHJcblx0XHRcdHJhd1swXSA9IDIvKHRoaXMuX3Byb2plY3Rpb25IZWlnaHQqdGhpcy5fcEFzcGVjdFJhdGlvKTtcclxuXHRcdFx0cmF3WzVdID0gMi90aGlzLl9wcm9qZWN0aW9uSGVpZ2h0O1xyXG5cdFx0XHRyYXdbMTBdID0gMS8odGhpcy5fcEZhciAtIHRoaXMuX3BOZWFyKTtcclxuXHRcdFx0cmF3WzE0XSA9IHRoaXMuX3BOZWFyLyh0aGlzLl9wTmVhciAtIHRoaXMuX3BGYXIpO1xyXG5cdFx0XHRyYXdbMV0gPSByYXdbMl0gPSByYXdbM10gPSByYXdbNF0gPSByYXdbNl0gPSByYXdbN10gPSByYXdbOF0gPSByYXdbOV0gPSByYXdbMTFdID0gcmF3WzEyXSA9IHJhd1sxM10gPSAwO1xyXG5cdFx0XHRyYXdbMTVdID0gMTtcclxuXHJcblx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0dmFyIHhXaWR0aDpudW1iZXIgPSB0aGlzLl94TWF4Kih0aGlzLl9wVmlld1BvcnQud2lkdGgvdGhpcy5fcFNjaXNzb3JSZWN0LndpZHRoKTtcclxuXHRcdFx0dmFyIHlIZ3Q6bnVtYmVyID0gdGhpcy5feU1heCoodGhpcy5fcFZpZXdQb3J0LmhlaWdodC90aGlzLl9wU2Npc3NvclJlY3QuaGVpZ2h0KTtcclxuXHRcdFx0dmFyIGNlbnRlcjpudW1iZXIgPSB0aGlzLl94TWF4Kih0aGlzLl9wU2Npc3NvclJlY3QueCoyIC0gdGhpcy5fcFZpZXdQb3J0LndpZHRoKS90aGlzLl9wU2Npc3NvclJlY3Qud2lkdGggKyB0aGlzLl94TWF4O1xyXG5cdFx0XHR2YXIgbWlkZGxlOm51bWJlciA9IC10aGlzLl95TWF4Kih0aGlzLl9wU2Npc3NvclJlY3QueSoyIC0gdGhpcy5fcFZpZXdQb3J0LmhlaWdodCkvdGhpcy5fcFNjaXNzb3JSZWN0LmhlaWdodCAtIHRoaXMuX3lNYXg7XHJcblxyXG5cdFx0XHRsZWZ0ID0gY2VudGVyIC0geFdpZHRoO1xyXG5cdFx0XHRyaWdodCA9IGNlbnRlciArIHhXaWR0aDtcclxuXHRcdFx0dG9wID0gbWlkZGxlIC0geUhndDtcclxuXHRcdFx0Ym90dG9tID0gbWlkZGxlICsgeUhndDtcclxuXHJcblx0XHRcdHJhd1swXSA9IDIqMS8ocmlnaHQgLSBsZWZ0KTtcclxuXHRcdFx0cmF3WzVdID0gLTIqMS8odG9wIC0gYm90dG9tKTtcclxuXHRcdFx0cmF3WzEwXSA9IDEvKHRoaXMuX3BGYXIgLSB0aGlzLl9wTmVhcik7XHJcblxyXG5cdFx0XHRyYXdbMTJdID0gKHJpZ2h0ICsgbGVmdCkvKHJpZ2h0IC0gbGVmdCk7XHJcblx0XHRcdHJhd1sxM10gPSAoYm90dG9tICsgdG9wKS8oYm90dG9tIC0gdG9wKTtcclxuXHRcdFx0cmF3WzE0XSA9IHRoaXMuX3BOZWFyLyh0aGlzLm5lYXIgLSB0aGlzLmZhcik7XHJcblxyXG5cdFx0XHRyYXdbMV0gPSByYXdbMl0gPSByYXdbM10gPSByYXdbNF0gPSByYXdbNl0gPSByYXdbN10gPSByYXdbOF0gPSByYXdbOV0gPSByYXdbMTFdID0gMDtcclxuXHRcdFx0cmF3WzE1XSA9IDE7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzBdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzldID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzEyXSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1syMV0gPSBsZWZ0O1xyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzNdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzZdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzE1XSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxOF0gPSByaWdodDtcclxuXHRcdHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxXSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1s0XSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxM10gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMTZdID0gdG9wO1xyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzddID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzEwXSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxOV0gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMjJdID0gYm90dG9tO1xyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzJdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzVdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzhdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzExXSA9IHRoaXMuX3BOZWFyO1xyXG5cdFx0dGhpcy5fcEZydXN0dW1Db3JuZXJzWzE0XSA9IHRoaXMuX3BGcnVzdHVtQ29ybmVyc1sxN10gPSB0aGlzLl9wRnJ1c3R1bUNvcm5lcnNbMjBdID0gdGhpcy5fcEZydXN0dW1Db3JuZXJzWzIzXSA9IHRoaXMuX3BGYXI7XHJcblxyXG5cdFx0dGhpcy5fcE1hdHJpeC5jb3B5UmF3RGF0YUZyb20ocmF3KTtcclxuXHJcblx0XHR0aGlzLl9wTWF0cml4SW52YWxpZCA9IGZhbHNlO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0PSBPcnRob2dyYXBoaWNQcm9qZWN0aW9uOyJdfQ==