var Box = require("awayjs-core/lib/core/geom/Box");

var AbstractMethodError = require("awayjs-core/lib/errors/AbstractMethodError");

var BoundingVolumeBase = (function () {
    function BoundingVolumeBase() {
        this._pAabbPoints = new Array();
        this._pAabbPointsDirty = true;
        this._aabb = new Box();
    }
    Object.defineProperty(BoundingVolumeBase.prototype, "aabb", {
        get: function () {
            return this._aabb;
        },
        enumerable: true,
        configurable: true
    });

    Object.defineProperty(BoundingVolumeBase.prototype, "aabbPoints", {
        get: function () {
            if (this._pAabbPointsDirty)
                this.pUpdateAABBPoints();

            return this._pAabbPoints;
        },
        enumerable: true,
        configurable: true
    });

    Object.defineProperty(BoundingVolumeBase.prototype, "boundingEntity", {
        get: function () {
            if (!this._pBoundingEntity) {
                this._pBoundingEntity = this.pCreateBoundingEntity();
                this.pUpdateBoundingEntity();
            }

            return this._pBoundingEntity;
        },
        enumerable: true,
        configurable: true
    });

    BoundingVolumeBase.prototype.nullify = function () {
        this._aabb.x = this._aabb.y = this._aabb.z = 0;
        this._aabb.width = this._aabb.height = this._aabb.depth = 0;
        this._pAabbPointsDirty = true;

        if (this._pBoundingEntity)
            this.pUpdateBoundingEntity();
    };

    BoundingVolumeBase.prototype.disposeRenderable = function () {
        if (this._pBoundingEntity)
            this._pBoundingEntity.dispose();

        this._pBoundingEntity = null;
    };

    BoundingVolumeBase.prototype.fromVertices = function (vertices) {
        var i;
        var len = vertices.length;
        var minX, minY, minZ;
        var maxX, maxY, maxZ;

        if (len == 0) {
            this.nullify();
            return;
        }

        var v;

        minX = maxX = vertices[i++];
        minY = maxY = vertices[i++];
        minZ = maxZ = vertices[i++];

        while (i < len) {
            v = vertices[i++];
            if (v < minX)
                minX = v;
            else if (v > maxX)
                maxX = v;
            v = vertices[i++];
            if (v < minY)
                minY = v;
            else if (v > maxY)
                maxY = v;
            v = vertices[i++];
            if (v < minZ)
                minZ = v;
            else if (v > maxZ)
                maxZ = v;
        }

        this.fromExtremes(minX, minY, minZ, maxX, maxY, maxZ);
    };

    /**
    * Updates the bounds to fit a Geometry object.
    *
    * @param geometry The Geometry object to be bounded.
    */
    BoundingVolumeBase.prototype.fromGeometry = function (geometry) {
        var i, j, p;
        var subGeoms = geometry.subGeometries;
        var subGeom;
        var boundingPositions;
        var numSubGeoms = subGeoms.length;
        var minX, minY, minZ;
        var maxX, maxY, maxZ;

        if (numSubGeoms > 0) {
            i = 0;
            subGeom = subGeoms[0];
            boundingPositions = subGeom.getBoundingPositions();
            minX = maxX = boundingPositions[i];
            minY = maxY = boundingPositions[i + 1];
            minZ = maxZ = boundingPositions[i + 2];

            j = numSubGeoms;
            while (j--) {
                subGeom = subGeoms[j];
                boundingPositions = subGeom.getBoundingPositions();
                i = boundingPositions.length;
                while (i--) {
                    p = boundingPositions[i];
                    if (p < minX)
                        minX = p;
                    else if (p > maxX)
                        maxX = p;

                    p = boundingPositions[i + 1];

                    if (p < minY)
                        minY = p;
                    else if (p > maxY)
                        maxY = p;

                    p = boundingPositions[i + 2];

                    if (p < minZ)
                        minZ = p;
                    else if (p > maxZ)
                        maxZ = p;
                }
            }

            this.fromExtremes(minX, minY, minZ, maxX, maxY, maxZ);
        } else {
            this.fromExtremes(0, 0, 0, 0, 0, 0);
        }
    };

    BoundingVolumeBase.prototype.fromSphere = function (center, radius) {
        this.fromExtremes(center.x - radius, center.y - radius, center.z - radius, center.x + radius, center.y + radius, center.z + radius);
    };

    BoundingVolumeBase.prototype.fromExtremes = function (minX, minY, minZ, maxX, maxY, maxZ) {
        this._aabb.x = minX;
        this._aabb.y = maxY;
        this._aabb.z = minZ;
        this._aabb.width = maxX - minX;
        this._aabb.height = maxY - minY;
        this._aabb.depth = maxZ - minZ;
        this._pAabbPointsDirty = true;

        if (this._pBoundingEntity)
            this.pUpdateBoundingEntity();
    };

    BoundingVolumeBase.prototype.isInFrustum = function (planes, numPlanes) {
        throw new AbstractMethodError();
    };

    BoundingVolumeBase.prototype.overlaps = function (bounds) {
        return this._aabb.intersects(bounds.aabb);
    };

    BoundingVolumeBase.prototype.clone = function () {
        throw new AbstractMethodError();
    };

    BoundingVolumeBase.prototype.rayIntersection = function (position, direction, targetNormal) {
        return -1;
    };

    BoundingVolumeBase.prototype.containsPoint = function (position) {
        return false;
    };

    BoundingVolumeBase.prototype.pUpdateAABBPoints = function () {
        var minX = this._aabb.x;
        var minY = this._aabb.y - this._aabb.height;
        var minZ = this._aabb.z;
        var maxX = this._aabb.x + this._aabb.width;
        var maxY = this._aabb.y;
        var maxZ = this._aabb.z + this._aabb.depth;

        this._pAabbPoints[0] = minX;
        this._pAabbPoints[1] = minY;
        this._pAabbPoints[2] = minZ;
        this._pAabbPoints[3] = maxX;
        this._pAabbPoints[4] = minY;
        this._pAabbPoints[5] = minZ;
        this._pAabbPoints[6] = minX;
        this._pAabbPoints[7] = maxY;
        this._pAabbPoints[8] = minZ;
        this._pAabbPoints[9] = maxX;
        this._pAabbPoints[10] = maxY;
        this._pAabbPoints[11] = minZ;
        this._pAabbPoints[12] = minX;
        this._pAabbPoints[13] = minY;
        this._pAabbPoints[14] = maxZ;
        this._pAabbPoints[15] = maxX;
        this._pAabbPoints[16] = minY;
        this._pAabbPoints[17] = maxZ;
        this._pAabbPoints[18] = minX;
        this._pAabbPoints[19] = maxY;
        this._pAabbPoints[20] = maxZ;
        this._pAabbPoints[21] = maxX;
        this._pAabbPoints[22] = maxY;
        this._pAabbPoints[23] = maxZ;
        this._pAabbPointsDirty = false;
    };

    BoundingVolumeBase.prototype.pUpdateBoundingEntity = function () {
        throw new AbstractMethodError();
    };

    BoundingVolumeBase.prototype.pCreateBoundingEntity = function () {
        throw new AbstractMethodError();
    };

    BoundingVolumeBase.prototype.classifyToPlane = function (plane) {
        throw new AbstractMethodError();
    };

    BoundingVolumeBase.prototype.transformFrom = function (bounds, matrix) {
        throw new AbstractMethodError();
    };
    return BoundingVolumeBase;
})();

module.exports = BoundingVolumeBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvdW5kcy9Cb3VuZGluZ1ZvbHVtZUJhc2UudHMiXSwibmFtZXMiOlsiQm91bmRpbmdWb2x1bWVCYXNlIiwiQm91bmRpbmdWb2x1bWVCYXNlLmNvbnN0cnVjdG9yIiwiQm91bmRpbmdWb2x1bWVCYXNlLm51bGxpZnkiLCJCb3VuZGluZ1ZvbHVtZUJhc2UuZGlzcG9zZVJlbmRlcmFibGUiLCJCb3VuZGluZ1ZvbHVtZUJhc2UuZnJvbVZlcnRpY2VzIiwiQm91bmRpbmdWb2x1bWVCYXNlLmZyb21HZW9tZXRyeSIsIkJvdW5kaW5nVm9sdW1lQmFzZS5mcm9tU3BoZXJlIiwiQm91bmRpbmdWb2x1bWVCYXNlLmZyb21FeHRyZW1lcyIsIkJvdW5kaW5nVm9sdW1lQmFzZS5pc0luRnJ1c3R1bSIsIkJvdW5kaW5nVm9sdW1lQmFzZS5vdmVybGFwcyIsIkJvdW5kaW5nVm9sdW1lQmFzZS5jbG9uZSIsIkJvdW5kaW5nVm9sdW1lQmFzZS5yYXlJbnRlcnNlY3Rpb24iLCJCb3VuZGluZ1ZvbHVtZUJhc2UuY29udGFpbnNQb2ludCIsIkJvdW5kaW5nVm9sdW1lQmFzZS5wVXBkYXRlQUFCQlBvaW50cyIsIkJvdW5kaW5nVm9sdW1lQmFzZS5wVXBkYXRlQm91bmRpbmdFbnRpdHkiLCJCb3VuZGluZ1ZvbHVtZUJhc2UucENyZWF0ZUJvdW5kaW5nRW50aXR5IiwiQm91bmRpbmdWb2x1bWVCYXNlLmNsYXNzaWZ5VG9QbGFuZSIsIkJvdW5kaW5nVm9sdW1lQmFzZS50cmFuc2Zvcm1Gcm9tIl0sIm1hcHBpbmdzIjoiQUFBQSxrREFFNEQ7O0FBSzVELCtFQUFxRjs7QUFFckY7SUFPQ0E7UUFKQUMsS0FBT0EsWUFBWUEsR0FBaUJBLElBQUlBLEtBQUtBLENBQVNBLENBQUNBLENBQUNBO1FBQ3hEQSxLQUFPQSxpQkFBaUJBLEdBQVdBLElBQUlBLENBQUNBO1FBS3ZDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQTtJQUN2QkEsQ0FBQ0E7SUFFREQ7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SUFBSUEsR0FBVUEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsS0FBS0E7O1FBRWpEQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQTtRQUMzQkEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUE7UUFDM0JBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBO1FBQzNCQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQTtRQUMzQkEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUE7UUFDM0JBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBO1FBQzNCQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQTtRQUMzQkEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUE7UUFDM0JBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBO1FBQzNCQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQTtRQUMzQkEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUE7UUFDNUJBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBO1FBQzVCQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQTtRQUM1QkEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUE7UUFDNUJBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBO1FBQzVCQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQTtRQUM1QkEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUE7UUFDNUJBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBO1FBQzVCQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQTtRQUM1QkEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUE7UUFDNUJBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBO1FBQzVCQSxJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQTtRQUM1QkEsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUE7UUFDNUJBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBO1FBQzVCQSxJQUFJQSxDQUFDQSxpQkFBaUJBLEdBQUdBLEtBQUtBO0lBQy9CQSxDQUFDQTs7SUFFRGIscURBQUFBO1FBRUNjLE1BQU1BLElBQUlBLG1CQUFtQkEsQ0FBQ0EsQ0FBQ0E7SUFDaENBLENBQUNBOztJQUVEZCxxREFBQUE7UUFFQ2UsTUFBTUEsSUFBSUEsbUJBQW1CQSxDQUFDQSxDQUFDQTtJQUNoQ0EsQ0FBQ0E7O0lBRURmLCtDQUFBQSxVQUF1QkEsS0FBYUE7UUFFbkNnQixNQUFNQSxJQUFJQSxtQkFBbUJBLENBQUNBLENBQUNBO0lBQ2hDQSxDQUFDQTs7SUFFRGhCLDZDQUFBQSxVQUFxQkEsTUFBeUJBLEVBQUVBLE1BQWVBO1FBRTlEaUIsTUFBTUEsSUFBSUEsbUJBQW1CQSxDQUFDQSxDQUFDQTtJQUNoQ0EsQ0FBQ0E7SUFDRmpCLDBCQUFDQTtBQUFEQSxDQUFDQSxJQUFBOztBQUVELG1DQUE0QixDQUFBIiwiZmlsZSI6ImJvdW5kcy9Cb3VuZGluZ1ZvbHVtZUJhc2UuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL3JvYmJhdGVtYW4vV2Vic3Rvcm1Qcm9qZWN0cy9hd2F5anMtY29yZS8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgR2VvbWV0cnlcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvY29yZS9iYXNlL0dlb21ldHJ5XCIpO1xuaW1wb3J0IFN1Ykdlb21ldHJ5QmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2NvcmUvYmFzZS9TdWJHZW9tZXRyeUJhc2VcIik7XG5pbXBvcnQgQm94XHRcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvY29yZS9nZW9tL0JveFwiKTtcbmltcG9ydCBNYXRyaXgzRFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9jb3JlL2dlb20vTWF0cml4M0RcIik7XG5pbXBvcnQgUGxhbmUzRFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9jb3JlL2dlb20vUGxhbmUzRFwiKTtcbmltcG9ydCBWZWN0b3IzRFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9jb3JlL2dlb20vVmVjdG9yM0RcIik7XG5pbXBvcnQgSUVudGl0eVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9lbnRpdGllcy9JRW50aXR5XCIpO1xuaW1wb3J0IEFic3RyYWN0TWV0aG9kRXJyb3JcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXJyb3JzL0Fic3RyYWN0TWV0aG9kRXJyb3JcIik7XG5cbmNsYXNzIEJvdW5kaW5nVm9sdW1lQmFzZVxue1xuXHRwdWJsaWMgX2FhYmI6Qm94O1xuXHRwdWJsaWMgX3BBYWJiUG9pbnRzOkFycmF5PG51bWJlcj4gPSBuZXcgQXJyYXk8bnVtYmVyPigpO1xuXHRwdWJsaWMgX3BBYWJiUG9pbnRzRGlydHk6Ym9vbGVhbiA9IHRydWU7XG5cdHB1YmxpYyBfcEJvdW5kaW5nRW50aXR5OklFbnRpdHk7XG5cblx0Y29uc3RydWN0b3IoKVxuXHR7XG5cdFx0dGhpcy5fYWFiYiA9IG5ldyBCb3goKTtcblx0fVxuXG5cdHB1YmxpYyBnZXQgYWFiYigpOkJveFxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX2FhYmI7XG5cdH1cblxuXHRwdWJsaWMgZ2V0IGFhYmJQb2ludHMoKTpBcnJheTxudW1iZXI+XG5cdHtcblx0XHRpZiAodGhpcy5fcEFhYmJQb2ludHNEaXJ0eSlcblx0XHRcdHRoaXMucFVwZGF0ZUFBQkJQb2ludHMoKTtcblxuXHRcdHJldHVybiB0aGlzLl9wQWFiYlBvaW50cztcblx0fVxuXG5cdHB1YmxpYyBnZXQgYm91bmRpbmdFbnRpdHkoKTpJRW50aXR5XG5cdHtcblx0XHRpZiAoIXRoaXMuX3BCb3VuZGluZ0VudGl0eSkge1xuXHRcdFx0dGhpcy5fcEJvdW5kaW5nRW50aXR5ID0gdGhpcy5wQ3JlYXRlQm91bmRpbmdFbnRpdHkoKTtcblx0XHRcdHRoaXMucFVwZGF0ZUJvdW5kaW5nRW50aXR5KCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuX3BCb3VuZGluZ0VudGl0eTtcblx0fVxuXG5cdHB1YmxpYyBudWxsaWZ5KClcblx0e1xuXHRcdHRoaXMuX2FhYmIueCA9IHRoaXMuX2FhYmIueSA9IHRoaXMuX2FhYmIueiA9IDA7XG5cdFx0dGhpcy5fYWFiYi53aWR0aCA9IHRoaXMuX2FhYmIuaGVpZ2h0ID0gdGhpcy5fYWFiYi5kZXB0aCA9IDA7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNEaXJ0eSA9IHRydWU7XG5cblx0XHRpZiAodGhpcy5fcEJvdW5kaW5nRW50aXR5KVxuXHRcdFx0dGhpcy5wVXBkYXRlQm91bmRpbmdFbnRpdHkoKTtcblx0fVxuXG5cdHB1YmxpYyBkaXNwb3NlUmVuZGVyYWJsZSgpXG5cdHtcblx0XHRpZiAodGhpcy5fcEJvdW5kaW5nRW50aXR5KVxuXHRcdFx0dGhpcy5fcEJvdW5kaW5nRW50aXR5LmRpc3Bvc2UoKTtcblxuXHRcdHRoaXMuX3BCb3VuZGluZ0VudGl0eSA9IG51bGw7XG5cdH1cblxuXHRwdWJsaWMgZnJvbVZlcnRpY2VzKHZlcnRpY2VzOkFycmF5PG51bWJlcj4pXG5cdHtcblx0XHR2YXIgaTpudW1iZXI7XG5cdFx0dmFyIGxlbjpudW1iZXIgPSB2ZXJ0aWNlcy5sZW5ndGg7XG5cdFx0dmFyIG1pblg6bnVtYmVyLCBtaW5ZOm51bWJlciwgbWluWjpudW1iZXI7XG5cdFx0dmFyIG1heFg6bnVtYmVyLCBtYXhZOm51bWJlciwgbWF4WjpudW1iZXI7XG5cblx0XHRpZiAobGVuID09IDApIHtcblx0XHRcdHRoaXMubnVsbGlmeSgpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHZhciB2Om51bWJlcjtcblxuXHRcdG1pblggPSBtYXhYID0gdmVydGljZXNbaSsrXTtcblx0XHRtaW5ZID0gbWF4WSA9IHZlcnRpY2VzW2krK107XG5cdFx0bWluWiA9IG1heFogPSB2ZXJ0aWNlc1tpKytdO1xuXG5cdFx0d2hpbGUgKGkgPCBsZW4pIHtcblx0XHRcdHYgPSB2ZXJ0aWNlc1tpKytdO1xuXHRcdFx0aWYgKHYgPCBtaW5YKVxuXHRcdFx0XHRtaW5YID0gdjsgZWxzZSBpZiAodiA+IG1heFgpXG5cdFx0XHRcdG1heFggPSB2O1xuXHRcdFx0diA9IHZlcnRpY2VzW2krK107XG5cdFx0XHRpZiAodiA8IG1pblkpXG5cdFx0XHRcdG1pblkgPSB2OyBlbHNlIGlmICh2ID4gbWF4WSlcblx0XHRcdFx0bWF4WSA9IHY7XG5cdFx0XHR2ID0gdmVydGljZXNbaSsrXTtcblx0XHRcdGlmICh2IDwgbWluWilcblx0XHRcdFx0bWluWiA9IHY7IGVsc2UgaWYgKHYgPiBtYXhaKVxuXHRcdFx0XHRtYXhaID0gdjtcblx0XHR9XG5cblx0XHR0aGlzLmZyb21FeHRyZW1lcyhtaW5YLCBtaW5ZLCBtaW5aLCBtYXhYLCBtYXhZLCBtYXhaKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBVcGRhdGVzIHRoZSBib3VuZHMgdG8gZml0IGEgR2VvbWV0cnkgb2JqZWN0LlxuXHQgKlxuXHQgKiBAcGFyYW0gZ2VvbWV0cnkgVGhlIEdlb21ldHJ5IG9iamVjdCB0byBiZSBib3VuZGVkLlxuXHQgKi9cblx0cHVibGljIGZyb21HZW9tZXRyeShnZW9tZXRyeTpHZW9tZXRyeSk6dm9pZFxuXHR7XG5cdFx0dmFyIGk6bnVtYmVyLCBqOm51bWJlciwgcDpudW1iZXI7XG5cdFx0dmFyIHN1Ykdlb21zOkFycmF5PFN1Ykdlb21ldHJ5QmFzZT4gPSBnZW9tZXRyeS5zdWJHZW9tZXRyaWVzO1xuXHRcdHZhciBzdWJHZW9tOlN1Ykdlb21ldHJ5QmFzZTtcblx0XHR2YXIgYm91bmRpbmdQb3NpdGlvbnM6QXJyYXk8bnVtYmVyPjtcblx0XHR2YXIgbnVtU3ViR2VvbXM6bnVtYmVyID0gc3ViR2VvbXMubGVuZ3RoO1xuXHRcdHZhciBtaW5YOm51bWJlciwgbWluWTpudW1iZXIsIG1pblo6bnVtYmVyO1xuXHRcdHZhciBtYXhYOm51bWJlciwgbWF4WTpudW1iZXIsIG1heFo6bnVtYmVyO1xuXG5cdFx0aWYgKG51bVN1Ykdlb21zID4gMCkge1xuXHRcdFx0aSA9IDA7XG5cdFx0XHRzdWJHZW9tID0gc3ViR2VvbXNbMF07XG5cdFx0XHRib3VuZGluZ1Bvc2l0aW9ucyA9IHN1Ykdlb20uZ2V0Qm91bmRpbmdQb3NpdGlvbnMoKTtcblx0XHRcdG1pblggPSBtYXhYID0gYm91bmRpbmdQb3NpdGlvbnNbaV07XG5cdFx0XHRtaW5ZID0gbWF4WSA9IGJvdW5kaW5nUG9zaXRpb25zW2kgKyAxXTtcblx0XHRcdG1pblogPSBtYXhaID0gYm91bmRpbmdQb3NpdGlvbnNbaSArIDJdO1xuXG5cdFx0XHRqID0gbnVtU3ViR2VvbXM7XG5cdFx0XHR3aGlsZSAoai0tKSB7XG5cdFx0XHRcdHN1Ykdlb20gPSBzdWJHZW9tc1tqXTtcblx0XHRcdFx0Ym91bmRpbmdQb3NpdGlvbnMgPSBzdWJHZW9tLmdldEJvdW5kaW5nUG9zaXRpb25zKCk7XG5cdFx0XHRcdGkgPSBib3VuZGluZ1Bvc2l0aW9ucy5sZW5ndGg7XG5cdFx0XHRcdHdoaWxlIChpLS0pIHtcblx0XHRcdFx0XHRwID0gYm91bmRpbmdQb3NpdGlvbnNbaV07XG5cdFx0XHRcdFx0aWYgKHAgPCBtaW5YKVxuXHRcdFx0XHRcdFx0bWluWCA9IHA7XG5cdFx0XHRcdFx0ZWxzZSBpZiAocCA+IG1heFgpXG5cdFx0XHRcdFx0XHRtYXhYID0gcDtcblxuXHRcdFx0XHRcdHAgPSBib3VuZGluZ1Bvc2l0aW9uc1tpICsgMV07XG5cblx0XHRcdFx0XHRpZiAocCA8IG1pblkpXG5cdFx0XHRcdFx0XHRtaW5ZID0gcDtcblx0XHRcdFx0XHRlbHNlIGlmIChwID4gbWF4WSlcblx0XHRcdFx0XHRcdG1heFkgPSBwO1xuXG5cdFx0XHRcdFx0cCA9IGJvdW5kaW5nUG9zaXRpb25zW2kgKyAyXTtcblxuXHRcdFx0XHRcdGlmIChwIDwgbWluWilcblx0XHRcdFx0XHRcdG1pblogPSBwO1xuXHRcdFx0XHRcdGVsc2UgaWYgKHAgPiBtYXhaKVxuXHRcdFx0XHRcdFx0bWF4WiA9IHA7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dGhpcy5mcm9tRXh0cmVtZXMobWluWCwgbWluWSwgbWluWiwgbWF4WCwgbWF4WSwgbWF4Wik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuZnJvbUV4dHJlbWVzKDAsIDAsIDAsIDAsIDAsIDApO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBmcm9tU3BoZXJlKGNlbnRlcjpWZWN0b3IzRCwgcmFkaXVzOm51bWJlcilcblx0e1xuXHRcdHRoaXMuZnJvbUV4dHJlbWVzKGNlbnRlci54IC0gcmFkaXVzLCBjZW50ZXIueSAtIHJhZGl1cywgY2VudGVyLnogLSByYWRpdXMsIGNlbnRlci54ICsgcmFkaXVzLCBjZW50ZXIueSArIHJhZGl1cywgY2VudGVyLnogKyByYWRpdXMpO1xuXHR9XG5cblx0cHVibGljIGZyb21FeHRyZW1lcyhtaW5YOm51bWJlciwgbWluWTpudW1iZXIsIG1pblo6bnVtYmVyLCBtYXhYOm51bWJlciwgbWF4WTpudW1iZXIsIG1heFo6bnVtYmVyKVxuXHR7XG5cdFx0dGhpcy5fYWFiYi54ID0gbWluWDtcblx0XHR0aGlzLl9hYWJiLnkgPSBtYXhZO1xuXHRcdHRoaXMuX2FhYmIueiA9IG1pblo7XG5cdFx0dGhpcy5fYWFiYi53aWR0aCA9IG1heFggLSBtaW5YO1xuXHRcdHRoaXMuX2FhYmIuaGVpZ2h0ID0gbWF4WSAtIG1pblk7XG5cdFx0dGhpcy5fYWFiYi5kZXB0aCA9IG1heFogLSBtaW5aO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzRGlydHkgPSB0cnVlO1xuXG5cdFx0aWYgKHRoaXMuX3BCb3VuZGluZ0VudGl0eSlcblx0XHRcdHRoaXMucFVwZGF0ZUJvdW5kaW5nRW50aXR5KCk7XG5cdH1cblxuXHRwdWJsaWMgaXNJbkZydXN0dW0ocGxhbmVzOkFycmF5PFBsYW5lM0Q+LCBudW1QbGFuZXM6bnVtYmVyKTpib29sZWFuXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG5cblx0cHVibGljIG92ZXJsYXBzKGJvdW5kczpCb3VuZGluZ1ZvbHVtZUJhc2UpOmJvb2xlYW5cblx0e1xuXHRcdHJldHVybiB0aGlzLl9hYWJiLmludGVyc2VjdHMoYm91bmRzLmFhYmIpO1xuXHR9XG5cblx0cHVibGljIGNsb25lKCk6Qm91bmRpbmdWb2x1bWVCYXNlXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG5cblx0cHVibGljIHJheUludGVyc2VjdGlvbihwb3NpdGlvbjpWZWN0b3IzRCwgZGlyZWN0aW9uOlZlY3RvcjNELCB0YXJnZXROb3JtYWw6VmVjdG9yM0QpOm51bWJlclxuXHR7XG5cdFx0cmV0dXJuIC0xO1xuXHR9XG5cblx0cHVibGljIGNvbnRhaW5zUG9pbnQocG9zaXRpb246VmVjdG9yM0QpOmJvb2xlYW5cblx0e1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHB1YmxpYyBwVXBkYXRlQUFCQlBvaW50cygpXG5cdHtcblx0XHR2YXIgbWluWDpudW1iZXIgPSB0aGlzLl9hYWJiLng7XG5cdFx0dmFyIG1pblk6bnVtYmVyID0gdGhpcy5fYWFiYi55IC0gdGhpcy5fYWFiYi5oZWlnaHQ7XG5cdFx0dmFyIG1pblo6bnVtYmVyID0gdGhpcy5fYWFiYi56O1xuXHRcdHZhciBtYXhYOm51bWJlciA9IHRoaXMuX2FhYmIueCArIHRoaXMuX2FhYmIud2lkdGg7XG5cdFx0dmFyIG1heFk6bnVtYmVyID0gdGhpcy5fYWFiYi55O1xuXHRcdHZhciBtYXhaOm51bWJlciA9IHRoaXMuX2FhYmIueiArIHRoaXMuX2FhYmIuZGVwdGg7XG5cblx0XHR0aGlzLl9wQWFiYlBvaW50c1swXSA9IG1pblg7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNbMV0gPSBtaW5ZO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzWzJdID0gbWluWjtcblx0XHR0aGlzLl9wQWFiYlBvaW50c1szXSA9IG1heFg7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNbNF0gPSBtaW5ZO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzWzVdID0gbWluWjtcblx0XHR0aGlzLl9wQWFiYlBvaW50c1s2XSA9IG1pblg7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNbN10gPSBtYXhZO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzWzhdID0gbWluWjtcblx0XHR0aGlzLl9wQWFiYlBvaW50c1s5XSA9IG1heFg7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNbMTBdID0gbWF4WTtcblx0XHR0aGlzLl9wQWFiYlBvaW50c1sxMV0gPSBtaW5aO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzWzEyXSA9IG1pblg7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNbMTNdID0gbWluWTtcblx0XHR0aGlzLl9wQWFiYlBvaW50c1sxNF0gPSBtYXhaO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzWzE1XSA9IG1heFg7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNbMTZdID0gbWluWTtcblx0XHR0aGlzLl9wQWFiYlBvaW50c1sxN10gPSBtYXhaO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzWzE4XSA9IG1pblg7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNbMTldID0gbWF4WTtcblx0XHR0aGlzLl9wQWFiYlBvaW50c1syMF0gPSBtYXhaO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzWzIxXSA9IG1heFg7XG5cdFx0dGhpcy5fcEFhYmJQb2ludHNbMjJdID0gbWF4WTtcblx0XHR0aGlzLl9wQWFiYlBvaW50c1syM10gPSBtYXhaO1xuXHRcdHRoaXMuX3BBYWJiUG9pbnRzRGlydHkgPSBmYWxzZTtcblx0fVxuXG5cdHB1YmxpYyBwVXBkYXRlQm91bmRpbmdFbnRpdHkoKVxuXHR7XG5cdFx0dGhyb3cgbmV3IEFic3RyYWN0TWV0aG9kRXJyb3IoKTtcblx0fVxuXG5cdHB1YmxpYyBwQ3JlYXRlQm91bmRpbmdFbnRpdHkoKTpJRW50aXR5XG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG5cblx0cHVibGljIGNsYXNzaWZ5VG9QbGFuZShwbGFuZTpQbGFuZTNEKTpudW1iZXJcblx0e1xuXHRcdHRocm93IG5ldyBBYnN0cmFjdE1ldGhvZEVycm9yKCk7XG5cdH1cblxuXHRwdWJsaWMgdHJhbnNmb3JtRnJvbShib3VuZHM6Qm91bmRpbmdWb2x1bWVCYXNlLCBtYXRyaXg6TWF0cml4M0QpXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG59XG5cbmV4cG9ydCA9IEJvdW5kaW5nVm9sdW1lQmFzZTsiXX0=