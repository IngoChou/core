var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var Error = require("awayjs-core/lib/errors/Error");
var CubeTextureBase = require("awayjs-core/lib/textures/CubeTextureBase");
var TextureUtils = require("awayjs-core/lib/utils/TextureUtils");
var BitmapCubeTexture = (function (_super) {
    __extends(BitmapCubeTexture, _super);
    function BitmapCubeTexture(posX, negX, posY, negY, posZ, negZ) {
        _super.call(this);
        this._bitmapDatas = new Array(6);
        this._testSize(this._bitmapDatas[0] = posX);
        this._testSize(this._bitmapDatas[1] = negX);
        this._testSize(this._bitmapDatas[2] = posY);
        this._testSize(this._bitmapDatas[3] = negY);
        this._testSize(this._bitmapDatas[4] = posZ);
        this._testSize(this._bitmapDatas[5] = negZ);
        this.invalidateContent();
        this._pSetSize(posX.width);
    }
    Object.defineProperty(BitmapCubeTexture.prototype, "positiveX", {
        /**
         * The texture on the cube's right face.
         */
        get: function () {
            return this._bitmapDatas[0];
        },
        set: function (value) {
            this._testSize(value);
            this.invalidateContent();
            this._pSetSize(value.width);
            this._bitmapDatas[0] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BitmapCubeTexture.prototype, "negativeX", {
        /**
         * The texture on the cube's left face.
         */
        get: function () {
            return this._bitmapDatas[1];
        },
        set: function (value) {
            this._testSize(value);
            this.invalidateContent();
            this._pSetSize(value.width);
            this._bitmapDatas[1] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BitmapCubeTexture.prototype, "positiveY", {
        /**
         * The texture on the cube's top face.
         */
        get: function () {
            return this._bitmapDatas[2];
        },
        set: function (value) {
            this._testSize(value);
            this.invalidateContent();
            this._pSetSize(value.width);
            this._bitmapDatas[2] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BitmapCubeTexture.prototype, "negativeY", {
        /**
         * The texture on the cube's bottom face.
         */
        get: function () {
            return this._bitmapDatas[3];
        },
        set: function (value) {
            this._testSize(value);
            this.invalidateContent();
            this._pSetSize(value.width);
            this._bitmapDatas[3] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BitmapCubeTexture.prototype, "positiveZ", {
        /**
         * The texture on the cube's far face.
         */
        get: function () {
            return this._bitmapDatas[4];
        },
        set: function (value) {
            this._testSize(value);
            this.invalidateContent();
            this._pSetSize(value.width);
            this._bitmapDatas[4] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BitmapCubeTexture.prototype, "negativeZ", {
        /**
         * The texture on the cube's near face.
         */
        get: function () {
            return this._bitmapDatas[5];
        },
        set: function (value) {
            this._testSize(value);
            this.invalidateContent();
            this._pSetSize(value.width);
            this._bitmapDatas[5] = value;
        },
        enumerable: true,
        configurable: true
    });
    /**
     *
     * @param value
     * @private
     */
    BitmapCubeTexture.prototype._testSize = function (value) {
        if (value.width != value.height)
            throw new Error("BitmapData should have equal width and height!");
        if (!TextureUtils.isBitmapDataValid(value))
            throw new Error("Invalid bitmapData: Width and height must be power of 2 and cannot exceed 2048");
    };
    BitmapCubeTexture.prototype.dispose = function () {
        _super.prototype.dispose.call(this);
        var len = this._bitmapDatas.length;
        for (var i = 0; i < len; i++) {
            this._bitmapDatas[i].dispose();
            this._bitmapDatas[i] = null;
        }
        this._bitmapDatas = null;
    };
    BitmapCubeTexture.prototype._iGetTextureData = function (side) {
        return this._bitmapDatas[side];
    };
    return BitmapCubeTexture;
})(CubeTextureBase);
module.exports = BitmapCubeTexture;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1jb3JlL2xpYi90ZXh0dXJlcy9CaXRtYXBDdWJlVGV4dHVyZS50cyJdLCJuYW1lcyI6WyJCaXRtYXBDdWJlVGV4dHVyZSIsIkJpdG1hcEN1YmVUZXh0dXJlLmNvbnN0cnVjdG9yIiwiQml0bWFwQ3ViZVRleHR1cmUucG9zaXRpdmVYIiwiQml0bWFwQ3ViZVRleHR1cmUubmVnYXRpdmVYIiwiQml0bWFwQ3ViZVRleHR1cmUucG9zaXRpdmVZIiwiQml0bWFwQ3ViZVRleHR1cmUubmVnYXRpdmVZIiwiQml0bWFwQ3ViZVRleHR1cmUucG9zaXRpdmVaIiwiQml0bWFwQ3ViZVRleHR1cmUubmVnYXRpdmVaIiwiQml0bWFwQ3ViZVRleHR1cmUuX3Rlc3RTaXplIiwiQml0bWFwQ3ViZVRleHR1cmUuZGlzcG9zZSIsIkJpdG1hcEN1YmVUZXh0dXJlLl9pR2V0VGV4dHVyZURhdGEiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBLElBQU8sS0FBSyxXQUFlLDhCQUE4QixDQUFDLENBQUM7QUFDM0QsSUFBTyxlQUFlLFdBQWEsMENBQTBDLENBQUMsQ0FBQztBQUMvRSxJQUFPLFlBQVksV0FBYyxvQ0FBb0MsQ0FBQyxDQUFDO0FBR3ZFLElBQU0saUJBQWlCO0lBQVNBLFVBQTFCQSxpQkFBaUJBLFVBQXdCQTtJQW9HOUNBLFNBcEdLQSxpQkFBaUJBLENBb0dWQSxJQUFlQSxFQUFFQSxJQUFlQSxFQUFFQSxJQUFlQSxFQUFFQSxJQUFlQSxFQUFFQSxJQUFlQSxFQUFFQSxJQUFlQTtRQUUvR0MsaUJBQU9BLENBQUNBO1FBcEdEQSxpQkFBWUEsR0FBcUJBLElBQUlBLEtBQUtBLENBQWFBLENBQUNBLENBQUNBLENBQUNBO1FBc0dqRUEsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDNUNBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLElBQUlBLENBQUNBLFlBQVlB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QUVELEFBQTJCLGlCQUFsQixpQkFBaUIsQ0FBQyIsImZpbGUiOiJ0ZXh0dXJlcy9CaXRtYXBDdWJlVGV4dHVyZS5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQml0bWFwRGF0YVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2Jhc2UvQml0bWFwRGF0YVwiKTtcclxuaW1wb3J0IEVycm9yXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9lcnJvcnMvRXJyb3JcIik7XHJcbmltcG9ydCBDdWJlVGV4dHVyZUJhc2VcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvdGV4dHVyZXMvQ3ViZVRleHR1cmVCYXNlXCIpO1xyXG5pbXBvcnQgVGV4dHVyZVV0aWxzXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvdXRpbHMvVGV4dHVyZVV0aWxzXCIpO1xyXG5cclxuXHJcbmNsYXNzIEJpdG1hcEN1YmVUZXh0dXJlIGV4dGVuZHMgQ3ViZVRleHR1cmVCYXNlXHJcbntcclxuXHRwcml2YXRlIF9iaXRtYXBEYXRhczpBcnJheTxCaXRtYXBEYXRhPiA9IG5ldyBBcnJheTxCaXRtYXBEYXRhPig2KTtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIHRleHR1cmUgb24gdGhlIGN1YmUncyByaWdodCBmYWNlLlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXQgcG9zaXRpdmVYKCk6Qml0bWFwRGF0YVxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9iaXRtYXBEYXRhc1swXTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgcG9zaXRpdmVYKHZhbHVlOkJpdG1hcERhdGEpXHJcblx0e1xyXG5cdFx0dGhpcy5fdGVzdFNpemUodmFsdWUpO1xyXG5cdFx0dGhpcy5pbnZhbGlkYXRlQ29udGVudCgpO1xyXG5cdFx0dGhpcy5fcFNldFNpemUodmFsdWUud2lkdGgpO1xyXG5cdFx0dGhpcy5fYml0bWFwRGF0YXNbMF0gPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZSB0ZXh0dXJlIG9uIHRoZSBjdWJlJ3MgbGVmdCBmYWNlLlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXQgbmVnYXRpdmVYKCk6Qml0bWFwRGF0YVxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9iaXRtYXBEYXRhc1sxXTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgbmVnYXRpdmVYKHZhbHVlOkJpdG1hcERhdGEpXHJcblx0e1xyXG5cdFx0dGhpcy5fdGVzdFNpemUodmFsdWUpO1xyXG5cdFx0dGhpcy5pbnZhbGlkYXRlQ29udGVudCgpO1xyXG5cdFx0dGhpcy5fcFNldFNpemUodmFsdWUud2lkdGgpO1xyXG5cdFx0dGhpcy5fYml0bWFwRGF0YXNbMV0gPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZSB0ZXh0dXJlIG9uIHRoZSBjdWJlJ3MgdG9wIGZhY2UuXHJcblx0ICovXHJcblx0cHVibGljIGdldCBwb3NpdGl2ZVkoKTpCaXRtYXBEYXRhXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX2JpdG1hcERhdGFzWzJdO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldCBwb3NpdGl2ZVkodmFsdWU6Qml0bWFwRGF0YSlcclxuXHR7XHJcblx0XHR0aGlzLl90ZXN0U2l6ZSh2YWx1ZSk7XHJcblx0XHR0aGlzLmludmFsaWRhdGVDb250ZW50KCk7XHJcblx0XHR0aGlzLl9wU2V0U2l6ZSh2YWx1ZS53aWR0aCk7XHJcblx0XHR0aGlzLl9iaXRtYXBEYXRhc1syXSA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVGhlIHRleHR1cmUgb24gdGhlIGN1YmUncyBib3R0b20gZmFjZS5cclxuXHQgKi9cclxuXHRwdWJsaWMgZ2V0IG5lZ2F0aXZlWSgpOkJpdG1hcERhdGFcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fYml0bWFwRGF0YXNbM107XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0IG5lZ2F0aXZlWSh2YWx1ZTpCaXRtYXBEYXRhKVxyXG5cdHtcclxuXHRcdHRoaXMuX3Rlc3RTaXplKHZhbHVlKTtcclxuXHRcdHRoaXMuaW52YWxpZGF0ZUNvbnRlbnQoKTtcclxuXHRcdHRoaXMuX3BTZXRTaXplKHZhbHVlLndpZHRoKTtcclxuXHRcdHRoaXMuX2JpdG1hcERhdGFzWzNdID0gdmFsdWU7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBUaGUgdGV4dHVyZSBvbiB0aGUgY3ViZSdzIGZhciBmYWNlLlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXQgcG9zaXRpdmVaKCk6Qml0bWFwRGF0YVxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9iaXRtYXBEYXRhc1s0XTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgcG9zaXRpdmVaKHZhbHVlOkJpdG1hcERhdGEpXHJcblx0e1xyXG5cdFx0dGhpcy5fdGVzdFNpemUodmFsdWUpO1xyXG5cdFx0dGhpcy5pbnZhbGlkYXRlQ29udGVudCgpO1xyXG5cdFx0dGhpcy5fcFNldFNpemUodmFsdWUud2lkdGgpO1xyXG5cdFx0dGhpcy5fYml0bWFwRGF0YXNbNF0gPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZSB0ZXh0dXJlIG9uIHRoZSBjdWJlJ3MgbmVhciBmYWNlLlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBnZXQgbmVnYXRpdmVaKCk6Qml0bWFwRGF0YVxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9iaXRtYXBEYXRhc1s1XTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXQgbmVnYXRpdmVaKHZhbHVlOkJpdG1hcERhdGEpXHJcblx0e1xyXG5cdFx0dGhpcy5fdGVzdFNpemUodmFsdWUpO1xyXG5cdFx0dGhpcy5pbnZhbGlkYXRlQ29udGVudCgpO1xyXG5cdFx0dGhpcy5fcFNldFNpemUodmFsdWUud2lkdGgpO1xyXG5cdFx0dGhpcy5fYml0bWFwRGF0YXNbNV0gPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdGNvbnN0cnVjdG9yKHBvc1g6Qml0bWFwRGF0YSwgbmVnWDpCaXRtYXBEYXRhLCBwb3NZOkJpdG1hcERhdGEsIG5lZ1k6Qml0bWFwRGF0YSwgcG9zWjpCaXRtYXBEYXRhLCBuZWdaOkJpdG1hcERhdGEpXHJcblx0e1xyXG5cdFx0c3VwZXIoKTtcclxuXHJcblx0XHR0aGlzLl90ZXN0U2l6ZSh0aGlzLl9iaXRtYXBEYXRhc1swXSA9IHBvc1gpO1xyXG5cdFx0dGhpcy5fdGVzdFNpemUodGhpcy5fYml0bWFwRGF0YXNbMV0gPSBuZWdYKTtcclxuXHRcdHRoaXMuX3Rlc3RTaXplKHRoaXMuX2JpdG1hcERhdGFzWzJdID0gcG9zWSk7XHJcblx0XHR0aGlzLl90ZXN0U2l6ZSh0aGlzLl9iaXRtYXBEYXRhc1szXSA9IG5lZ1kpO1xyXG5cdFx0dGhpcy5fdGVzdFNpemUodGhpcy5fYml0bWFwRGF0YXNbNF0gPSBwb3NaKTtcclxuXHRcdHRoaXMuX3Rlc3RTaXplKHRoaXMuX2JpdG1hcERhdGFzWzVdID0gbmVnWik7XHJcblxyXG5cdFx0dGhpcy5pbnZhbGlkYXRlQ29udGVudCgpO1xyXG5cclxuXHRcdHRoaXMuX3BTZXRTaXplKHBvc1gud2lkdGgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gdmFsdWVcclxuXHQgKiBAcHJpdmF0ZVxyXG5cdCAqL1xyXG5cdHByaXZhdGUgX3Rlc3RTaXplKHZhbHVlOkJpdG1hcERhdGEpXHJcblx0e1xyXG5cdFx0aWYgKHZhbHVlLndpZHRoICE9IHZhbHVlLmhlaWdodClcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiQml0bWFwRGF0YSBzaG91bGQgaGF2ZSBlcXVhbCB3aWR0aCBhbmQgaGVpZ2h0IVwiKTtcclxuXHRcdGlmICghVGV4dHVyZVV0aWxzLmlzQml0bWFwRGF0YVZhbGlkKHZhbHVlKSlcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBiaXRtYXBEYXRhOiBXaWR0aCBhbmQgaGVpZ2h0IG11c3QgYmUgcG93ZXIgb2YgMiBhbmQgY2Fubm90IGV4Y2VlZCAyMDQ4XCIpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGRpc3Bvc2UoKVxyXG5cdHtcclxuXHRcdHN1cGVyLmRpc3Bvc2UoKTtcclxuXHJcblx0XHR2YXIgbGVuOm51bWJlciA9IHRoaXMuX2JpdG1hcERhdGFzLmxlbmd0aFxyXG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuXHRcdFx0dGhpcy5fYml0bWFwRGF0YXNbaV0uZGlzcG9zZSgpO1xyXG5cdFx0XHR0aGlzLl9iaXRtYXBEYXRhc1tpXSA9IG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fYml0bWFwRGF0YXMgPSBudWxsO1xyXG5cdH1cclxuXHJcblx0cHVibGljIF9pR2V0VGV4dHVyZURhdGEoc2lkZTpudW1iZXIpOkJpdG1hcERhdGFcclxuXHR7XHJcblx0XHRyZXR1cm4gdGhpcy5fYml0bWFwRGF0YXNbc2lkZV07XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgPSBCaXRtYXBDdWJlVGV4dHVyZTsiXX0=