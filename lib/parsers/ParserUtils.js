var ByteArray = require("awayjs-core/lib/utils/ByteArray");
var ParserUtils = (function () {
    function ParserUtils() {
    }
    /**
     * Converts an ArrayBuffer to a base64 string
     *
     * @param image data as a ByteArray
     *
     * @return HTMLImageElement
     *
     */
    ParserUtils.arrayBufferToImage = function (data) {
        var byteStr = '';
        var bytes = new Uint8Array(data);
        var len = bytes.byteLength;
        for (var i = 0; i < len; i++)
            byteStr += String.fromCharCode(bytes[i]);
        var base64Image = window.btoa(byteStr);
        var str = 'data:image/png;base64,' + base64Image;
        var img = new Image();
        img.src = str;
        return img;
    };
    /**
     * Converts an ByteArray to an Image - returns an HTMLImageElement
     *
     * @param image data as a ByteArray
     *
     * @return HTMLImageElement
     *
     */
    ParserUtils.byteArrayToImage = function (data) {
        var byteStr = '';
        var bytes = new Uint8Array(data.arraybytes);
        var len = bytes.byteLength;
        for (var i = 0; i < len; i++)
            byteStr += String.fromCharCode(bytes[i]);
        var base64Image = window.btoa(byteStr);
        var str = 'data:image/png;base64,' + base64Image;
        var img = new Image();
        img.src = str;
        return img;
    };
    /**
     * Converts an Blob to an Image - returns an HTMLImageElement
     *
     * @param image data as a Blob
     *
     * @return HTMLImageElement
     *
     */
    ParserUtils.blobToImage = function (data) {
        var URLObj = window['URL'] || window['webkitURL'];
        var src = URLObj.createObjectURL(data);
        var img = new Image();
        img.src = src;
        return img;
    };
    /**
     * Returns a object as ByteArray, if possible.
     *
     * @param data The object to return as ByteArray
     *
     * @return The ByteArray or null
     *
     */
    ParserUtils.toByteArray = function (data) {
        var b = new ByteArray();
        b.setArrayBuffer(data);
        return b;
    };
    /**
     * Returns a object as String, if possible.
     *
     * @param data The object to return as String
     * @param length The length of the returned String
     *
     * @return The String or null
     *
     */
    ParserUtils.toString = function (data, length) {
        if (length === void 0) { length = 0; }
        if (typeof data === 'string') {
            var s = data;
            if (s['substr'] != null)
                return s.substr(0, s.length);
        }
        if (data instanceof ByteArray) {
            var ba = data;
            ba.position = 0;
            return ba.readUTFBytes(Math.min(ba.getBytesAvailable(), length));
        }
        return null;
        /*
         var ba:ByteArray;

         length ||= uint.MAX_VALUE;

         if (data is String)
         return String(data).substr(0, length);

         ba = toByteArray(data);
         if (ba) {
         ba.position = 0;
         return ba.readUTFBytes(Math.min(ba.bytesAvailable, length));
         }

         return null;

         */
    };
    return ParserUtils;
})();
module.exports = ParserUtils;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1jb3JlL2xpYi9wYXJzZXJzL3BhcnNlcnV0aWxzLnRzIl0sIm5hbWVzIjpbIlBhcnNlclV0aWxzIiwiUGFyc2VyVXRpbHMuY29uc3RydWN0b3IiLCJQYXJzZXJVdGlscy5hcnJheUJ1ZmZlclRvSW1hZ2UiLCJQYXJzZXJVdGlscy5ieXRlQXJyYXlUb0ltYWdlIiwiUGFyc2VyVXRpbHMuYmxvYlRvSW1hZ2UiLCJQYXJzZXJVdGlscy50b0J5dGVBcnJheSIsIlBhcnNlclV0aWxzLnRvU3RyaW5nIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFPLFNBQVMsV0FBYyxpQ0FBaUMsQ0FBQyxDQUFDO0FBRWpFLElBQU0sV0FBVztJQUFqQkEsU0FBTUEsV0FBV0E7SUFvSWpCQyxDQUFDQTtJQWpJQUQ7Ozs7Ozs7T0FPR0E7SUFDV0EsOEJBQWtCQSxHQUFoQ0EsVUFBaUNBLElBQWdCQTtRQUVoREUsSUFBSUEsT0FBT0EsR0FBVUEsRUFBRUEsQ0FBQ0E7UUFDeEJBLElBQUlBLEtBQUtBLEdBQWNBLElBQUlBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1FBQzVDQSxJQUFJQSxHQUFHQSxHQUFVQSxLQUFLQSxDQUFDQSxVQUFVQSxDQUFDQTtRQUVsQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsR0FBR0EsRUFBRUEsQ0FBQ0EsRUFBRUE7WUFDM0JBLE9BQU9BLElBQUlBLE1BQU1BLENBQUNBLFlBQVlBLENBQUNBLEtBQUtBLENBQUVBLENBQUNBLENBQUVBLENBQUNBLENBQUFBO1FBRTNDQSxJQUFJQSxXQUFXQSxHQUFVQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQTtRQUM5Q0EsSUFBSUEsR0FBR0EsR0FBVUEsd0JBQXdCQSxHQUFHQSxXQUFXQSxDQUFDQTtRQUN4REEsSUFBSUEsR0FBR0EsR0FBdUNBLElBQUlBLEtBQUtBLEVBQUVBLENBQUNBO1FB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QSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxpQkFBaUJBLEVBQUVBLEVBQUVBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ2xFQSxDQUFDQTtRQUVEQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQTtRQUVaQTs7Ozs7Ozs7Ozs7Ozs7OztXQWdCR0E7SUFFSkEsQ0FBQ0E7SUFDRk4sa0JBQUNBO0FBQURBLENBcElBLEFBb0lDQSxJQUFBO0FBRUQsQUFBcUIsaUJBQVosV0FBVyxDQUFDIiwiZmlsZSI6InBhcnNlcnMvUGFyc2VyVXRpbHMuanMiLCJzb3VyY2VSb290IjoiLi4vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJ5dGVBcnJheVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3V0aWxzL0J5dGVBcnJheVwiKTtcblxuY2xhc3MgUGFyc2VyVXRpbHNcbntcblxuXHQvKipcblx0ICogQ29udmVydHMgYW4gQXJyYXlCdWZmZXIgdG8gYSBiYXNlNjQgc3RyaW5nXG5cdCAqXG5cdCAqIEBwYXJhbSBpbWFnZSBkYXRhIGFzIGEgQnl0ZUFycmF5XG5cdCAqXG5cdCAqIEByZXR1cm4gSFRNTEltYWdlRWxlbWVudFxuXHQgKlxuXHQgKi9cblx0cHVibGljIHN0YXRpYyBhcnJheUJ1ZmZlclRvSW1hZ2UoZGF0YTpBcnJheUJ1ZmZlcik6SFRNTEltYWdlRWxlbWVudFxuXHR7XG5cdFx0dmFyIGJ5dGVTdHI6c3RyaW5nID0gJyc7XG5cdFx0dmFyIGJ5dGVzOlVpbnQ4QXJyYXkgPSBuZXcgVWludDhBcnJheShkYXRhKTtcblx0XHR2YXIgbGVuOm51bWJlciA9IGJ5dGVzLmJ5dGVMZW5ndGg7XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKVxuXHRcdFx0Ynl0ZVN0ciArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGVzWyBpIF0pXG5cblx0XHR2YXIgYmFzZTY0SW1hZ2U6c3RyaW5nID0gd2luZG93LmJ0b2EoYnl0ZVN0cik7XG5cdFx0dmFyIHN0cjpzdHJpbmcgPSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LCcgKyBiYXNlNjRJbWFnZTtcblx0XHR2YXIgaW1nOkhUTUxJbWFnZUVsZW1lbnQgPSA8SFRNTEltYWdlRWxlbWVudD4gbmV3IEltYWdlKCk7XG5cdFx0aW1nLnNyYyA9IHN0cjtcblxuXHRcdHJldHVybiBpbWc7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYW4gQnl0ZUFycmF5IHRvIGFuIEltYWdlIC0gcmV0dXJucyBhbiBIVE1MSW1hZ2VFbGVtZW50XG5cdCAqXG5cdCAqIEBwYXJhbSBpbWFnZSBkYXRhIGFzIGEgQnl0ZUFycmF5XG5cdCAqXG5cdCAqIEByZXR1cm4gSFRNTEltYWdlRWxlbWVudFxuXHQgKlxuXHQgKi9cblx0cHVibGljIHN0YXRpYyBieXRlQXJyYXlUb0ltYWdlKGRhdGE6Qnl0ZUFycmF5KTpIVE1MSW1hZ2VFbGVtZW50XG5cdHtcblx0XHR2YXIgYnl0ZVN0cjpzdHJpbmcgPSAnJztcblx0XHR2YXIgYnl0ZXM6VWludDhBcnJheSA9IG5ldyBVaW50OEFycmF5KGRhdGEuYXJyYXlieXRlcyk7XG5cdFx0dmFyIGxlbjpudW1iZXIgPSBieXRlcy5ieXRlTGVuZ3RoO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKylcblx0XHRcdGJ5dGVTdHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1sgaSBdKVxuXG5cdFx0dmFyIGJhc2U2NEltYWdlOnN0cmluZyA9IHdpbmRvdy5idG9hKGJ5dGVTdHIpO1xuXHRcdHZhciBzdHI6c3RyaW5nID0gJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwnICsgYmFzZTY0SW1hZ2U7XG5cdFx0dmFyIGltZzpIVE1MSW1hZ2VFbGVtZW50ID0gPEhUTUxJbWFnZUVsZW1lbnQ+IG5ldyBJbWFnZSgpO1xuXHRcdGltZy5zcmMgPSBzdHI7XG5cblx0XHRyZXR1cm4gaW1nO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGFuIEJsb2IgdG8gYW4gSW1hZ2UgLSByZXR1cm5zIGFuIEhUTUxJbWFnZUVsZW1lbnRcblx0ICpcblx0ICogQHBhcmFtIGltYWdlIGRhdGEgYXMgYSBCbG9iXG5cdCAqXG5cdCAqIEByZXR1cm4gSFRNTEltYWdlRWxlbWVudFxuXHQgKlxuXHQgKi9cblx0cHVibGljIHN0YXRpYyBibG9iVG9JbWFnZShkYXRhOkJsb2IpOkhUTUxJbWFnZUVsZW1lbnRcblx0e1xuXHRcdHZhciBVUkxPYmo6VVJMID0gd2luZG93WydVUkwnXSB8fCB3aW5kb3dbJ3dlYmtpdFVSTCddO1xuXHRcdHZhciBzcmMgPSBVUkxPYmouY3JlYXRlT2JqZWN0VVJMKGRhdGEpO1xuXHRcdHZhciBpbWc6SFRNTEltYWdlRWxlbWVudCA9IDxIVE1MSW1hZ2VFbGVtZW50PiBuZXcgSW1hZ2UoKTtcblx0XHRpbWcuc3JjID0gc3JjO1xuXG5cdFx0cmV0dXJuIGltZztcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm5zIGEgb2JqZWN0IGFzIEJ5dGVBcnJheSwgaWYgcG9zc2libGUuXG5cdCAqXG5cdCAqIEBwYXJhbSBkYXRhIFRoZSBvYmplY3QgdG8gcmV0dXJuIGFzIEJ5dGVBcnJheVxuXHQgKlxuXHQgKiBAcmV0dXJuIFRoZSBCeXRlQXJyYXkgb3IgbnVsbFxuXHQgKlxuXHQgKi9cblx0cHVibGljIHN0YXRpYyB0b0J5dGVBcnJheShkYXRhOmFueSk6Qnl0ZUFycmF5XG5cdHtcblx0XHR2YXIgYjpCeXRlQXJyYXkgPSBuZXcgQnl0ZUFycmF5KCk7XG5cdFx0Yi5zZXRBcnJheUJ1ZmZlcihkYXRhKTtcblx0XHRyZXR1cm4gYjtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm5zIGEgb2JqZWN0IGFzIFN0cmluZywgaWYgcG9zc2libGUuXG5cdCAqXG5cdCAqIEBwYXJhbSBkYXRhIFRoZSBvYmplY3QgdG8gcmV0dXJuIGFzIFN0cmluZ1xuXHQgKiBAcGFyYW0gbGVuZ3RoIFRoZSBsZW5ndGggb2YgdGhlIHJldHVybmVkIFN0cmluZ1xuXHQgKlxuXHQgKiBAcmV0dXJuIFRoZSBTdHJpbmcgb3IgbnVsbFxuXHQgKlxuXHQgKi9cblx0cHVibGljIHN0YXRpYyB0b1N0cmluZyhkYXRhOmFueSwgbGVuZ3RoOm51bWJlciA9IDApOnN0cmluZ1xuXHR7XG5cblx0XHRpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHR2YXIgczpzdHJpbmcgPSA8c3RyaW5nPiBkYXRhO1xuXG5cdFx0XHRpZiAoc1snc3Vic3RyJ10gIT0gbnVsbClcblx0XHRcdFx0cmV0dXJuIHMuc3Vic3RyKDAsIHMubGVuZ3RoKTtcblx0XHR9XG5cblx0XHRpZiAoZGF0YSBpbnN0YW5jZW9mIEJ5dGVBcnJheSkge1xuXHRcdFx0dmFyIGJhOkJ5dGVBcnJheSA9IDxCeXRlQXJyYXk+IGRhdGE7XG5cdFx0XHRiYS5wb3NpdGlvbiA9IDA7XG5cdFx0XHRyZXR1cm4gYmEucmVhZFVURkJ5dGVzKE1hdGgubWluKGJhLmdldEJ5dGVzQXZhaWxhYmxlKCksIGxlbmd0aCkpO1xuXHRcdH1cblxuXHRcdHJldHVybiBudWxsO1xuXG5cdFx0Lypcblx0XHQgdmFyIGJhOkJ5dGVBcnJheTtcblxuXHRcdCBsZW5ndGggfHw9IHVpbnQuTUFYX1ZBTFVFO1xuXG5cdFx0IGlmIChkYXRhIGlzIFN0cmluZylcblx0XHQgcmV0dXJuIFN0cmluZyhkYXRhKS5zdWJzdHIoMCwgbGVuZ3RoKTtcblxuXHRcdCBiYSA9IHRvQnl0ZUFycmF5KGRhdGEpO1xuXHRcdCBpZiAoYmEpIHtcblx0XHQgYmEucG9zaXRpb24gPSAwO1xuXHRcdCByZXR1cm4gYmEucmVhZFVURkJ5dGVzKE1hdGgubWluKGJhLmJ5dGVzQXZhaWxhYmxlLCBsZW5ndGgpKTtcblx0XHQgfVxuXG5cdFx0IHJldHVybiBudWxsO1xuXG5cdFx0ICovXG5cblx0fVxufVxuXG5leHBvcnQgPSBQYXJzZXJVdGlsczsiXX0=